---
title: "Assumptions and diagnostics"
author: "Elizabeth Pankratz (elizabeth.pankratz@ed.ac.uk)"
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
#| include: false
library(tidyverse)
library(patchwork)
source('_theme/theme_quarto.R')
```


## Course Overview {.smaller}

<br>

:::: {.columns}

::: {.column width="50%"}

```{r echo = FALSE, results='asis', warning = FALSE}
block1_name = "Introduction to Linear Models"
block1_lecs = c("Intro to Linear Regression",
                "Interpreting Linear Models",
                "Testing Individual Predictors",
                "Model Testing & Comparison",
                "Linear Model Analysis")
block2_name = "Analysing Experimental Studies"
block2_lecs = c("Categorical Predictors & Dummy Coding",
                "	Effects Coding & Coding Specific Contrasts",
                "Assumptions & Diagnostics",
                "Bootstrapping",
                "	Categorical Predictor Analysis")

source("https://raw.githubusercontent.com/uoepsy/junk/main/R/course_table.R")

course_table(block1_name,block2_name,block1_lecs,block2_lecs,week = 8)
```

:::

::: {.column width="50%"}

```{r echo = FALSE, results='asis', warning = FALSE}
block3_name = "Interactions"
block3_lecs = c("Interactions I",
                "Interactions II",
                "Interactions III",
                "Analysing Experiments",
                "Interaction Analysis")
block4_name = "Advanced Topics"
block4_lecs = c("Power Analysis",
                "Binary Logistic Regression I",
                "Binary Logistic Regression II",
                "Logistic Regression Analysis",
                "	Exam Prep and Course Q&A")

source("https://raw.githubusercontent.com/uoepsy/junk/main/R/course_table.R")

course_table(block3_name,block4_name,block3_lecs,block4_lecs,week = 0)
```

:::

::::

## This week's learning objectives

<br>

::: {.fragment}
::: {.dapr2callout}
x
:::
:::

::: {.fragment}
::: {.dapr2callout}
x
:::
:::

::: {.fragment}
::: {.dapr2callout}
x
:::
:::


## Building an analysis workflow

<br> 

::: {.r-stack}
![](figs/block2-flowchart-08-0.svg){.fragment height="550" }

![](figs/block2-flowchart-08-1.svg){.fragment height="550" }

![](figs/block2-flowchart-08-2.svg){.fragment height="550" }

![](figs/block2-flowchart-08-3.svg){.fragment height="550" }

:::





## Revisiting this week's learning objectives

::: {}
::: {.dapr2callout}
**What does a linear model assume is true about the data that it models? (Four assumptions)**

::: {style="font-size: 80%;"}
- Linear: The association between predictor and outcome is linear.
- Independent: Every data point is independent of every other data point.
- Normally-distributed errors: The differences between fitted line and each data point (i.e., the residuals) follow a normal distribution.
- Equal variance of errors: The differences between fitted line and each data point (i.e., the residuals) are dispersed by a similar amount across the whole range of the predictor.
:::

:::
:::



::: {}
::: {.dapr2callout}
**What three properties of a single data point might affect a linear model's estimates? How can we diagnose each property?**

::: {style="font-size: 80%;"}
- Unusual outcome value, called "outlyingness". Diagnose with studentised residuals.
- Unusual predictor value, called "high leverage". Diagnose with hat values.
- Unusual outcome AND predictor value, called "high influence". Diagnose with Cook's Distance and COVRATIO.
:::

:::
:::


## Revisiting this week's learning objectives

::: {}
::: {.dapr2callout}
**What relationship between predictors do we want to avoid? How can we diagnose it?**

::: {style="font-size: 80%;"}
- We want to avoid predictors being highly correlated with one another. If they are, we call the situation "multicollinearity".
- When predictors are highly correlated, they contain very similar information, so the model is very uncertain how each one individually is associated with the outcome.
- Diagnose multicollinearity with the Variance Inflation Factor (VIF).
:::

:::
:::



## This week 

<br>

:::: {.columns}
::: {.column width="50%"}

### Tasks

<br>

```{r, echo = F, out.width='15%'}
knitr::include_graphics('figs/labs.svg')
```

**Attend your lab and work together on the exercises** 

:::
::: {.column width="50%"}

### Support

<br>

```{r, echo = F, out.width='15%'}
knitr::include_graphics('figs/forum.svg')
```

**Help each other on the Piazza forum**

:::
::::

<br>

:::: {.columns}
::: {.column width="50%"}

```{r, echo = F, out.width='15%'}
knitr::include_graphics('figs/exam.svg')
```

**Complete the weekly quiz**

:::
::: {.column width="50%"}

```{r, echo = F, out.width='15%'}
knitr::include_graphics('figs/oh.png')
```

**Attend office hours (see Learn page for details)**

:::
::::







