
# Interactions with sum-coded predictors

## What's sum coding again?

<br>

:::: {.columns}
::: {.column width="50%"}
**Treatment coding (aka dummy coding):**

![](figs/trtmt.svg)
:::
::: {.column width="50%"}
**Sum coding (aka effects coding):**

![](figs/sum.svg)
:::
::::

## Set up the data

<br>

```{r}
contrasts(anx1$transport) <- contr.sum(2)
contrasts(anx1$road_type) <- contr.sum(2)
```

<br>

```{r}
contrasts(anx1$transport)
```


<br>

```{r}
contrasts(anx1$road_type)
```


## The interaction's contrast is the product of the two interacting contrasts

<br>

In other words: To get the interaction's contrast, we multiply together the two contrasts for the interacting predictors.

<br>

| transport | road_type  | transport1 | road_type1 | t:rt |
| --------- | ---------- | ---------: | ---------: | ---: |
| Motorist  | RuralRoad  |  1         |  1         |    1 |
| Motorist  | CityStreet |  1         | –1         |   –1 |
| Cyclist   | RuralRoad  | –1         |  1         |   –1 |
| Cyclist   | CityStreet | –1         | –1         |    1 |




## A visual intuition

[todo an updated version of]

![](https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading_files/figure-html/fig-sumplot2-1.png)

<!-- However, when we change to using effects (or sum-to-zero) coding, we’re switching where zero is in our model. So if we change to sum contrasts (here we’ve changed both predictors to using sum-to-zero coding), then we end up estimating the effect of each predictor averaged across the other. -->

<!-- Coefficients: -->
<!--                      Estimate Std. Error t value Pr(>|t|)     -->
<!-- (Intercept)           1.13577    0.08796  12.912  < 2e-16 *** -->
<!-- conditionB            0.05141    0.08796   0.584     0.56     -->
<!-- grouping2            -1.36607    0.08796 -15.530  < 2e-16 *** -->
<!-- conditionB:grouping2 -0.54066    0.08796  -6.146 1.15e-08 *** -->
<!-- --- -->
<!-- The intercept is the grey X in Figure 6. -->
<!-- The coefficient for condition is the difference between the grey X and the grey triangle in Figure 6. -->
<!-- The coefficient for grouping is the difference between the grey X and the blue line in Figure 6. -->
<!-- The interaction coefficient is the difference from the slope of the grey line to slope of the blue line. -->

<!-- https://uoepsy.github.io/dapr2/2425/labs/1_b4_reading_files/figure-html/fig-sumplot2-1.png -->



## Fit the model

[todo model specification]

```{r}
m2 <- lm(anx ~ transport * road_type, data = anx1)
summary(m2)
```




## Interpreting the model

```{r}
summary(m2)$coefficients |> round(2)
```


It will be useful to consult a table of group means and marginal means (i.e., means of each row and each column; the grand mean is bottom right).

```{r include=F}
anx1 |>
  group_by(transport, road_type) |>
  summarise(m = round(mean(anx), 1)) |>
  pivot_wider(names_from = road_type, values_from = m) |>
  rbind(list(transport = NA, RuralRoad = NA, CityStreet = NA)) |>
  rbind(list(transport = 'Marginal means', RuralRoad = 27.25, CityStreet = 36)) |>
  cbind(list("NA" = NA)) |>
  cbind(list("Marginal means" = c(29.45, 33.8, NA, 31.625))) |>
  kableExtra::kable()
```


|                     | RuralRoad (1) | CityStreet (–1) | \| | **Marginal means**|
|:------------------- |---------:|----------:|:---|--------------:|
| <b>Motorist (1)</b> |     27.00|       31.9| \| |         29.450|
| <b>Cyclist (–1)</b> |     27.50|       40.1| \| |         33.800|
|                     |          |           |    |               |
| **Marginal means**  |     27.25|       36.0| \| |         31.625|

Sum coding changes what zero represents.
As a consequence, it changes what the intercept and all the slopes (and the interaction!) represent.


- `Intercept`: The grand mean, 31.625.

- `transport1`: The marginal mean for the level of `transport` coded as 1 (Motorist), minus the grand mean
  - 29.450 – 31.625 = –2.175
  - Can interpret this as the difference between Motorists and the grand mean, _when `road_type` is at its mean_
  
- `road_type1`: The marginal mean for the level of `road_type` coded as 1 (RuralRoad), minus the grand mean
  - 27.25 – 31.625 = –4.375
  - Can interpret this as the difference between Motorists and the grand mean, _when `road_type` is at its mean_

- `transport1:road_type1`: The mean when both predictors = 1 (Motorists and RuralRoads), minus the grand mean, also minus the coefficient `transport1`, also minus the coefficient `road_type1`
  - (27.00 – 31.625) – (–2.175) –  (–4.375) = 1.925
  - Can interpret this as the difference between the observed mean for motorists on rural roads versus what we'd otherwise estimate that mean to be, based only on the individual effects of transport and road type
  - Like the interaction coefficient in treatment coded models, it lets us give an extra boost to one specific combination of levels, to account for different patterns in the data




## Slopes with treatment-coded predictors vs. slopes with sum-coded predictors

x

