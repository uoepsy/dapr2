<!DOCTYPE html>
<html lang="en"><head>
<script src="dapr2_14_ixn_manual_files/libs/clipboard/clipboard.min.js"></script>
<script src="dapr2_14_ixn_manual_files/libs/quarto-html/tabby.min.js"></script>
<script src="dapr2_14_ixn_manual_files/libs/quarto-html/popper.min.js"></script>
<script src="dapr2_14_ixn_manual_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="dapr2_14_ixn_manual_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dapr2_14_ixn_manual_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="dapr2_14_ixn_manual_files/libs/quarto-html/quarto-syntax-highlighting-89ef1ee790bdc269b52a829279c5ce0e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Elizabeth Pankratz (elizabeth.pankratz@ed.ac.uk)">
  <title>Manual contrast interactions and multiple comparisons</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dapr2_14_ixn_manual_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="dapr2_14_ixn_manual_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="dapr2_14_ixn_manual_files/libs/revealjs/dist/theme/quarto-d416030f06bfca84d5d227e44b5ff432.css">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-attribution/attribution.css" rel="stylesheet">
  <link href="dapr2_14_ixn_manual_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
  $(document).ready(function() {
      $('.cell').each(function() {
          let highlightLines = $(this).attr('data-output-line-numbers');
          if (highlightLines) {
              let lines = highlightLines.split(',').map(x => parseInt(x));
              $(this).find('.cell-output-stdout pre code').html(function(_, html) {
                  return html.split('\n').map((line, index) => {
                      if (lines.includes(index + 1)) {
                          return '<span style="background-color: #D0D8FC;">' + line + '</span>';
                      } else {
                          return line;
                      }
                  }).join('\n');
              });
          }
      });
  });
  </script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#BF1932" class="quarto-title-block center">
  <h1 class="title">Manual contrast interactions and multiple comparisons</h1>
  <p class="subtitle"><br>Data Analysis for Psychology in R 2</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Elizabeth Pankratz (elizabeth.pankratz@ed.ac.uk) 
</div>
        <p class="quarto-title-affiliation">
            <br>Department of Psychology<br>University of Edinburgh<br>2025–2026
          </p>
    </div>
</div>

</section>
<section>
<section id="course-overview" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Course Overview</h1>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<table style="border: 1px solid black;>
  <tr style=" padding:="" 0="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>Introduction to linear Models</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Intro to linear regression</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interpreting linear models</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Testing individual predictors</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Model testing &amp; comparison</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Linear model analysis</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>Analysing Experimental Studies</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Categorical predictors and dummy coding</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Effect coding and manual post-hoc contrasts</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Assumptions and diagnostics</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Bootstrapping and confidence intervals</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Categorical predictors: Practice analysis</td></tr>
</tbody></table>
</div><div class="column" style="width:50%;">
<table style="border: 1px solid black;>
  <tr style=" padding:="" 0="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>Interactions</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Mean-centering and numeric/categorical interactions</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Numeric/numeric interactions</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Categorical/categorical interactions</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        <b>Manual contrast interactions and multiple comparisons</b></td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interactions: Practice analysis</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>Advanced Topics</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Power analysis</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Binary logistic regression I</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Binary logistic regression II</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Logistic regression: Practice analysis</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Exam prep and course Q&amp;A</td></tr>
</tbody></table>
</div></div>
</section>
<section id="this-weeks-learning-objectives" class="slide level2">
<h2>This week’s learning objectives</h2>
<p><br></p>
<div style="font-size: 125%;">
<div class="dapr2callout">
<p>How do we test an interaction between two manually-coded post-hoc contrasts?</p>
</div>
<div class="dapr2callout fragment">
<p>What’s the main danger of running multiple statistical tests on the same data?</p>
</div>
<div class="dapr2callout fragment">
<p>What are two common ways that we can correct for running multiple statistical tests on the same data?</p>
</div>
</div>
</section>
<section id="where-we-are-in-the-analysis-workflow" class="slide level2">
<h2>Where we are in the analysis workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/block3-flowchart-04.svg" class="quarto-figure quarto-figure-center" height="925"></p>
</figure>
</div>
</section></section>
<section>
<section id="interactions-between-manual-post-hoc-contrasts" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Interactions between manual post-hoc contrasts</h1>

</section>
<section id="todays-data" class="slide level2">
<h2>Today’s data</h2>
<p><strong>The subjective wellbeing (<code>SWB</code>) of patients at two different hospitals:</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><code>Hosp1</code>: <br> <img data-src="figs/Hosp1.jpg" height="300"></p>
</div><div class="column" style="width:50%;">
<p><code>Hosp2</code>: <br> <img data-src="figs/Hosp2.jpg" height="300"></p>
</div></div>
<p><strong>who have undergone one of three different treatments for depression:</strong></p>
<div class="columns">
<div class="column" style="width:33%;">
<p>Cognitive Behavioural Therapy (<code>CBT</code>) <br> <img data-src="figs/CBT.jpg" height="300"></p>
</div><div class="column" style="width:33%;">
<p>Eye Movement Desensitisation and Reprocessing therapy (<code>EMDR</code>) <br> <img data-src="figs/EMDR.jpg" height="300"></p>
</div><div class="column" style="width:33%;">
<p>Antidepressant medication <br> (<code>Meds</code>): <br> <img data-src="figs/Meds.jpg" height="300"></p>
</div></div>
</section>
<section id="visualising-the-data" class="slide level2">
<h2>Visualising the data</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-3-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<div style="font-size:85%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a>hosp <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
     SWB Treatment Hospital
   &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;   
 1   6.2 Meds      Hosp1   
 2  15.9 Meds      Hosp1   
 3   7.2 Meds      Hosp1   
 4  11.3 Meds      Hosp1   
 5  11.2 Meds      Hosp1   
 6   9   Meds      Hosp1   
 7  14.5 Meds      Hosp1   
 8   7.3 Meds      Hosp1   
 9  13.7 Meds      Hosp1   
10  12.6 Meds      Hosp1   
11  13.8 Meds      Hosp1   
12  12.5 Meds      Hosp1   </code></pre>
</div>
</div>
</div>
</div></div>
<p>What we want to know: <strong>Is the difference in SWB between talk therapy (both <code>CBT</code> and <code>EMDR</code>) and pharmaceutical therapy (<code>Meds</code>) different in each hospital?</strong></p>
<ul>
<li>We’ll manually chunk CBT and EMDR together in a post-hoc contrast, which we’ll call <code>TrtmtType</code>.</li>
<li>We’ll also specify a very simple manual post-hoc contrast for <code>Hospital</code>.</li>
<li>Then we’ll make a <strong>post-hoc interaction contrast</strong> to test whether the <code>Hospital</code> contrast interacts with the <code>TrtmtType</code> contrast.</li>
</ul>
</section>
<section id="set-up-the-model" class="slide level2">
<h2>Set up the model</h2>
<p><br></p>
<p>We only care about the post-hoc contrasts, so it’s fine to fit the model using R’s default treatment coding.</p>
<p><br></p>
<p>Check on the reference levels:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(hosp<span class="sc">$</span>Treatment)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     EMDR Meds
CBT     0    0
EMDR    1    0
Meds    0    1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(hosp<span class="sc">$</span>Hospital)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Hosp2
Hosp1     0
Hosp2     1</code></pre>
</div>
</div>
</div></div>
<p><br></p>
<p>The model in R syntax:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SWB <span class="sc">~</span> Treatment <span class="sc">*</span> Hospital, <span class="at">data =</span> hosp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><br></p>
<p>On your own time, practice writing out the model’s linear expression in mathematical terms, and check the appendix for the solution :)</p>
<!-- :::{.dapr2callout style="font-size:120%" .hcenter} -->
<!-- `wooclap.com`, code `UBEQCF` -->
<!-- ::: -->
</section>
<section id="get-estimated-marginal-means" class="slide level2">
<h2>Get estimated marginal means</h2>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a>m1_emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m1, <span class="sc">~</span> Treatment <span class="sc">*</span> Hospital)</span>
<span id="cb8-2"><a href="" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment Hospital emmean   SE  df lower.CL upper.CL
 CBT       Hosp1     10.10 0.37 174     9.37    10.83
 EMDR      Hosp1      9.43 0.37 174     8.70    10.16
 Meds      Hosp1     10.80 0.37 174    10.07    11.53
 CBT       Hosp2      7.98 0.37 174     7.25     8.71
 EMDR      Hosp2     13.12 0.37 174    12.39    13.85
 Meds      Hosp2      7.85 0.37 174     7.12     8.58

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="defining-post-hoc-contrasts" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Defining post-hoc contrasts</h1>

</section>
<section id="define-post-hoc-contrast-for-trtmttype" class="slide level2">
<h2>Define post-hoc contrast for <code>TrtmtType</code></h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="dapr2callout">
<p><strong>Step 1:</strong> “Chunk” together the two group(s) that the research question is comparing.</p>
<ul>
<li>Chunk 1: <code>Meds</code>.</li>
<li>Chunk 2: <code>CBT</code>, <code>EMDR</code>.</li>
</ul>
</div>
<div class="dapr2callout">
<p><strong>Step 2:</strong> Assign a 0 to any group(s) that aren’t in one of the chunks from Step 1.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 3:</strong> Assign a plus sign to every group in Chunk 1, and a minus sign to every group in Chunk 2.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 4:</strong> Count the plus signs and minus signs.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 5:</strong> To figure out the actual values for each cell, start with 1 and –1. Divide 1 by <span class="math inline">\(n_{plus}\)</span>, and divide –1 by <span class="math inline">\(n_{minus}\)</span>.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 6:</strong> In the coding matrix, replace the plus signs with the positive coding value from Step 5, and replace the minus signs with the negative coding value from Step 5. <strong>Done!</strong></p>
</div>
</div><div class="column" style="width:35%;">
<div class="hcenter">
<div class="r-stack">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><code>Treatment</code></th>
<th style="text-align: right;"><code>TrtmtType</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>CBT</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>EMDR</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Meds</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- ::::{.fragment} -->
<!-- | `Treatment`  | `TrtmtType` | -->
<!-- | :----------- | ------------: | -->
<!-- | `CBT`        |          –1/2  | -->
<!-- | `EMDR`       |          –1/2  | -->
<!-- | `Meds`       |             1  | -->
<!-- ||| -->
<!-- :::: -->
</div>
<p><br></p>
<div class="dapr2callout hcenter" style="font-size:120%">
<p><code>wooclap.com</code></p>
<p>code <code>UBEQCF</code></p>
</div>
</div>
</div></div>
</section>
<section id="define-post-hoc-contrast-for-hospital" class="slide level2">
<h2>Define post-hoc contrast for <code>Hospital</code></h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="dapr2callout">
<p><strong>Step 1:</strong> “Chunk” together the two group(s) that the research question is comparing.</p>
<ul>
<li>Chunk 1: <code>Hosp2</code>.</li>
<li>Chunk 2: <code>Hosp1</code>.</li>
</ul>
</div>
<div class="dapr2callout">
<p><strong>Step 2:</strong> Assign a 0 to any group(s) that aren’t in one of the chunks from Step 1.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 3:</strong> Assign a plus sign to every group in Chunk 1, and a minus sign to every group in Chunk 2.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 4:</strong> Count the plus signs and minus signs.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 5:</strong> To figure out the actual values for each cell, start with 1 and –1. Divide 1 by <span class="math inline">\(n_{plus}\)</span>, and divide –1 by <span class="math inline">\(n_{minus}\)</span>.</p>
</div>
<div class="dapr2callout">
<p><strong>Step 6:</strong> In the coding matrix, replace the plus signs with the positive coding value from Step 5, and replace the minus signs with the negative coding value from Step 5. <strong>Done!</strong></p>
</div>
</div><div class="column" style="width:35%;">
<div class="hcenter">
<div class="r-stack">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><code>Hospital</code></th>
<th style="text-align: right;"><code>Hosp</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Hosp1</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Hosp2</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- ::::{.fragment} -->
<!-- | `Hospital`  | `Hosp` | -->
<!-- | :---------- | -----: | -->
<!-- | `Hosp1`     |  –1    | -->
<!-- | `Hosp2`     |   1    | -->
<!-- ||| -->
<!-- :::: -->
</div>
<p><br></p>
<div class="dapr2callout hcenter" style="font-size:120%">
<p><code>wooclap.com</code></p>
<p>code <code>UBEQCF</code></p>
</div>
</div>
</div></div>
</section>
<section id="visualising-the-interaction-well-test" class="slide level2">
<h2>Visualising the interaction we’ll test</h2>
<p>We want to know: Is there a difference between hospitals in how different treatment types (talk therapy vs.&nbsp;pharmaceutical therapy) are associated with SWB?</p>

<img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-10-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section></section>
<section>
<section id="h0h1-for-interactions-between-manual-contrasts" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>H0/H1 for interactions between manual contrasts</h1>

</section>
<section id="step-1-define-means-of-all-combinations-of-factor-levels" class="slide level2">
<h2>Step 1: Define means of all combinations of factor levels</h2>
<p>When we test differences between groups, we’re testing differences between group <strong>means.</strong></p>
<p>So, we will start by defining the group means for all combinations of factor levels in our data.</p>
<p><img data-src="figs/14-groupmeans.png" class="quarto-figure quarto-figure-center"> <!-- \begin{matrix} --> <!--                    &    &           \textbf{Hospital} & \\ --> <!--                    &    &           \text{Hosp1} & \text{Hosp2}  \\ --> <!--                    &  \text{ CBT}  & \mu_{\text{CBT,Hosp1} }&  \mu_{\text{CBT,Hosp2}}\\ --> <!-- \textbf{Treatment} &  \text{ EMDR} & \mu_{\text{EMDR,Hosp1}} & \mu_{\text{EMDR,Hosp2}} \\ --> <!--                    &  \text{ Meds} & \mu_{\text{Meds,Hosp1}} & \mu_{\text{Meds,Hosp2}} --> <!-- \end{matrix} --></p>
<p>Next, we’ll combine these group means in the way that the manual contrasts specify.</p>
</section>
<section id="step-2-chunk-some-of-the-means-together" class="slide level2">
<h2>Step 2: “Chunk” some of the means together</h2>
<p>Within each hospital, we chunk CBT and EMDR together, because they are both talk therapy.</p>

<img data-src="figs/14-groupmeans-chunks.png" class="quarto-figure quarto-figure-center r-stretch"><p><br></p>
<p>When we chunk two group means together, mathematically we are <strong>taking the mean of those group means.</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>To represent the <span style="color:#3173C9;"> <b>mean of the blue chunk</b> </span> (top left):</p>
<p><span class="math display">\[
\frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2}
\]</span></p>
</div><div class="column" style="width:50%;">
<p>To represent the <span style="color:#51B375;"> <b>mean of the green chunk</b> </span> (top right):</p>
<p><span class="math display">\[
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2}
\]</span></p>
</div></div>
</section>
<section id="step-3-set-up-h0-as-differences-between-chunk-means-based-on-rq" class="slide level2">
<h2>Step 3: Set up H0 as differences between chunk means, based on RQ</h2>
<p><strong>RQ:</strong> Is the difference in SWB between talk therapy (both <code>CBT</code> and <code>EMDR</code>) and pharmaceutical therapy (<code>Meds</code>) different in each hospital?</p>
<p><br></p>
<p><strong>Null hypothesis in words:</strong> The difference in SWB between talk therapy (both <code>CBT</code> and <code>EMDR</code>) and pharmaceutical therapy (<code>Meds</code>) is the same in each hospital. <br></p>
<p><br></p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p><strong>In words arranged like the math:</strong></p>
<ul>
<li>(the mean SWB of CBT and EMDR in Hosp1)</li>
<li>minus</li>
<li>(the mean SWB of Meds in Hosp1)</li>
<li>equals</li>
<li>(the mean SWB of CBT and EMDR in Hosp2)</li>
<li>minus</li>
<li>(the mean SWB of Meds in Hosp2)</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<p><strong>In math arranged like the words:</strong></p>
<ul>
<li><span class="math inline">\(\frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2}\)</span></li>
<li>–</li>
<li><span class="math inline">\(\mu_{\text{Meds,Hosp1}}\)</span></li>
<li>=</li>
<li><span class="math inline">\(\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2}\)</span></li>
<li>–</li>
<li><span class="math inline">\(\mu_{\text{Meds,Hosp2}}\)</span></li>
</ul>
</div></div>
</section>
<section id="formal-h0-and-h1-for-interactions-between-manual-contrasts" class="slide level2">
<h2>Formal H0 and H1 for interactions between manual contrasts</h2>
<p><strong>Version 1: Differences are the same (H0) or not the same (H1):</strong></p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} =
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \\

H_1 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \neq
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}}
\end{align}\]</span></p>
<p><br></p>
<div class="fragment">
<p><strong>Version 2, also fine: Difference between differences is zero (H0) or not zero (H1):</strong></p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) -
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) = 0 \\

H_1 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) -
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) \neq 0 \\

\end{align}\]</span></p>
</div>
<p><br> <br> <br></p>
<p>(LaTeX code in appendix)</p>
</section></section>
<section>
<section id="post-hoc-contrasts-in-r" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Post-hoc contrasts in R</h1>

</section>
<section id="post-hoc-contrasts-in-r-1" class="slide level2">
<h2>Post-hoc contrasts in R</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="hcenter">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><code>Treatment</code></th>
<th style="text-align: right;"><code>TrtmtType</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>CBT</code></td>
<td style="text-align: right;">–1/2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>EMDR</code></td>
<td style="text-align: right;">–1/2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Meds</code></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div><div class="column" style="width:50%;">
<div class="hcenter">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><code>Hospital</code></th>
<th style="text-align: right;"><code>Hosp</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Hosp1</code></td>
<td style="text-align: right;">–1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Hosp2</code></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div></div>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>TrtmtType_contr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'CBT'</span>  <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb10-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'EMDR'</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb10-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Meds'</span> <span class="ot">=</span>    <span class="dv">1</span></span>
<span id="cb10-5"><a href="" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="" aria-hidden="true" tabindex="-1"></a>Hosp_contr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Hosp1'</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb10-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Hosp2'</span> <span class="ot">=</span>  <span class="dv">1</span></span>
<span id="cb10-10"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="the-interactions-contrast-is-the-product-of-the-two-interacting-contrasts" class="slide level2">
<h2>The interaction’s contrast is the product of the two interacting contrasts</h2>
<p><br></p>
<p>In other words: To get the interaction’s contrast, we multiply together the two contrasts for the interacting predictors.</p>
<p><br></p>
<div class="r-stack">
<table class="caption-top">
<thead>
<tr class="header">
<th>Treatment</th>
<th>Hospital</th>
<th style="text-align: right;">TrtmtType</th>
<th style="text-align: right;">Hosp</th>
<th style="text-align: right;">TrtmtType:Hosp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CBT</td>
<td>Hosp1</td>
<td style="text-align: right;">–0.5</td>
<td style="text-align: right;">–1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>EMDR</td>
<td>Hosp1</td>
<td style="text-align: right;">–0.5</td>
<td style="text-align: right;">–1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Meds</td>
<td>Hosp1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">–1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>CBT</td>
<td>Hosp2</td>
<td style="text-align: right;">–0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>EMDR</td>
<td>Hosp2</td>
<td style="text-align: right;">–0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Meds</td>
<td>Hosp2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- ::::{.fragment} -->
<!-- | Treatment | Hospital | TrtmtType | Hosp | TrtmtType:Hosp | -->
<!-- | --------- | -------- | ----------: | ---: | ---------------: | -->
<!-- | CBT       | Hosp1    | 0.5         | 1    | 0.5              | -->
<!-- | EMDR      | Hosp1    | 0.5         | 1    | 0.5              | -->
<!-- | Meds      | Hosp1    | –1          | 1    | –1               | -->
<!-- | CBT       | Hosp2    | 0.5         | –1   | –0.5             | -->
<!-- | EMDR      | Hosp2    | 0.5         | –1   | –0.5             | -->
<!-- | Meds      | Hosp2    | –1          | –1   | 1                | -->
<!-- :::: -->
</div>
<p><br></p>
<div class="dapr2callout hcenter" style="font-size:120%">
<p><code>wooclap.com</code>, code <code>UBEQCF</code></p>
</div>
</section>
<section id="put-the-interactions-contrast-into-r-two-ways" class="slide level2">
<h2>Put the interaction’s contrast into R, two ways</h2>
<p><strong>(1) The fancy way:</strong></p>
<p>Here are the two individual manual contrasts we defined a couple slides ago:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>TrtmtType_contr</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> CBT EMDR Meds 
-0.5 -0.5  1.0 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>Hosp_contr</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hosp1 Hosp2 
   -1     1 </code></pre>
</div>
</div>
</div></div>
<div class="fragment">
<p>Multiply them together using <code>outer()</code>. Write <code>TrtmtType</code> first because we told emmeans &nbsp; <code>~ Treatment * Hospital</code>, with <code>Treatment</code> first.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">outer</span>(TrtmtType_contr, Hosp_contr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Hosp1 Hosp2
CBT    0.5  -0.5
EMDR   0.5  -0.5
Meds  -1.0   1.0</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Flatten this table using <code>as.vector()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>( <span class="fu">outer</span>(TrtmtType_contr, Hosp_contr) )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.5  0.5 -1.0 -0.5 -0.5  1.0</code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>Name the contrast, wrap it in a list, and assign that list to a variable called <code>interaction_contr</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a>interaction_contr <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb19-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">'TrtmtType:Hospital'</span> <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(TrtmtType_contr, Hosp_contr))</span>
<span id="cb19-3"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</section>
<section id="put-the-interactions-contrast-into-r-two-ways-1" class="slide level2">
<h2>Put the interaction’s contrast into R, two ways</h2>
<p><strong>(2) The manual way:</strong></p>
<p>Check the order of items that emmeans uses:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a>m1_emm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment Hospital emmean   SE  df lower.CL upper.CL
 CBT       Hosp1     10.10 0.37 174     9.37    10.83
 EMDR      Hosp1      9.43 0.37 174     8.70    10.16
 Meds      Hosp1     10.80 0.37 174    10.07    11.53
 CBT       Hosp2      7.98 0.37 174     7.25     8.71
 EMDR      Hosp2     13.12 0.37 174    12.39    13.85
 Meds      Hosp2      7.85 0.37 174     7.12     8.58

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p><br></p>
<p>Figure out the correct coding values manually (as we did a few slides ago).</p>
<p>Make sure to match emmeans’ order and type up the contrast coding by hand:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a>interaction_contr <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="st">"TrtmtType:Hospital"</span> <span class="ot">=</span></span>
<span id="cb22-2"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb22-3"><a href="" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.5</span>,    <span class="co"># CBT  Hosp1 </span></span>
<span id="cb22-4"><a href="" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.5</span>,    <span class="co"># EMDR Hosp1</span></span>
<span id="cb22-5"><a href="" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="dv">1</span>,    <span class="co"># Meds Hosp1</span></span>
<span id="cb22-6"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="fl">0.5</span>,    <span class="co"># CBT  Hosp2</span></span>
<span id="cb22-7"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="fl">0.5</span>,    <span class="co"># EMDR Hosp2</span></span>
<span id="cb22-8"><a href="" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span>     <span class="co"># Meds Hosp2</span></span>
<span id="cb22-9"><a href="" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-10"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="test-the-interaction-contrast" class="slide level2">
<h2>Test the interaction contrast</h2>
<p>When we test the contrast using <code>contrast()</code>, we are testing the H0 that the estimate is equal to zero. For this interaction, the H0 says there’s no difference between <code>Hospital</code> in how <code>TrtmtType</code> is associated with <code>SWB</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a>(m1_ixn_test <span class="ot">&lt;-</span> <span class="fu">contrast</span>(m1_emm, interaction_contr))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast           estimate    SE  df t.ratio p.value
 TrtmtType:Hospital    -3.73 0.641 174  -5.819 &lt;0.0001</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>Get the associated 95% CIs using <code>confint()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a>(m1_ixn_confint <span class="ot">&lt;-</span> <span class="fu">confint</span>(m1_ixn_test))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast           estimate    SE  df lower.CL upper.CL
 TrtmtType:Hospital    -3.73 0.641 174    -4.99    -2.46

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>The null hypothesis:</p>
<ul>
<li><strong>There’s no difference between hospitals in how different treatment types (talk therapy vs.&nbsp;pharmaceutical therapy) are associated with SWB.</strong></li>
<li>In other words, if the null hypothesis were true, the data for both hospitals would pattern the same.</li>
</ul>
<div class="dapr2callout hcenter">
<p>Can we reject the null hypothesis?</p>
<p><img data-src="figs/codicon--thumbsup-filled.svg" width="40"> <img data-src="figs/codicon--thumbsdown-filled.svg" width="40"></p>
</div>
</div>
</section>
<section id="where-does-this-estimate-of-3.73-come-from" class="slide level2">
<h2>Where does this estimate of –3.73 come from?</h2>
<p>It’s the result of multiplying each group mean (column <strong>mean_SWB</strong>) by the corresponding value from the interaction’s contrast (column <strong>TrtmtType:Hospital</strong>), shown in the column <strong>product</strong>, and then adding all those numbers together.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Treatment</th>
<th style="text-align: left;">Hospital</th>
<th style="text-align: right;">mean_SWB</th>
<th style="text-align: right;">TrtmtType:Hospital</th>
<th style="text-align: right;">product</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CBT</td>
<td style="text-align: left;">Hosp1</td>
<td style="text-align: right;">10.10</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">5.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">EMDR</td>
<td style="text-align: left;">Hosp1</td>
<td style="text-align: right;">9.43</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">4.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Meds</td>
<td style="text-align: left;">Hosp1</td>
<td style="text-align: right;">10.80</td>
<td style="text-align: right;">-1.0</td>
<td style="text-align: right;">-10.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">CBT</td>
<td style="text-align: left;">Hosp2</td>
<td style="text-align: right;">7.98</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">-3.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EMDR</td>
<td style="text-align: left;">Hosp2</td>
<td style="text-align: right;">13.12</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">-6.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Meds</td>
<td style="text-align: left;">Hosp2</td>
<td style="text-align: right;">7.85</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.85</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(hosp_manual<span class="sc">$</span>product) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.73</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>Can we give this number a more intuitive explanation?</p>
<p>Not really tbh :( Interaction coefficients are adjustments to other effects, not effects themselves. <strong>But we don’t have any other coefficients to relate this adjustment to, so we can’t compute simple slopes or anything.</strong> And it’s not very useful to interpret this single number on its own.</p>
<p><strong>The reason manual interactions are useful is essentially just the significance test.</strong></p>
</div>
</section>
<section id="extending-the-analysis-workflow" class="slide level2">
<h2>Extending the analysis workflow</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/block3-flowchart-05.svg" class="quarto-figure quarto-figure-center" height="925"></p>
</figure>
</div>
</section></section>
<section>
<section id="testing-simple-effects" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Testing simple effects</h1>

</section>
<section id="retrieval-practice-testing-simple-effects" class="slide level2">
<h2><img style="vertical-align: text-bottom; width: 1.5em;" src="figs/icon-park-twotone--brain.svg"> Retrieval practice: Testing simple effects</h2>
<p><br></p>
<ul>
<li>What’s a simple effect?</li>
<li>If I ask for simple effects of <code>Hospital</code> at each level of <code>Treatment</code>, what am I looking for?</li>
<li>What’s the difference between simple effects and simple slopes?</li>
<li>What does it mean to <em>test</em> a simple effect?</li>
</ul>
</section>
<section id="testing-simple-effects-with-pairs" class="slide level2">
<h2>Testing simple effects with <code>pairs()</code></h2>
<p><br></p>
<p>We’ve seen the math of how to compute simple effects by hand.</p>
<p>But that only gives us the value of the effect, not a test of whether that value is significantly different from zero.</p>
<p><br></p>
<p>When we had continuous predictors, we could test simple slopes using <code>probe_interactions()</code>.</p>
<p>Now that we have categorical predictors, we can test simple effects by giving the <code>pairs()</code> function the model’s emmeans object and specifing the <code>simple=</code> argument.</p>
<p><br></p>
<p>For example, to get the simple effects of <code>Hospital</code> at each level of <code>Treatment</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">"Hospital"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="simple-effects-of-hospital-at-each-level-of-treatment" class="slide level2">
<h2>Simple effects of <code>Hospital</code> at each level of <code>Treatment</code></h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">"Hospital"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment = CBT:
 contrast      estimate    SE  df t.ratio p.value
 Hosp1 - Hosp2     2.12 0.523 174   4.059 &lt;0.0001

Treatment = EMDR:
 contrast      estimate    SE  df t.ratio p.value
 Hosp1 - Hosp2    -3.69 0.523 174  -7.047 &lt;0.0001

Treatment = Meds:
 contrast      estimate    SE  df t.ratio p.value
 Hosp1 - Hosp2     2.95 0.523 174   5.632 &lt;0.0001</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-25-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p>Note on the positive/negative signs:</p>
<ul>
<li><code>pairs()</code> computes <code>Hosp1 – Hosp2</code> because of how factor levels in the factor <code>Hospital</code> are ordered.</li>
<li>To compute <code>Hosp2 – Hosp1</code> instead, we would have to code <code>Hosp2</code> as the reference level of <code>Hospital</code> before fitting the model.</li>
</ul>
</section>
<section id="simple-effects-of-treatment-for-each-level-of-hospital" class="slide level2">
<h2>Simple effects of <code>Treatment</code> for each level of <code>Hospital</code></h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">"Treatment"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hospital = Hosp1:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR     0.673 0.523 174   1.287  0.4044
 CBT - Meds    -0.697 0.523 174  -1.332  0.3796
 EMDR - Meds   -1.370 0.523 174  -2.619  0.0259

Hospital = Hosp2:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR    -5.137 0.523 174  -9.819 &lt;0.0001
 CBT - Meds     0.127 0.523 174   0.242  0.9682
 EMDR - Meds    5.263 0.523 174  10.061 &lt;0.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-27-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><br></p>
<p>What’s this “P value adjustment: tukey method” thing? We’ll find out soon, but first …</p>
</section>
<section id="visualising-catcat-interactions" class="slide level2">
<h2>Visualising cat/cat interactions</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Using <code>cat_plot()</code>:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="" aria-hidden="true" tabindex="-1"></a>interactions<span class="sc">::</span><span class="fu">cat_plot</span>(</span>
<span id="cb34-2"><a href="" aria-hidden="true" tabindex="-1"></a>  m1,</span>
<span id="cb34-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> Hospital,</span>
<span id="cb34-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> Treatment,</span>
<span id="cb34-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">'line'</span></span>
<span id="cb34-6"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-29-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Using <code>emmip()</code> (estimated marginal means interaction plot):</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(</span>
<span id="cb35-2"><a href="" aria-hidden="true" tabindex="-1"></a>  m1_emm, </span>
<span id="cb35-3"><a href="" aria-hidden="true" tabindex="-1"></a>  Treatment <span class="sc">~</span> Hospital, </span>
<span id="cb35-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">CIs =</span> <span class="cn">TRUE</span></span>
<span id="cb35-5"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-31-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="the-multiple-comparisons-problem" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>The multiple comparisons problem</h1>

</section>
<section id="lets-roll-some-dice" class="slide level2">
<h2>Let’s roll some dice</h2>
<p>On a twenty-sided die (a d20), the probability of rolling a 1 (or any other individual number) is 1/20 = 5%.</p>
<p>But if we roll the d20 over and over again, the probability that we’ll roll a 1 <strong>at least once</strong> goes up and up and up.</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"></p>
</div><div class="column" style="width:20%;">
<p><span class="math inline">\(.05\)</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(= 1 – 0.95\)</span></p>
</div></div>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"> <img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"></p>
</div><div class="column" style="width:20%;">
<p><span class="math inline">\(.0975\)</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(= 1 – (0.95 \times 0.95)\)</span></p>
</div></div>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"> <img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"> <img data-src="figs/arcticons--rpg-simple-dice.svg" width="80"></p>
</div><div class="column" style="width:20%;">
<p><span class="math inline">\(.1426\)</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(= 1 – (0.95 \times 0.95 \times 0.95) = 1 - 0.95^3\)</span></p>
</div></div>
<div class="dapr2callout fragment">
<p>In general:</p>
<p><span class="math display">\[
P(\text{rolling a 1 in m rolls}) = 1 - (1 - 0.05)^m
\]</span></p>
</div>
<div class="dapr2callout fragment hcenter">
<p><strong>What’s the probability that we’ll roll a 1 at least once in twenty rolls?</strong></p>
<p><code>wooclap.com</code>, code <code>UBEQCF</code></p>
</div>
</section>
<section id="from-dice-to-statistical-tests" class="slide level2">
<h2>From dice to statistical tests</h2>
<p><br></p>
<p><strong>Why did we spend time rolling those dice?</strong></p>
<ul>
<li>When <span class="math inline">\(\alpha = .05\)</span>,
<ul>
<li>we accept the risk that 5% of the time, we’ll reject the H0 when actually we shouldn’t.</li>
<li>(aka that we’ll get a false positive result)</li>
<li>(aka that we’ll make a Type I error)</li>
</ul></li>
<li><strong>A d20 rolling a 1 happens with the same probability as us rejecting the H0 when actually we shouldn’t: one time in twenty.</strong></li>
<li>We saw that the probability of rolling a 1 at least once increases, the more dice you roll. <strong>It’s also true that the probability of rejecting the H0 when actually we shouldn’t will increase, the more statistical tests we run.</strong></li>
<li>So if we run 20 statistical tests, say, then even though we only want to incorrectly reject the H0 one time out of twenty (5% of the time), we would actually reject it with much higher probability.</li>
<li>The actual level of risk becomes higher than the level of risk that we wanted.</li>
</ul>
</section>
<section id="relevant-xkcd-httpsxkcd.com882" class="slide level2">
<h2>relevant XKCD (<a href="https://xkcd.com/882/" class="uri">https://xkcd.com/882/</a>)</h2>

<img data-src="figs/xkcd-significant-1.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="figs/xkcd-significant-2.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="figs/xkcd-significant-3.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="figs/xkcd-significant-4.png" class="r-stretch"></section>
<section id="the-more-tests-you-run-the-more-likely-you-are-to-see-something-unlikely-just-due-to-chance" class="slide level2">
<h2>The more tests you run, the more likely you are to see something unlikely just due to chance</h2>
<p><br></p>
<p>With <span class="math inline">\(\alpha = 0.05\)</span>, we accept the risk that, we will incorrectly reject the null hypothesis 5% of the time.</p>
<p>And if we accept that positive result and ignore all the negative results (green jelly bean style), then we run into <strong>the multiple comparisons problem: we are more than 5% likely to see at least one false positive, the more tests (aka, the more comparisons) we run.</strong></p>
<p><br></p>
<p>How much more likely?</p>
<p>Depends on the number of tests.</p>
<p><span class="math display">\[
\begin{align}
P(\text{incorrectly reject H0}) &amp;= \alpha \\
P(\text{correctly reject H0}) &amp;= 1 - \alpha \\
P(\text{correctly reject H0 in} ~m~ \text{tests}) &amp;= (1 - \alpha)^m \\
P(\text{incorrectly reject H0 in} ~m~ \text{tests}) &amp;= 1 - (1 - \alpha)^m \\
\end{align}
\]</span></p>
</section>
<section id="how-likely-are-we-to-incorrectly-reject-h0" class="slide level2">
<h2>How likely are we to incorrectly reject H0?</h2>
<p><br></p>
<p>For the green jelly beans scenario:</p>
<p><span class="math display">\[
\begin{align}
P(\text{incorrectly reject H0 in 20 tests}) &amp;= 1 - (1 - 0.05)^{20} \\
&amp;= 1 - (0.95)^{20} \\
&amp;= 1 - 0.36 \\
&amp;= 0.64 \\
\end{align}
\]</span></p>
<p>We accepted the risk of incorrectly rejecting the null hypothesis 5% of the time. But if we run 20 tests and accept any positive result, we will risk incorrectly rejecting H0 64% of the time!</p>
<p><br></p>
<p><strong>How do we fix it?</strong></p>
<p>Lower the <span class="math inline">\(\alpha\)</span> level (aka our accepted level of risk, aka the false positive rate, aka the Type I error rate) to compensate for the increased probability of incorrectly rejecting H0.</p>
</section>
<section id="common-corrections" class="slide level2">
<h2>Common corrections</h2>
<p><br></p>
<ul>
<li>Tukey</li>
<li>Bonferroni</li>
<li>Šídák</li>
<li>Scheffe</li>
<li>Holm’s step-down</li>
<li>Hochberg’s step-up</li>
<li>…</li>
</ul>
<p><br></p>
<p><strong>You only need to know about Tukey and Bonferroni, the two most common.</strong></p>
<p><br></p>
<p>We’ll start with Bonferroni, because it’s simplest.</p>
</section>
<section id="the-bonferroni-correction" class="slide level2">
<h2>The Bonferroni correction</h2>
<p><br></p>
<p>The goal is to lower the <span class="math inline">\(\alpha\)</span> level of our tests so that it matches our desired level of risk.</p>
<p>The Bonferroni correction takes our original <span class="math inline">\(\alpha\)</span> level and divides it by the number of tests:</p>
<p><span class="math display">\[
\alpha_{\text{Bonferroni}} = \frac{\alpha}{\text{number of tests}}
\]</span></p>
<p><br></p>
<p><strong>For the jelly bean scenario, with 20 tests:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">20</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0025</code></pre>
</div>
</div>
<p><br></p>
<p><strong>For our simple effects of <code>Treatment</code> by <code>Hospital</code>, with three tests:</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01666667</code></pre>
</div>
</div>
</section>
<section id="bonferroni-in-action" class="slide level2">
<h2>Bonferroni in action</h2>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">'Treatment'</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hospital = Hosp1:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR     0.673 0.523 174   1.287  0.5993
 CBT - Meds    -0.697 0.523 174  -1.332  0.5541
 EMDR - Meds   -1.370 0.523 174  -2.619  0.0288

Hospital = Hosp2:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR    -5.137 0.523 174  -9.819 &lt;0.0001
 CBT - Meds     0.127 0.523 174   0.242  1.0000
 EMDR - Meds    5.263 0.523 174  10.061 &lt;0.0001

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
</section>
<section id="tukeys-honest-significant-differences-hsd" class="slide level2">
<h2>Tukey’s Honest Significant Differences (HSD)</h2>
<p><br></p>
<p><strong>Think back to independent-samples t-tests in DAPR1:</strong></p>
<ul>
<li>This kind of t-test compares whether two group means are significantly different from one another.</li>
<li>The difference between group means is represented as a <strong>t-statistic.</strong></li>
<li>The t-statistic is compared to a critical value from the <strong>t-distribution</strong> to decide whether the difference is significant.</li>
</ul>
<p><strong>At heart, Tukey’s HSD is very similar!</strong></p>
<ul>
<li>Tukey’s HSD compares the means of the members of one pair in a pairwise comparison.</li>
<li>The difference between group means is represented as a <strong>q-statistic.</strong></li>
<li>The q-statistic is compared to a critical value from the <strong>studentised range distribution</strong> to decide whether the difference is significant.</li>
</ul>
<p><br></p>
<p><strong>You do not need to know how to calculate this adjustment by hand!</strong></p>
<p>If you <em>want</em> to know, here’s <a href="https://www.youtube.com/watch?v=EBGnAJHs3G4&amp;t=218s" target="_blank">a YouTube video that walks through the calculation</a>. (The main action is between 3:41–7:42.)</p>
</section>
<section id="tukey-in-action" class="slide level2">
<h2>Tukey in action</h2>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">'Treatment'</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hospital = Hosp1:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR     0.673 0.523 174   1.287  0.4044
 CBT - Meds    -0.697 0.523 174  -1.332  0.3796
 EMDR - Meds   -1.370 0.523 174  -2.619  0.0259

Hospital = Hosp2:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR    -5.137 0.523 174  -9.819 &lt;0.0001
 CBT - Meds     0.127 0.523 174   0.242  0.9682
 EMDR - Meds    5.263 0.523 174  10.061 &lt;0.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</section>
<section id="when-to-choose-bonferroni-vs.-tukey" class="slide level2">
<h2>When to choose Bonferroni vs.&nbsp;Tukey</h2>
<p><br></p>
<p><strong>When to choose Bonferroni:</strong></p>
<ul>
<li>When you’re interested in a small number of comparisons.</li>
<li>When you’ve got a set of p-values that come from the same data, regardless of what kind of test generated them.</li>
</ul>
<p><br></p>
<p><strong>When to choose Tukey:</strong></p>
<ul>
<li>When you want to compare the means of levels of a categorical predictor.</li>
<li>When you’re interested in many/all pairwise comparisons between groups.</li>
</ul>
<p><br></p>
<p>Check the <a href="https://uoepsy.github.io/dapr2/2526/labs/1_b3_reading.html#multiple-comparisons" target="_blank">flashcards</a> for more details.</p>
</section>
<section id="analysis-workflow-the-final-form" class="slide level2">
<h2>Analysis workflow: The final form!</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/block3-flowchart-06.svg" class="quarto-figure quarto-figure-center" height="925"></p>
</figure>
</div>
</section></section>
<section>
<section id="back-matter" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Back matter</h1>

</section>
<section id="revisiting-this-weeks-learning-objectives" class="slide level2">
<h2>Revisiting this week’s learning objectives</h2>
<div class="dapr2callout">
<p><strong>How do we test an interaction between two manually-coded post-hoc contrasts?</strong></p>
<ul>
<li>Manually code the interaction between them, using the same procedure that we saw for treatment-coded predictors last week:
<ul>
<li>get all combinations of levels, and</li>
<li>multiply each pair of coding values together.</li>
<li>The result is the contrast coding of the interaction.</li>
</ul></li>
<li>Test that contrast using our <code>emmeans()</code> toolkit.</li>
</ul>
</div>
<div class="dapr2callout">
<p><strong>What’s the main danger of running multiple statistical tests on the same data?</strong></p>
<ul>
<li>We’ll end up rejecting the H0 at least once in all those tests with a probability much higher than our desired <span class="math inline">\(\alpha\)</span> level.</li>
<li>This phenomenon is called the “multiple comparisons problem”.</li>
<li>The solution: Make the <span class="math inline">\(\alpha\)</span> level smaller, to compensate for this increased likelihood of rejecting the H0.</li>
</ul>
</div>
<div class="dapr2callout">
<p><strong>What are two common ways that we can correct for running multiple statistical tests on the same data?</strong></p>
<ul>
<li>Bonferroni correction (a global adjustment to all <span class="math inline">\(\alpha\)</span>s).</li>
<li>Tukey’s HSD (an adjustment to each comparison’s <span class="math inline">\(\alpha\)</span> based on how different the two group means being compared are).</li>
</ul>
</div>
</section>
<section id="this-week" class="slide level2">
<h2>This week</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Tasks:</strong></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/labs.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Attend your lab and work together on the exercises</strong></p>
</div><div class="column" style="width:50%;">
<p><strong>Support:</strong></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/forum.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Help each other on the Piazza forum</strong></p>
</div></div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/exam.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Complete the weekly quiz</strong></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/oh.png" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Attend office hours (see Learn page for details)</strong></p>
</div></div>
</section></section>
<section>
<section id="appendix" class="title-slide slide level1 appendix center" data-background-color="#BF1932" data-visibility="uncounted">
<h1>Appendix</h1>

</section>
<section id="code-for-data-plot" class="slide level2" data-visibility="uncounted">
<h2>Code for data plot</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="" aria-hidden="true" tabindex="-1"></a>hosp <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Treatment, <span class="at">y =</span> SWB, <span class="at">colour =</span> Treatment, <span class="at">fill =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Hospital) <span class="sc">+</span></span>
<span id="cb44-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">'point'</span>, <span class="at">colour =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb44-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-40-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="code-for-visualising-manual-chunks" class="slide level2" data-visibility="uncounted">
<h2>Code for visualising manual chunks</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="" aria-hidden="true" tabindex="-1"></a>hosp <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-3"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">TrtmtType =</span> <span class="fu">ifelse</span>(Treatment <span class="sc">==</span> <span class="st">'Meds'</span>, <span class="st">'PharmaTherapy'</span>, <span class="st">'TalkTherapy'</span>)</span>
<span id="cb45-4"><a href="" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TrtmtType, <span class="at">y =</span> SWB)) <span class="sc">+</span></span>
<span id="cb45-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb45-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Treatment), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Hospital) <span class="sc">+</span></span>
<span id="cb45-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="dapr2_14_ixn_manual_files/figure-revealjs/unnamed-chunk-41-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="h0-and-h1-latex-code" class="slide level2" data-visibility="uncounted">
<h2>H0 and H1 LaTeX code</h2>
<p><strong>Version 1: Differences are the same (H0) or not the same (H1):</strong></p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} =
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \\

H_1 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \neq
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}}
\end{align}\]</span></p>
<pre><code>$$
\begin{align}
H_0 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} = 
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \\

H_1 &amp;: \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \neq 
\frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} 
\end{align}
$$</code></pre>
<p><br></p>
<p><strong>Version 2, also fine: Difference between differences is zero (H0) or not zero (H1):</strong></p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) -
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) = 0 \\

H_1 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) -
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) \neq 0 \\
\end{align}\]</span></p>
<pre><code>$$
\begin{align}
H_0 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) - 
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) = 0 \\

H_1 &amp;: \Big( \frac{ \mu_{\text{CBT,Hosp1}} + \mu_{\text{EMDR,Hosp1}} }{2} - \mu_{\text{Meds,Hosp1}} \Big) - 
\Big( \frac{ \mu_{\text{CBT,Hosp2}} + \mu_{\text{EMDR,Hosp2}} }{2} - \mu_{\text{Meds,Hosp2}} \Big) \neq 0 \\
\end{align}
$$</code></pre>
</section>
<section id="linear-expression-for-model" class="slide level2" data-visibility="uncounted">
<h2>Linear expression for model</h2>
<p><br></p>
<p><span class="math display">\[
\begin{align}
\text{SWB} ~=~&amp; \beta_0 +
(\beta_1 \cdot \text{Treatment}_{\text{EMDR}}) +
(\beta_2 \cdot \text{Treatment}_{\text{Meds}}) +
(\beta_3 \cdot \text{Hospital}) ~ + \\
&amp; (\beta_4 \cdot \text{Treatment}_{\text{EMDR}} \cdot \text{Hospital}) +
(\beta_5 \cdot \text{Treatment}_{\text{Meds}} \cdot \text{Hospital}) +
\epsilon
\end{align}
\]</span> <br></p>
</section>
<section id="are-we-adjusting-alpha-or-p" class="slide level2" data-visibility="uncounted">
<h2>Are we adjusting <span class="math inline">\(\alpha\)</span> or p?</h2>
<p>If we compare <code>pairs()</code> with no correction and with the Bonferroni correction, it’s only the p-values that change.</p>
<div class="columns">
<div class="column" style="font-size:85%">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">'Treatment'</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hospital = Hosp1:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR     0.673 0.523 174   1.287  0.1998
 CBT - Meds    -0.697 0.523 174  -1.332  0.1847
 EMDR - Meds   -1.370 0.523 174  -2.619  0.0096

Hospital = Hosp2:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR    -5.137 0.523 174  -9.819 &lt;0.0001
 CBT - Meds     0.127 0.523 174   0.242  0.8090
 EMDR - Meds    5.263 0.523 174  10.061 &lt;0.0001</code></pre>
</div>
</div>
</div><div class="column" style="font-size:90%">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1_emm, <span class="at">simple =</span> <span class="st">'Treatment'</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hospital = Hosp1:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR     0.673 0.523 174   1.287  0.5993
 CBT - Meds    -0.697 0.523 174  -1.332  0.5541
 EMDR - Meds   -1.370 0.523 174  -2.619  0.0288

Hospital = Hosp2:
 contrast    estimate    SE  df t.ratio p.value
 CBT - EMDR    -5.137 0.523 174  -9.819 &lt;0.0001
 CBT - Meds     0.127 0.523 174   0.242  1.0000
 EMDR - Meds    5.263 0.523 174  10.061 &lt;0.0001

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
</div></div>
<p>So technically, <code>pairs()</code> adjusts p, not <span class="math inline">\(\alpha\)</span>. But whichever one is adjusted, the results are equivalent!</p>
<p><strong>Adjusting <span class="math inline">\(\alpha\)</span> by dividing by 3 is the same as adjusting p by multiplying by 3</strong> (and if the value ends up above 1, setting it equal to 1).</p>
<p>For example, the unadjusted p-value in <code>Hosp1</code> for <code>CBT - Meds</code>, 0.1847, multiplied by 3 (the number of tests), is the Bonferroni-adjusted p-value, 0.5541.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1847</span> <span class="sc">*</span> <span class="dv">3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5541</code></pre>
</div>
</div>
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<!-- a -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- b -->
<!-- ::: -->
<!-- :::: -->

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/reveal-attribution/attribution.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="dapr2_14_ixn_manual_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1294,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealAttribution, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <style>
      .hide {
        display: none !important;
      }
    </style>


    <script>
      function remove() {
        let footer = document.querySelector('div.footer');
        let slideNo = document.querySelector('div.slide-number');
        slideNo.classList.add('hide');
        footer.classList.add('hide');
      
        Reveal.on('slidechanged', event => {  
          if(Reveal.isFirstSlide()) {
            slideNo.classList.add('hide');
            footer.classList.add('hide');
          } else {
            slideNo.classList.remove('hide');
            footer.classList.remove('hide');
          }
        });
      }
      
      window.onload = remove();
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>