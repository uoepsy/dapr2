<!DOCTYPE html>
<html lang="en"><head>
<script src="dapr2_09_boot_files/libs/clipboard/clipboard.min.js"></script>
<script src="dapr2_09_boot_files/libs/quarto-html/tabby.min.js"></script>
<script src="dapr2_09_boot_files/libs/quarto-html/popper.min.js"></script>
<script src="dapr2_09_boot_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="dapr2_09_boot_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dapr2_09_boot_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="dapr2_09_boot_files/libs/quarto-html/quarto-syntax-highlighting-89ef1ee790bdc269b52a829279c5ce0e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="Elizabeth Pankratz (elizabeth.pankratz@ed.ac.uk)">
  <title>Bootstrapping and   confidence intervals</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dapr2_09_boot_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="dapr2_09_boot_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="dapr2_09_boot_files/libs/revealjs/dist/theme/quarto-53a9c49a12a3ad833bd88c7bb89b20b5.css">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/reveal-attribution/attribution.css" rel="stylesheet">
  <link href="dapr2_09_boot_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
  $(document).ready(function() {
      $('.cell').each(function() {
          let highlightLines = $(this).attr('data-output-line-numbers');
          if (highlightLines) {
              let lines = highlightLines.split(',').map(x => parseInt(x));
              $(this).find('.cell-output-stdout pre code').html(function(_, html) {
                  return html.split('\n').map((line, index) => {
                      if (lines.includes(index + 1)) {
                          return '<span style="background-color: #D0D8FC;">' + line + '</span>';
                      } else {
                          return line;
                      }
                  }).join('\n');
              });
          }
      });
  });
  </script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#BF1932" class="quarto-title-block center">
  <h1 class="title">Bootstrapping and <br> confidence intervals</h1>
  <p class="subtitle"><br>Data Analysis for Psychology in R 2</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Elizabeth Pankratz (elizabeth.pankratz@ed.ac.uk) 
</div>
        <p class="quarto-title-affiliation">
            <br>Department of Psychology<br>University of Edinburgh<br>2025–2026
          </p>
    </div>
</div>

</section>
<section>
<section id="course-overview" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Course Overview</h1>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<table style="border: 1px solid black;>
  <tr style=" padding:="" 0="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>Introduction to Linear Models</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Intro to Linear Regression</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Interpreting Linear Models</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Testing Individual Predictors</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Model Testing &amp; Comparison</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Linear Model Analysis</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>Analysing Experimental Studies</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Categorical Predictors &amp; Dummy Coding</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
            Effects Coding &amp; Coding Specific Contrasts</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        Assumptions &amp; Diagnostics</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        <b>Bootstrapping</b></td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
            Categorical Predictor Analysis</td></tr>
</tbody></table>
</div><div class="column" style="width:50%;">
<table style="border: 1px solid black;>
  <tr style=" padding:="" 0="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>Interactions</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interactions I</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interactions II</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interactions III</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Analysing Experiments</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Interaction Analysis</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>Advanced Topics</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Power Analysis</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Binary Logistic Regression I</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Binary Logistic Regression II</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        Logistic Regression Analysis</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
            Exam Prep and Course Q&amp;A</td></tr>
</tbody></table>
</div></div>
</section>
<section id="this-weeks-learning-objectives" class="slide level2">
<h2>This week’s learning objectives</h2>
<p><br></p>
<div style="font-size: 125%;">
<div class="fragment">
<div class="dapr2callout">
<p>What is bootstrapping?</p>
</div>
</div>
<div class="fragment">
<div class="dapr2callout">
<p>How does bootstrapping work?</p>
</div>
</div>
<div class="fragment">
<div class="dapr2callout">
<p>When would we bootstrap a linear model’s estimates?</p>
</div>
</div>
<div class="fragment">
<div class="dapr2callout">
<p>What does “confidence” in “95% confidence interval” actually mean?</p>
</div>
</div>
</div>
</section>
<section id="whats-a-bootstrap" class="slide level2">
<h2>What’s a bootstrap?</h2>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/bootstrap.svg" class="quarto-figure quarto-figure-center" height="500"></p>
</figure>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>What do bootstraps have to do with stats?</p>
<p><strong>Unclear.</strong></p>
<p><br></p>
<p>We’ll revisit this question later once we’ve seen the method in action.</p>
</div>
</section></section>
<section>
<section id="background" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Background</h1>

</section>
<section id="what-problem-does-bootstrapping-solve" class="slide level2">
<h2>What problem does bootstrapping solve?</h2>
<!-- intuitions borrowed from nice SO post: https://stats.stackexchange.com/a/26093 -->
<p><br></p>
<p>The core challenge in statistics:</p>
<p><strong>We want to know something about a population, but we can’t possibly study the whole population.</strong></p>
<p><strong>We can only draw a sample from it.</strong></p>
<p><br></p>
<p>We ask a question of the sample (e.g., what’s the mean?). And we get a single answer (e.g., 10).</p>
<p><strong>How do we know if this answer is representative of the population overall?</strong></p>
<p><br></p>
<p>Ideally, we would take many samples from the population, get their means, and compare them all.</p>
<p><strong>But we are constrained to this one sample.</strong></p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="dapr2callout">
<p>One strategy: <strong>Use mathematical tools</strong> like the formula you learned for the standard error.</p>
<p>But those tools only give valid information if the assumptions behind them are met (e.g., that errors are normally distributed).</p>
<p>Otherwise, they give bad estimates of the actual variability in the population.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="dapr2callout">
<p>Another strategy: <strong>Treat the sample we’ve drawn as if it is a population,</strong> and draw many new samples from <em>it</em>.</p>
<p>This strategy doesn’t rely on mathematical assumptions.</p>
<p>This method is called <strong>bootstrapping.</strong></p>
</div>
</div></div>
</section>
<section id="other-problems-that-bootstrapping-can-solve" class="slide level2">
<h2>Other problems that bootstrapping can solve</h2>
<p><br></p>
<ol type="1">
<li>When <strong>samples are very small,</strong> uncertainty around parameters like the mean will be high. Bootstrapping can help us get more precise estimates of the parameters, though it assumes that our original sample will accurately represent the population (a shaky assumption when the samples are small!).</li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li>Context: Linear models can test whether a coefficient’s value is different from zero because we have a measure of difference (the t value) and we know how this statistic is distributed when the H0 is true. So: <strong>If we don’t know the sampling distribution of the measure we’re using when the H0 is true</strong>, then we can use bootstrapping to estimate the null distribution of whatever measure we’re using.</li>
</ol>
</section>
<section id="bootstrapping-resampling-from-a-sample" class="slide level2">
<h2>Bootstrapping: Resampling from a sample</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/boot-schematic.svg" class="quarto-figure quarto-figure-center" height="600"></p>
</figure>
</div>
</section>
<section id="why-is-bootstrapping-an-ok-thing-to-do" class="slide level2">
<h2>Why is bootstrapping an OK thing to do?</h2>
<p><br></p>
<p>Our main sample contains the best possible information we can get about a population. (Basically anything that we guessed would be worse.)</p>
<p>If our main sample was drawn at random, it will probably look quite a bit like the population.</p>
<p>So, drawing bootstrap samples from our main sample and summarising them will probably create a sampling distribution that looks a lot like the one we <em>would</em> get <em>if</em> we could sample repeatedly from the whole population.</p>
</section>
<section id="generate-bootstrapped-samples-by-sampling-with-replacement" class="slide level2">
<h2>Generate bootstrapped samples by sampling with replacement</h2>
<p>Imagine our main sample contains five shapes:</p>
<div class="hcenter">
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"></p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>If we could only sample each data point once:</p>
<div class="hcenter">
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"></p>
<p>Each sample is just a shuffled version of the original.</p>
</div>
</div><div class="column" style="width:50%;">
<p>If we could sample each data point repeatedly:</p>
<div class="hcenter">
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--square-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--change-history-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"></p>
<p><img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--circle-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--favorite-outline.svg"> <img style="vertical-align: text-bottom; width: 2em;" src="figs/material-symbols--kid-star-outline-sharp.svg"></p>
<p>Each sample is distinct!</p>
</div>
</div></div>
<p><strong>To create diverse samples, we need to be able to sample each data point repeatedly.</strong></p>
<p>This is called <strong>“sampling with replacement”</strong>.</p>
</section></section>
<section>
<section id="bootstrapping-demo" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Bootstrapping demo</h1>

</section>
<section id="activity-bootstrapping-our-own-samples" class="slide level2">
<h2>Activity: Bootstrapping our own samples</h2>
<p><br></p>
<p><strong>Population:</strong> All numbers from 1 to 100.</p>
<p><strong>Main sample (size 10):</strong></p>
<div class="hcenter" style="font-size: 125%;">
<p>6 &nbsp;&nbsp;&nbsp; 8 &nbsp;&nbsp;&nbsp; 17 &nbsp;&nbsp;&nbsp; 32 &nbsp;&nbsp;&nbsp; 70 &nbsp;&nbsp;&nbsp; 76 &nbsp;&nbsp;&nbsp; 79 &nbsp;&nbsp;&nbsp; 81 &nbsp;&nbsp;&nbsp; 85 &nbsp;&nbsp;&nbsp; 93</p>
</div>
<p><br></p>
<p><strong>Bootstrapped samples (size 10):</strong> Over to you!</p>
<div class="hcenter">
<p><img data-src="figs/boot-qualtrics-QR.svg" width="400"></p>
<p><a href="https://edin.ac/4nTcnMP" target="_blank">https://edin.ac/4nTcnMP</a></p>
</div>
</section>
<section id="what-just-happened" class="slide level2">
<h2>What just happened?</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figs/boot-schematic.svg" class="quarto-figure quarto-figure-center" height="600"></p>
</figure>
</div>
</section>
<section id="estimating-variability-using-the-sampling-distribution" class="slide level2">
<h2>Estimating variability using the sampling distribution</h2>
<p><br></p>
<ul>
<li>For each bootstrapped sample, we compute a summary statistic.</li>
<li>We represent all those summary statistics together using a <strong>sampling distribution</strong>.</li>
<li>A sampling distribution is useful because with it, <strong>we can estimate a parameter’s variability</strong> (i.e., standard error, confidence intervals).</li>
</ul>
<p><br></p>
<div class="dapr2callout">
<p><strong>The standard error of the parameter = </strong> the standard deviation of the sampling distribution.</p>
</div>
<div class="dapr2callout">
<p><strong>The 95% CI of the parameter =</strong> the range from the 2.5th percentile to the 97.5th percentile of the sampling distribution.</p>
<ul>
<li>2.5th percentile = 2.5% of values in the distribution are below this value</li>
<li>97.5th percentile = 97.5% of values in the distribution are below this value</li>
</ul>
</div>
</section>
<section id="any-summary-statistic-can-be-bootstrapped" class="slide level2">
<h2>Any summary statistic can be bootstrapped</h2>
<p><br></p>
<p>There’s nothing special about the mean.</p>
<p>We can use bootstrapping for any measure that summarises data points.</p>
<p><br></p>
<p>Most usefully for us: <strong>We can bootstrap the parameters of a linear model.</strong></p>
</section></section>
<section>
<section id="bootstrapping-linear-model-parameters" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Bootstrapping linear model parameters</h1>

</section>
<section id="which-model-assumptions-are-not-met" class="slide level2">
<h2>Which model assumptions are not met?</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-3-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<p><br> <br></p>
<p><img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsup-filled.svg"> <img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsdown-filled.svg"> &nbsp; <strong>L</strong>inearity?</p>
<p><br></p>
<p><img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsup-filled.svg"> <img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsdown-filled.svg"> &nbsp; <strong>I</strong>ndependent errors?</p>
<p><br></p>
<p><img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsup-filled.svg"> <img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsdown-filled.svg"> &nbsp; <strong>N</strong>ormally-distributed errors?</p>
<p><br></p>
<p><img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsup-filled.svg"> <img style="vertical-align: text-bottom; width: 1em;" src="figs/codicon--thumbsdown-filled.svg"> &nbsp; <strong>E</strong>qual variance of errors?</p>
</div></div>
</section>
<section id="check-linearity" class="slide level2">
<h2>Check: Linearity</h2>
<p><br></p>
<p>Use <code>geom_smooth()</code> to plot a straight line (<code>method = 'lm'</code>) and a curvy line (<code>method = 'loess'</code>). The curvy line should match the straight line.</p>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-4-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>Not perfect, but relatively good.</p>
</section>
<section id="check-normally-distributed-errors" class="slide level2">
<h2>Check: Normally-distributed errors</h2>
<p><br></p>
<p>With a Q-Q plot, compare the actual standardised residuals from the model (y axis) to the ones we’d expect, if errors were perfectly normally distributed (x axis).</p>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-6-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>Big divergences toward the extremes: there are more large residuals in our data than a normal distribution would have.</p>
</section>
<section id="check-equal-variance-of-errors" class="slide level2">
<h2>Check: Equal variance of errors</h2>
<p><br></p>
<p>With a plot of residuals vs.&nbsp;fitted values, check whether the residuals (y axis) are similar across all of the fitted/predicted values (x axis).</p>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-7-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>There’s a definite cone-shape here (ideally we’d want a random-looking cloud), so residuals do not have equal variance.</p>
</section>
<section id="the-verdict-uh-oh" class="slide level2">
<h2>The verdict: uh oh</h2>
<p><br></p>
<p>Bootstrapping can’t make a maybe-linear effect more linear.</p>
<p><br></p>
<p>But it <em>can</em> help us sidestep the problems that arise from non-normal residuals and unequal variance of residuals.</p>
<p><strong>When residuals are not normal and when they have unequal variance, then the standard error that a linear model gives us is a bad estimate of the actual variability</strong>.</p>
<p><br></p>
<p>So instead: we estimate the variability using bootstrapping.</p>
</section></section>
<section>
<section id="bootstrapping-step-by-step" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Bootstrapping, step by step</h1>

</section>
<section id="a-note" class="slide level2">
<h2>A note</h2>
<p><br><br><br></p>
<div class="dapr2callout">
<p><strong>You will never need to do bootstrapping step by step, the way I’m illustrating it here.</strong></p>
<p>I am showing you the steps to help you understand what’s happening behind the scenes when you run the simple code you’ll see later.</p>
</div>
</section>
<section id="bootstrapping-step-by-step-1" class="slide level2">
<h2>Bootstrapping, step by step</h2>
<ol type="1">
<li><p>From the main sample, take a new sample with replacement. You always sample the same number of data points as there were in the main sample. One sample bootstrapped.</p></li>
<li><p>Fit the linear model to the bootstrapped sample. Save the intercept and slope estimates.</p></li>
<li><p>Do 1 and 2 again and again. We’ll get a sampling distribution of intercept estimates and a sampling distribution of slope estimates.</p></li>
</ol>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(1)</strong></p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-8-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">
<p><strong>(2)</strong></p>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = boot_samples[[1]])

Coefficients:
(Intercept)            x  
      2.462       -0.661  </code></pre>
</div>
</div>
</div></div>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(3)</strong></p>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-10-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-11-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="bootstrapping-step-by-step-sample-2" class="slide level2">
<h2>Bootstrapping, step by step (Sample 2)</h2>
<ol type="1">
<li><p>From the main sample, take a new sample with replacement. You always sample the same number of data points as there were in the main sample. One sample bootstrapped.</p></li>
<li><p>Fit the linear model to the bootstrapped sample. Save the intercept and slope estimates.</p></li>
<li><p>Do 1 and 2 again and again. We’ll get a sampling distribution of intercept estimates and a sampling distribution of slope estimates.</p></li>
</ol>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(1)</strong></p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-12-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">
<p><strong>(2)</strong></p>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = boot_samples[[2]])

Coefficients:
(Intercept)            x  
      2.160       -0.663  </code></pre>
</div>
</div>
</div></div>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(3)</strong></p>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-14-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-15-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="bootstrapping-step-by-step-sample-3" class="slide level2">
<h2>Bootstrapping, step by step (Sample 3)</h2>
<ol type="1">
<li><p>From the main sample, take a new sample with replacement. You always sample the same number of data points as there were in the main sample. One sample bootstrapped.</p></li>
<li><p>Fit the linear model to the bootstrapped sample. Save the intercept and slope estimates.</p></li>
<li><p>Do 1 and 2 again and again. We’ll get a sampling distribution of intercept estimates and a sampling distribution of slope estimates.</p></li>
</ol>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(1)</strong></p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-16-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">
<p><strong>(2)</strong></p>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = boot_samples[[3]])

Coefficients:
(Intercept)            x  
      2.211       -0.684  </code></pre>
</div>
</div>
</div></div>
<div class="columns">
<div class="column" style="width:5%;">
<p><strong>(3)</strong></p>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-18-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:47%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-19-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="sampling-distribution-of-the-intercept" class="slide level2">
<h2>Sampling distribution of the intercept</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="figs/boot-int.gif"></p>
</div><div class="column" style="width:50%;">
<p><br> <br> <br></p>
<p><span class="math inline">\(\leftarrow\)</span> This sampling distribution consists of every Intercept value estimated by a linear model that was fit to a bootstrapped sample of data.</p>
<p><br></p>
<p>As we draw more bootstrapped samples, the mean Intercept (solid line) will come to match the original sample’s Intercept.</p>
<p><br></p>
<p>The standard deviation of the sampling distribution (dotted lines) = the standard error of the Intercept.</p>
</div></div>
</section>
<section id="sampling-distribution-of-the-slope" class="slide level2">
<h2>Sampling distribution of the slope</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="figs/boot-slp.gif"></p>
</div><div class="column" style="width:50%;">
<p><br> <br> <br></p>
<p><span class="math inline">\(\leftarrow\)</span> This sampling distribution consists of every slope value estimated by a linear model that was fit to a bootstrapped sample of data.</p>
<p><br></p>
<p>As we draw more bootstrapped samples, the mean slope (solid line) will come to match the original sample’s slope.</p>
<p><br></p>
<p>The standard deviation of the sampling distribution (dotted lines) = the standard error of the slope.</p>
<p><br></p>
<p><strong>Bootstrapping is a different way of estimating a parameter’s standard error.</strong></p>
</div></div>
</section></section>
<section>
<section id="bootstrapping-a-linear-model-in-r" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Bootstrapping a linear model in R</h1>

</section>
<section id="bootstrapping-a-linear-model-in-r-1" class="slide level2">
<h2>Bootstrapping a linear model in R</h2>
<p><br></p>
<p>Fit a standard linear model to the main sample.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> orig_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><br></p>
<p>Use <code>Boot()</code> from the package <code>car</code> to draw <code>R = 1000</code> bootstrapped samples.</p>
<p>By default, the bootstrapped samples will contain the same number of data points as the original sample.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a>mod_boot <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">Boot</span>(mod, <span class="at">R =</span> <span class="dv">1000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><br></p>
<p>Now <code>summary()</code> will give us a standard error for each parameter (but we know this is just the standard deviation of each parameter’s sampling distribution).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_boot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of bootstrap replications R = 1000 
            original bootBias bootSE bootMed
(Intercept)    2.115 0.006860  0.183   2.124
x             -0.813 0.000135  0.160  -0.811</code></pre>
</div>
</div>
</section>
<section id="manual-bootstrapping-closely-matches-boot" class="slide level2">
<h2>Manual bootstrapping closely matches <code>Boot()</code></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Number of bootstrap replications R = 1000 
            original bootBias bootSE bootMed
(Intercept)    2.115 0.006860  0.183   2.124
x             -0.813 0.000135  0.160  -0.811</code></pre>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-24-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-25-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="getting-our-95-confidence-intervals" class="slide level2">
<h2>Getting our 95% confidence intervals</h2>
<p><br></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_boot, <span class="at">type =</span> <span class="st">'perc'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

            2.5 % 97.5 %
(Intercept)  1.74  2.477
x           -1.14 -0.526</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Hypothesis tests:</strong></p>
<p>Because these 95% confidence intervals don’t include 0,</p>
<ul>
<li>we can reject the H0 that the Intercept = 0 at <span class="math inline">\(\alpha\)</span> = 0.05.</li>
<li>we can reject the H0 that the slope = 0 at <span class="math inline">\(\alpha\)</span> = 0.05.</li>
</ul>
</section>
<section id="reporting-results-of-a-bootstrapped-linear-model" class="slide level2">
<h2>Reporting results of a bootstrapped linear model</h2>
<p><br></p>
<p>Report parameter estimates the same way as usual, but make sure to include something like</p>
<p><br></p>
<blockquote>
<p>Because the assumptions of normality of errors and equal variance of errors were not met, all the standard errors and 95% CIs we report here were estimated from 1000 bootstrapped samples, using the <code>Boot()</code> function from the <code>car</code> package (Fox &amp; Weisberg, 2019).</p>
</blockquote>
<p><br></p>
<p>The citation:</p>
<ul>
<li>Fox, J., &amp; Weisberg, S. (2019). <em>An R companion to applied regression</em> (3rd edn). Sage. <a href="https://www.john-fox.ca/Companion/" class="uri">https://www.john-fox.ca/Companion/</a></li>
</ul>
<p>^ These are the people who developed the <code>car</code> (<strong>C</strong>ompanion to <strong>A</strong>pplied <strong>R</strong>egression) package.</p>
</section></section>
<section>
<section id="so-what-do-bootstraps-have-to-do-with-stats" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>So, what do bootstraps have to do with stats?</h1>

</section>
<section id="what-do-bootstraps-have-to-do-with-stats" class="slide level2">
<h2>What do bootstraps have to do with stats?</h2>
<p><br></p>
<p>Bradley Efron is the inventor of bootstrapping, and he introduced it in his 1979 paper by saying it’s a method</p>

<img data-src="figs/efron-obv.png" class="r-stretch"><p>(Reader, the reasons did not become obvious.)</p>
<p><br></p>
<p>The internet’s best guess: it has to do with the saying <strong>“pull yourself up by your bootstraps”</strong>.</p>
<ul>
<li>Previously, this saying meant “a pointless/useless act”.</li>
<li>These days, people use it to mean that
<ul>
<li>you’re independent,</li>
<li>you’re a self-starter,</li>
<li>you’re standing on your own two feet.</li>
</ul></li>
<li>We think that “bootstrapping” is used in that sense: <strong>you can get estimates of uncertainty from just a single sample, so in a way, your sample is “pulling itself up by its bootstraps”.</strong></li>
</ul>
</section></section>
<section>
<section id="confidence-interval-refresher" class="title-slide slide level1 center" data-background-color="#BF1932">
<h1>Confidence interval refresher</h1>

</section>
<section id="interpreting-confidence-intervals" class="slide level2">
<h2>Interpreting confidence intervals</h2>
<p><br></p>
<p>It’s common to imagine that a 95% CI means that there’s a 95% probability that our true value is in the interval.</p>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-27-1.svg" class="quarto-figure quarto-figure-center r-stretch"><div class="hcenter">
<p><strong>But this isn’t what they really mean! :(</strong></p>
</div>
</section>
<section id="so-what-do-confidence-intervals-mean" class="slide level2">
<h2>So what <em>do</em> confidence intervals mean?</h2>
<p><br></p>
<p>Confidence intervals rely on the idea of “hypothetical repeated sampling”.</p>
<ul>
<li><strong>hypothetical:</strong> we’re imagining something that isn’t really happening</li>
<li><strong>repeated:</strong> we’re imagining that we’re doing something over and over again</li>
<li><strong>sampling:</strong> we’re imagining that we’re drawing samples from the same population over and over again</li>
</ul>
<p><br></p>
<p>Side note: Hypothetical repeated sampling is <em>different</em> from bootstrapping because</p>
<ul>
<li>hypothetical repeated sampling <strong>imagines</strong> repeatedly drawing samples <strong>from the population</strong></li>
<li>bootstrapping <strong>really</strong> repeatedly draws samples <strong>from our original sample</strong></li>
</ul>
</section>
<section id="we-can-simulate-hypothetical-repeated-sampling-by-defining-our-own-reality" class="slide level2">
<h2>We can simulate hypothetical repeated sampling by defining our own “reality”</h2>
<p><br></p>
<p>Let’s look at the association between <strong>hours of sleep</strong> and the <strong>number of riddles solved in an hour.</strong></p>
<p>In the real true population (which we have defined, in order to illustrate how confidence intervals work), <br> the true association looks like this:</p>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-28-1.svg" class="r-stretch"></section>
<section id="repeatedly-draw-samples-from-that-true-population-and-fit-a-linear-model-to-each" class="slide level2">
<h2>Repeatedly draw samples from that true population and fit a linear model to each</h2>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-30-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="some-95-cis-of-the-slope-dont-contain-the-true-population-value-of-4" class="slide level2">
<h2>Some 95% CIs of the slope don’t contain the true population value of 4</h2>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-31-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="how-many-cis-contain-the-true-value" class="slide level2">
<h2>How many CIs contain the true value?</h2>
<p><br></p>
<p>If we’re using a <strong>95% CI</strong>, then we know that under hypothetical repeated sampling:</p>
<ul>
<li><strong>95</strong> out of every 100 CIs will contain the true population value.</li>
<li><strong>5</strong> of every 100 CIs will not.</li>
</ul>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-32-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="how-many-cis-contain-the-true-value-1" class="slide level2">
<h2>How many CIs contain the true value?</h2>
<p><br></p>
<p>If we’re using a <strong>60% CI</strong>, then we know that under hypothetical repeated sampling:</p>
<ul>
<li><strong>60</strong> out of every 100 CIs will contain the true population value.</li>
<li><strong>40</strong> of every 100 CIs will not.</li>
</ul>

<img data-src="dapr2_09_boot_files/figure-revealjs/unnamed-chunk-34-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="so-what-is-confidence" class="slide level2">
<h2>So what is “confidence”?</h2>
<p><br></p>
<p>“Confidence” refers to the process that generates the intervals.</p>
<ul>
<li><p><strong>A 95% confidence interval is generated using a process that, in the long run, makes 95 intervals that contain the true population value for every 5 intervals that do not.</strong></p></li>
<li><p>In general: a <span class="math inline">\(n\)</span>% confidence interval is generated using a process that, in the long run, makes <span class="math inline">\(n\)</span> intervals that contain the true population value for every 100 <span class="math inline">\(-~n\)</span> that do not.</p></li>
</ul>
<p><br></p>
<p>This is why it’s not true to say “there’s a 95% probability that the true value is in the 95% CI”.</p>
<ul>
<li>We have <strong>no idea</strong> whether any given confidence interval contains the true population value.</li>
<li>Either it does contain the true value (then the probability = 100%) or it does not (probability = 0%).</li>
<li><strong>For a given confidence interval, we have no way of knowing how likely each of those two outcomes is.</strong></li>
</ul>
</section>
<section id="building-an-analysis-workflow" class="slide level2">
<h2>Building an analysis workflow</h2>
<p><br></p>
<div class="r-stack">
<p><img data-src="figs/block2-flowchart-09-0.svg" class="fragment" height="550"></p>
<p><img data-src="figs/block2-flowchart-09-1.svg" class="fragment" height="550"></p>
</div>
</section>
<section id="revisiting-this-weeks-learning-objectives" class="slide level2">
<h2>Revisiting this week’s learning objectives</h2>
<p><br></p>
<div>
<div class="dapr2callout">
<p><strong>What is bootstrapping?</strong></p>
<ul>
<li>An alternative way of estimating the variability of a coefficient estimate (i.e., the standard error and confidence interval).</li>
<li>Unlike regular linear models, bootstrapping doesn’t require that errors be normally distributed or equal across the range of the predictor.</li>
</ul>
</div>
</div>
<div>
<div class="dapr2callout">
<p><strong>How does bootstrapping work?</strong></p>
<ul>
<li>It is based on repeatedly resampling from a given sample and then computing summary statistics on those samples.</li>
<li>By combining those summary values, we get a sampling distribution: our best guess about how that statistic is distributed in the population.</li>
</ul>
</div>
</div>
</section>
<section id="revisiting-this-weeks-learning-objectives-1" class="slide level2">
<h2>Revisiting this week’s learning objectives</h2>
<p><br></p>
<div>
<div class="dapr2callout">
<p><strong>When would we bootstrap a linear model’s estimates?</strong></p>
<ul>
<li>When a linear model’s residuals don’t fulfil the model’s assumptions about normality of errors and equal variance of errors.</li>
<li>Those assumptions are what makes the formulae for estimating standard error and confidence intervals work.</li>
<li>When those assumptions aren’t met, then we need a different way of estimating standard error and CIs: bootstrapping.</li>
</ul>
</div>
</div>
<div class="dapr2callout">
<p><strong>What does “confidence” in “95% confidence interval” actually mean?</strong></p>
<ul>
<li>“Confidence” is a property of the process that generates confidence intervals.</li>
<li>A 95% confidence interval is generated by a process that produces 95 intervals that contain the true value for every 5 that do not.</li>
<li><strong>95% confidence interval <span class="math inline">\(\neq\)</span> 95% probability that the interval contains the true value!!</strong>
<ul>
<li>Either the 95% CI contains the true value or it doesn’t. We have no idea how probable each of those scenarios is.</li>
</ul></li>
</ul>
</div>
</section>
<section id="this-week" class="slide level2">
<h2>This week</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="tasks">Tasks</h3>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/labs.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Attend your lab and work together on the exercises</strong></p>
</div><div class="column" style="width:50%;">
<h3 id="support">Support</h3>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/forum.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Help each other on the Piazza forum</strong></p>
</div></div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/exam.svg" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Complete the weekly quiz</strong></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="figs/oh.png" style="width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Attend office hours (see Learn page for details)</strong></p>
</div></div>
</section></section>
<section>
<section id="appendix" class="title-slide slide level1 appendix center" data-background-color="#BF1932" data-visibility="uncounted">
<h1>Appendix</h1>

</section>
<section id="cis-from-the-sampling-distributions-quantiles" class="slide level2" data-visibility="uncounted">
<h2>95% CIs from the sampling distribution’s quantiles</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_boot, <span class="at">type =</span> <span class="st">'perc'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

            2.5 % 97.5 %
(Intercept)  1.74  2.477
x           -1.14 -0.526</code></pre>
</div>
</div>
<p>The CIs from <code>Boot()</code> are close to the 2.5th and 97.5th quantiles of our manually created sampling distribution:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(</span>
<span id="cb13-2"><a href="" aria-hidden="true" tabindex="-1"></a>  boot_coefs_df_1k<span class="sc">$</span>Intercept,</span>
<span id="cb13-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb13-4"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> 2.5% 97.5% 
 1.73  2.47 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(</span>
<span id="cb15-2"><a href="" aria-hidden="true" tabindex="-1"></a>  boot_coefs_df_1k<span class="sc">$</span>x,</span>
<span id="cb15-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb15-4"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  2.5%  97.5% 
-1.151 -0.532 </code></pre>
</div>
</div>
<!-- :::: {.columns} -->
<!-- ::: {.column width="50%"} -->
<!-- a -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- b -->
<!-- ::: -->
<!-- :::: -->
<!-- style="font-size: 125%;" -->

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="dapr2_09_boot_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/reveal-attribution/attribution.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="dapr2_09_boot_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="dapr2_09_boot_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1294,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealAttribution, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <style>
      .hide {
        display: none !important;
      }
    </style>


    <script>
      function remove() {
        let footer = document.querySelector('div.footer');
        let slideNo = document.querySelector('div.slide-number');
        slideNo.classList.add('hide');
        footer.classList.add('hide');
      
        Reveal.on('slidechanged', event => {  
          if(Reveal.isFirstSlide()) {
            slideNo.classList.add('hide');
            footer.classList.add('hide');
          } else {
            slideNo.classList.remove('hide');
            footer.classList.remove('hide');
          }
        });
      }
      
      window.onload = remove();
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>