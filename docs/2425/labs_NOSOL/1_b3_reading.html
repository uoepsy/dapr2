<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Blocks 1, 2, &amp; 3 Flash Cards – DAPR2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-circle-right')) {
    f.classList.add('fa-circle-down')
    f.classList.remove('fa-circle-right')
} else {
    f.classList.add('fa-circle-right')
    f.classList.remove('fa-circle-down')
}
}
</script><script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="site_libs/typedarray-0.1/typedarray.min.js"></script><script src="site_libs/jquery-3.5.1/jquery.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      DAPR2
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DAPR2</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Semester 1</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Intro to Linear Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_01_slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_02_mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_03_mlr_stz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression &amp; Standardization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_04_model_fit_comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Fit and Comparisons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_05_writeup_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Block 1 Analysis &amp; Write-Up Example</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Analysing and Evaluating Experimental Studies</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_06_dummy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dummy Coding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_07_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Effects Coding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_08_assump_diag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assumptions and Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_09_bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_10_writeup_recap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Block 2 Analysis &amp; Write-Up Example</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Semester 2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Interaction Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_01_int1_nc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions I: Num x Cat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_02_int2_nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions II: Num x Num</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_03_int3_cc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions III: Cat x Cat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_04_simp_pair.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Effects, Pairwise Comparisons, &amp; Corrections</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_05_writeup_recap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Block 3 Analysis &amp; Write-Up Example</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Advanced Topics for LM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_b4_reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blocks 1, 2, 3, &amp; 4 Flash Cards</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_06_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sample Size and Power Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_07_glm1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_08_glm2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_09_writeup_recap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Block 4 Analysis &amp; Write-Up Example</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#back-to-basics" id="toc-back-to-basics" class="nav-link active" data-scroll-target="#back-to-basics">Back to Basics</a></li>
  <li>
<a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a>
  <ul class="collapse">
<li>
<a href="#numeric-exploration" id="toc-numeric-exploration" class="nav-link" data-scroll-target="#numeric-exploration">Numeric Exploration</a>
  <ul class="collapse">
<li><a href="#descriptives" id="toc-descriptives" class="nav-link" data-scroll-target="#descriptives">Descriptives</a></li>
  </ul>
</li>
  <li><a href="#visual-exploration" id="toc-visual-exploration" class="nav-link" data-scroll-target="#visual-exploration">Visual Exploration</a></li>
  </ul>
</li>
  <li><a href="#functions-and-mathematical-models" id="toc-functions-and-mathematical-models" class="nav-link" data-scroll-target="#functions-and-mathematical-models">Functions and Mathematical Models</a></li>
  <li>
<a href="#statistical-models" id="toc-statistical-models" class="nav-link" data-scroll-target="#statistical-models">Statistical Models</a>
  <ul class="collapse">
<li><a href="#numeric-outcomes-predictors" id="toc-numeric-outcomes-predictors" class="nav-link" data-scroll-target="#numeric-outcomes-predictors">Numeric Outcomes &amp; Predictors</a></li>
  <li><a href="#numeric-outcomes-categorical-predictors" id="toc-numeric-outcomes-categorical-predictors" class="nav-link" data-scroll-target="#numeric-outcomes-categorical-predictors">Numeric Outcomes &amp; Categorical Predictors</a></li>
  <li>
<a href="#interaction-models" id="toc-interaction-models" class="nav-link" data-scroll-target="#interaction-models">Interaction Models</a>
  <ul class="collapse">
<li><a href="#numeric-x-categorical-example" id="toc-numeric-x-categorical-example" class="nav-link" data-scroll-target="#numeric-x-categorical-example">Numeric x Categorical Example</a></li>
  <li><a href="#numeric-x-numeric-example" id="toc-numeric-x-numeric-example" class="nav-link" data-scroll-target="#numeric-x-numeric-example">Numeric x Numeric Example</a></li>
  <li><a href="#categorical-x-categorical-example" id="toc-categorical-x-categorical-example" class="nav-link" data-scroll-target="#categorical-x-categorical-example">Categorical x Categorical Example</a></li>
  </ul>
</li>
  <li><a href="#general" id="toc-general" class="nav-link" data-scroll-target="#general">General</a></li>
  <li><a href="#manual-contrasts" id="toc-manual-contrasts" class="nav-link" data-scroll-target="#manual-contrasts">Manual Contrasts</a></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons">Multiple Comparisons</a></li>
  </ul>
</li>
  <li><a href="#model-predicted-values-residuals" id="toc-model-predicted-values-residuals" class="nav-link" data-scroll-target="#model-predicted-values-residuals">Model Predicted Values &amp; Residuals</a></li>
  <li><a href="#data-transformations" id="toc-data-transformations" class="nav-link" data-scroll-target="#data-transformations">Data Transformations</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit">Model Fit</a></li>
  <li><a href="#model-comparisons" id="toc-model-comparisons" class="nav-link" data-scroll-target="#model-comparisons">Model Comparisons</a></li>
  <li><a href="#model-assumptions" id="toc-model-assumptions" class="nav-link" data-scroll-target="#model-assumptions">Model Assumptions</a></li>
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap">Bootstrap</a></li>
  <li>
<a href="#general-formatting-presenting-of-results" id="toc-general-formatting-presenting-of-results" class="nav-link" data-scroll-target="#general-formatting-presenting-of-results">General Formatting &amp; Presenting of Results</a>
  <ul class="collapse">
<li><a href="#latex-symbols-equations" id="toc-latex-symbols-equations" class="nav-link" data-scroll-target="#latex-symbols-equations">LaTeX Symbols &amp; Equations</a></li>
  <li><a href="#apa-formatting" id="toc-apa-formatting" class="nav-link" data-scroll-target="#apa-formatting">APA Formatting</a></li>
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables">Tables</a></li>
  <li><a href="#cross-referencing" id="toc-cross-referencing" class="nav-link" data-scroll-target="#cross-referencing">Cross Referencing</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Blocks 1, 2, &amp; 3 Flash Cards</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="lo">
<section id="flash-card-aims" class="level3"><h3 class="anchored" data-anchor-id="flash-card-aims">
<i class="fa fa-graduation-cap"></i> Flash Card Aims</h3>
<p>The purpose of these flashcards is to complement your Semester 1 Weeks 1 - 11,and Semester 2 Weeks 1 - 5 core learning materials i.e., your lecture and lab materials, by offering additional guidance and examples on key concepts/topics. It’s designed to deepen your understanding, clarify complex concepts, and help you make connections between different areas of study. Think of it as an extra resource that supports what you’re learning in the classroom.</p>
<p>You may want to consider using the below as a supporting document whilst your work through lab exercises, and/or refer to in order to aid revision.</p>
</section><section id="r-packages" class="level3"><h3 class="anchored" data-anchor-id="r-packages">
<i class="fab fa-r-project"></i> R Packages</h3>
<p>Within this reading, the following packages are used:</p>
<ul>
<li><strong>tidyverse</strong></li>
<li><strong>sjPlot</strong></li>
<li><strong>kableExtra</strong></li>
<li><strong>psych</strong></li>
<li><strong>emmeans</strong></li>
<li><strong>performance</strong></li>
<li><strong>car</strong></li>
<li><strong>interactions</strong></li>
</ul></section><section id="presenting-results" class="level3"><h3 class="anchored" data-anchor-id="presenting-results">
<i class="fa fa-pencil-square-o" aria-hidden="true"></i> Presenting Results</h3>
<p>Note that you must <strong>not</strong> copy any of the write-ups included below for future reports - if you do, you will be committing plagiarism, and this type of academic misconduct is taken very seriously by the University. You can find out more <a href="https://www.ed.ac.uk/academic-services/students/conduct/academic-misconduct">here</a>.</p>
</section>
</div>
<section id="back-to-basics" class="level1"><h1>Back to Basics</h1>
<p>For an overview of basic statistical tests and core concepts (e.g., <span class="math inline">\(p\)</span>-values), please revisit the <a href="https://uoepsy.github.io/dapr1/2324/">DAPR1 materials</a> for a refresher (also accessible via the DAPR1 Learn page).</p>
<div class="optional-begin">
<span id="opt-start-1" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-1', 'opt-start-1')"> <span class="olab">Terminology</span></span>
</div>
<div id="opt-body-1" class="optional-body" style="display: none;">
<p>Let’s spend some time to remind ourselves of some key terminology, specifically related to types of variables and study designs:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead><tr class="header">
<th>Term</th>
<th>Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(Observational) unit</td>
<td>The individual entities on which data are collected</td>
</tr>
<tr class="even">
<td>Variable</td>
<td>Any characteristic recorded on the observational units</td>
</tr>
<tr class="odd">
<td>Numeric variable</td>
<td>A variable that records a numerical quantity for each case. For such variables standard arithmetic operations make sense. For example: height, IQ, and weight</td>
</tr>
<tr class="even">
<td>Categorical variable</td>
<td>A categorical variable places units into one of several groups. For example: country of birth, dominant hand, and eye colour</td>
</tr>
<tr class="odd">
<td>Binary variable</td>
<td>A special case of categorical variable with only 2 possible levels. For example: handedness (left or right), smoking status (smoker or non-smoker), pass test (yes or no)</td>
</tr>
<tr class="even">
<td>Response variable (also more commonly called a dependent variable, or outcome variable)</td>
<td>Measures the outcome of interest in a study</td>
</tr>
<tr class="odd">
<td>Explanatory/independent variable (also called predictors)</td>
<td>Are used to explain differences/changes in the response variable</td>
</tr>
<tr class="even">
<td>Observational study</td>
<td>An observational study is a study in which the researcher does not manipulate any of the variables involved in the study, but merely records the values as they naturally exist</td>
</tr>
<tr class="odd">
<td>Experimental study</td>
<td>An experiment is a study in which the researcher imposes the values of the explanatory variable on the units before measuring the response variable</td>
</tr>
</tbody>
</table>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="data-exploration" class="level1"><h1>Data Exploration</h1>
<p>The common first port of call for almost any statistical analysis is to explore the data, and we can do this visually and/or numerically.</p>
<table cellspacing="3">
<tbody><tr style="border-bottom: 1px solid">
<th>
</th>
<th style="border-right: 1px solid">
Marginal Distributions
</th>
<th>
Bivariate Associations
</th>
</tr>
<tr style="border-bottom: 1px solid">
<td style="vertical-align:top">
<strong>Description</strong>
</td>
<td style="vertical-align:top;border-right: 1px solid">
The distribution of each variable individually (i.e., <em>without</em> reference to the values of the other variables).
</td>
<td style="vertical-align:top">
Describing the association between two numeric variables.
</td>
</tr>
<tr style="border-bottom: 1px solid">
<td style="vertical-align:top">
<strong>Visually</strong>
</td>
<td style="vertical-align:top;border-right: 1px solid">
Plot each variable individually.<br><br>You could use, for example, <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> for a density plot or <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> for a histogram to comment on and/or examine:<br><ul>
<li>
The <em>shape</em> of the distribution. Look at the shape, centre and spread of the distribution. Is it symmetric or skewed? Is it unimodal or bimodal?
</li>
<li>
Identify any <em>unusual observations</em>. Do you notice any extreme observations (i.e., outliers)?
</li>
</ul>
</td>
<td style="vertical-align:top">
Plot associations among two variables.<br><br>You could use, for example, <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> for a scatterplot to comment on and/or examine:<br><ul>
<li>
The <em>direction</em> of the association indicates whether there is a positive or negative association
</li>
<li>
The <em>form</em> of association refers to whether the relationship between the variables can be summarized well with a straight line or some more complicated pattern
</li>
<li>
The <em>strength</em> of association entails how closely the points fall to a recognizable pattern such as a line
</li>
<li>
<em>Unusual observations</em> that do not fit the pattern of the rest of the observations and which are worth examining in more detail
</li>
</ul>
</td>
</tr>
<tr style="border-bottom: 1px solid">
<td style="vertical-align:top">
<strong>Numerically</strong>&nbsp;&nbsp;&nbsp;
</td>
<td style="vertical-align:top;border-right: 1px solid">
Compute and report summary statistics e.g., mean, standard deviation, median, min, max, etc.<br><br>You could, for example, calculate summary statistics such as the mean (<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>) and standard deviation (<code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>), etc. within <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>
</td>
<td style="vertical-align:top">
Compute and report the correlation coefficient.<br><br>You can use the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function to calculate this
</td>
</tr>
</tbody></table>
<section id="numeric-exploration" class="level2"><h2 class="anchored" data-anchor-id="numeric-exploration">Numeric Exploration</h2>
<p>Numeric exploration of data involves examining key statistics like mean, median, and standard deviation via descriptives tables; and assessing the associations among variables through correlation coefficients. Exploring our data numerically helps us to identify patterns and associations in the data.</p>
<section id="descriptives" class="level3"><h3 class="anchored" data-anchor-id="descriptives">Descriptives</h3>
<div class="optional-begin">
<span id="opt-start-2" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-2', 'opt-start-2')"> <span class="olab">Descriptives Tables</span></span>
</div>
<div id="opt-body-2" class="optional-body" style="display: none;">
<p>There are numerous packages available that allow us to pull out descriptive statistics from our dataset such as <strong>tidyverse</strong> and <strong>psych</strong>.</p>
<p>When we pull out descriptive statistics, it is useful to present these in a well formatted table for your reader. There are lots of different ways of doing this, but one of the most common (and straightforward!) is to use the <code><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable()</a></code> function from the package <strong>kableExtra</strong>.</p>
<p>This allows us to give our table a clear caption (via <code>caption = "insert caption here"</code>, align values within columns e.g., center aligned via <code>align = "??"</code>), and we can also round to however many decimal places we desire (standard for APA is 2 dp; via <code>digits = ??</code>).</p>
<p>We can also add in the function <code><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling()</a></code>. This is really helpful for customising your table e.g., the font size, position, and whether or not you want the table full width (as well as lots of other things - check out the helper function!).</p>
<p>For an overview of how to make tables in RMarkdown, see <a href="https://uoepsy.github.io/scs/rmd-bootcamp/04-prettytab.html">Lesson 4 of the RMD bootcamp</a></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-3" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-3', 'opt-start-3')"> <span class="olab">Descriptives Tables - Examples</span></span>
</div>
<div id="opt-body-3" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" aria-current="page">The <strong>tidyverse</strong> way</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">The <strong>psych</strong> way</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>We can use the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> function to numerically summarise/describe our data. Some key values we may want to consider extracting are (though not limited to): the mean (via <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, standard deviation (via <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>), minimum value (via <code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code>), maximum value (via <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>), standard error (via <code>se()</code>), and skewness (via <code><a href="https://rdrr.io/pkg/psych/man/skew.html">skew()</a></code>).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Numeric values only example:</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Categorical and numeric values example:</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using the pre-loaded iris dataset</span></span>
<span><span class="co"># taking the mean and standard deviation of sepal length via the summarize function</span></span>
<span><span class="co"># returning a table with a caption, where numbers are rounded to 2 dp</span></span>
<span><span class="co"># asking for a table that is not the full width of the window display</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>        M_Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>        SD_Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Sepal Length Descriptives (in cm)"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Sepal Length Descriptives (in cm)</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">M_Length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD_Length</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">5.84</td>
<td style="text-align: right;">0.83</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using the pre-loaded iris dataset</span></span>
<span><span class="co"># grouping by Species. NOTE: we can group by 2 variables - we would just separate by a comma within group_by( , )</span></span>
<span><span class="co"># taking the mean and standard deviation of sepal length via the summarize function</span></span>
<span><span class="co"># returning a table of sepal length grouped by species with a caption, where numbers are rounded to 2 dp</span></span>
<span><span class="co"># asking for a table that is not the full width of the window display</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>        M_Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>        SD_Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Sepal Length (in cm) Grouped by Species Descriptives Table"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Sepal Length (in cm) Grouped by Species Descriptives Table</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Species</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">M_Length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD_Length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5.01</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5.94</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6.59</td>
<td style="text-align: right;">0.64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The <code><a href="https://rdrr.io/pkg/psych/man/describe.html">describe()</a></code> function will produce a table of descriptive statistics. If you would like only a subset of this output (e.g., mean, sd), you can use <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> after calling <code><a href="https://rdrr.io/pkg/psych/man/describe.html">describe()</a></code> e.g., <code>describe() %&gt;% select(mean, sd)</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Numeric values only example:</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Categorical and numeric values options:</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using the pre-loaded iris dataset</span></span>
<span><span class="co"># we want to get descriptive statistics of the iris dataset, specifically the sepal length column</span></span>
<span><span class="co"># we specifically want to select the mean and standard deviation from the descriptive statistics available (try this without including this argument to see what values you all get out)</span></span>
<span><span class="co"># returning a table with a caption, where numbers are rounded to 2 dp</span></span>
<span><span class="co"># asking for a table that is not the full width of the window display</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html">describe</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Sepal Length Descriptives (in cm)"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Sepal Length Descriptives (in cm)</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">X1</td>
<td style="text-align: right;">5.84</td>
<td style="text-align: right;">0.83</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><em>Note that this is quite an overly complex way to return these summary statistics - using the <code>tidyverse()</code> way is much more intuitive and straightforward!</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># using the pre-loaded iris dataset</span></span>
<span><span class="co"># we want to get descriptive statistics of the iris dataset, specifically the sepal length column by Species</span></span>
<span><span class="co"># we want to return a matrix (hence mat = TRUE), then convert this to a dataframe</span></span>
<span><span class="co"># we specifically want to select the mean and standard deviation from the descriptive statistics available (try this without including this argument to see what values you all get out)</span></span>
<span><span class="co"># returning a table with a new column names of Group, Mean, SD; adding a caption; numbers are rounded to 2 dp</span></span>
<span><span class="co"># asking for a table that is not the full width of the window display</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.by.html">describeBy</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span>, mat <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Mean"</span>, <span class="st">"SD"</span><span class="op">)</span>, caption <span class="op">=</span> <span class="st">"Sepal Length Descriptives (in cm)"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Sepal Length Descriptives (in cm)</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Group</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa</td>
<td style="text-align: right;">5.01</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor</td>
<td style="text-align: right;">5.94</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">virginica</td>
<td style="text-align: right;">6.59</td>
<td style="text-align: right;">0.64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<section id="correlation" class="level4"><h4 class="anchored" data-anchor-id="correlation">Correlation</h4>
<div class="optional-begin">
<span id="opt-start-4" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-4', 'opt-start-4')"> <span class="olab">Correlation Coefficient</span></span>
</div>
<div id="opt-body-4" class="optional-body" style="display: none;">
<p>The correlation coefficient is a standardised number which quantifies the strength and direction of the linear association between two variables. In a population it is denoted by <span class="math inline">\(\rho\)</span>, and in a sample it is denoted by <span class="math inline">\(r\)</span>.</p>
<p>Values of <span class="math inline">\(r\)</span> fall between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>. How to interpret:</p>
<ul>
<li>Size: More extreme values (i.e., the The closer <span class="math inline">\(r\)</span> is to <span class="math inline">\(+/- 1\)</span>) the stronger the linear association, and the closer to <span class="math inline">\(0\)</span> a weak/no association. Commonly used cut-offs are:
<ul>
<li>Weak = <span class="math inline">\(.1 &lt; |r| &lt; .3\)</span>
</li>
<li>Moderate = <span class="math inline">\(.3 &lt; |r| &lt; .5\)</span>
</li>
<li>Strong = <span class="math inline">\(|r| &gt; .5\)</span>
</li>
</ul>
</li>
<li>Direction: The sign of <span class="math inline">\(r\)</span> says nothing about the strength of the association, but its nature and direction:
<ul>
<li>Positive association means that values of one variable tend to be higher when values of the other variable are higher</li>
<li>Negative association means that values of one variable tend to be lower when values of the other variable are higher</li>
</ul>
</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-5" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-5', 'opt-start-5')"> <span class="olab">Correlation Matrix</span></span>
</div>
<div id="opt-body-5" class="optional-body" style="display: none;">
<p>A correlation matrix is a table showing the correlation coefficients - <span class="math inline">\(r_{(x,y)}=\frac{\mathrm{cov}(x,y)}{s_xs_y}\)</span> - between variables. Each cell in the table shows the association between two variables. The diagonals show the correlation of a variable with itself (and are therefore always equal to 1).</p>
<div class="blue">
<p><strong>In R</strong></p>
<p>We can create a correlation matrix by giving the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function a dataframe. It is important to remember that all variables <strong>must</strong> be numeric.</p>
</div>
<p>Let’s check the structure of the iris dataset to ensure that all variables are numeric:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>We can see that the variable <em>Species</em> in column 5 is a factor - this means that we cannot include this in our correlation matrix. Therefore, we need to <em>subset</em>, or, in other words, select specific columns. We can do this either giving the column numbers inside <code>[]</code>, or using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>. In our case, we want the variables in columns 1 - 4, just not 5.</p>
<p>If you had <code>NA</code> values within your dataset, you could choose to remove these <code>NA</code>s using <code>na.rm = TRUE</code> inside the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Index dataframe (<code>[]</code>)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Variable selection (<code>select()</code>)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         1.00       -0.12         0.87        0.82
Sepal.Width         -0.12        1.00        -0.43       -0.37
Petal.Length         0.87       -0.43         1.00        0.96
Petal.Width          0.82       -0.37         0.96        1.00</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># select only the columns we want by variable name, and pass this to cor()</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         1.00       -0.12         0.87        0.82
Sepal.Width         -0.12        1.00        -0.43       -0.37
Petal.Length         0.87       -0.43         1.00        0.96
Petal.Width          0.82       -0.37         0.96        1.00</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-6" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-6', 'opt-start-6')"> <span class="olab">Correlation - Hypothesis Testing</span></span>
</div>
<div id="opt-body-6" class="optional-body" style="display: none;">
<p>The hypotheses of the correlation test are, as always, statements about the <em>population</em> parameter (in this case the correlation between the two variables in the population - i.e., <span class="math inline">\(\rho\)</span>).</p>
<p>If we are conducting a two tailed test, then…</p>
<ul>
<li>
<span class="math inline">\(H_0: \rho = 0\)</span>. There is <em>no</em> linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in the population.<br>
</li>
<li>
<span class="math inline">\(H_1: \rho \neq 0\)</span> There is a linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
</ul>
<p>If we instead conduct a one-tailed test, then we are testing either…</p>
<ul>
<li>
<span class="math inline">\(H_0: \rho \leq 0\)</span> There is a negative or no linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span><br>
</li>
<li>
<span class="math inline">\(H_1: \rho &gt; 0\)</span> There is a positive linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
</ul>
<p><strong>OR</strong></p>
<ul>
<li>
<span class="math inline">\(H_0: \rho \geq 0\)</span> There is a positive or no linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span><br>
</li>
<li>
<span class="math inline">\(H_1: \rho &lt; 0\)</span> There is a negative linear association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
</ul>
<p><strong>Test Statistic</strong></p>
<p>The test statistic for this test is the <span class="math inline">\(t\)</span> statistic, the formula for which depends on both the observed correlation (<span class="math inline">\(r\)</span>) and the sample size (<span class="math inline">\(n\)</span>):</p>
<p><span class="math display">\[t = r \sqrt{\frac{n-2}{1-r^2}}\]</span></p>
<p><strong>p-value</strong></p>
<p>We calculate the <span class="math inline">\(p\)</span>-value for our <span class="math inline">\(t\)</span>-statistic as the long-run probability of a <span class="math inline">\(t\)</span>-statistic with <span class="math inline">\(n-2\)</span> degrees of freedom being less than, greater than, or more extreme in either direction (depending on the direction of our alternative hypothesis) than our observed <span class="math inline">\(t\)</span>-statistic.</p>
<p><strong>Assumptions</strong></p>
<p>For a test of Pearson’s correlation coefficient <span class="math inline">\(r\)</span>, we need to make sure a few conditions are met:</p>
<ul>
<li>Both variables are quantitative (i.e., numeric)</li>
<li>Both variables are drawn from normally distributed populations</li>
<li>The association between the two variables is linear</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-7" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-7', 'opt-start-7')"> <span class="olab">Correlation - Hypothesis Testing in R</span></span>
</div>
<div id="opt-body-7" class="optional-body" style="display: none;">
<div class="blue">
<p><strong>In R</strong></p>
<p>We can test the significance of the correlation coefficient really easily with the function <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Sepal.Length and iris$Petal.Length
t = 21.646, df = 148, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8270363 0.9055080
sample estimates:
      cor 
0.8717538 </code></pre>
</div>
</div>
<p>Note, by default, <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> will include only observations that have no missing data on either variable.</p>
<p>We can specify whether we want to conduct a one- or two-tailed test by adding the argument <code>alternative =</code> and specifying <code>alternative = "less"</code>, <code>alternative = "greater"</code>, or <code>alternative = "two.sided"</code> (the latter being the default).</p>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>There was a strong positive association between sepal length and petal length <span class="math inline">\((r = .87, t(148) = 21.65, p &lt; .001)\)</span>. These results suggested that a greater sepal length was positively associated with a greater petal length.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a detailed recap of all things correlation (including further details and examples), revisit the <a href="https://uoepsy.github.io/dapr1/2324/lectures/dapR1_lec20_Correlation.pdf">Correlation lecture from DAPR1</a>.</p>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section></section></section><section id="visual-exploration" class="level2"><h2 class="anchored" data-anchor-id="visual-exploration">Visual Exploration</h2>
<p>Visual exploration of our data allows us to visualize the distributions of our data, and to identify potential associations between variables.</p>
<div class="optional-begin">
<span id="opt-start-8" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-8', 'opt-start-8')"> <span class="olab">How to Visualise Data</span></span>
</div>
<div id="opt-body-8" class="optional-body" style="display: none;">
<p>To visualise (i.e., plot) our data, we can use <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> from the <strong>tidyverse</strong> package. Note the key components of the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> code:</p>
<ul>
<li>
<code>data =</code> where we provide the name of the dataframe.</li>
<li>
<code>aes =</code> where we provide the aesthetics. These are things which we map from the data to the graph. For instance, the <span class="math inline">\(x\)</span>-axis, or if we wanted to colour the columns/bars according to some aspect of the data.</li>
<li>
<code>+ geom_...</code> = where we add (using +) some geometry. These are the shapes (e.g., bars, points, etc.), which will be put in the correct place according to what we specified in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> = where we provide labels for our plot (e.g., the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-axis)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are lots of arguments that you can further customise, some of which are specified in the examples below e.g., <code>bins =</code>, <code>alpha =</code>, <code>fill =</code>, <code>linewidth =</code>. <code>linetype =</code>, <code>size =</code> etc. For these, you can look up the helper function to see the range of arguments they can take using <code>?</code> - e.g., <code><a href="https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html">?fill</a></code></p>
<p>If you’d like to read more about <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, there is a handy <a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">cheatsheet</a>.</p>
</div>
</div>
<p>One other thing to consider when visualising your data is how you are going to arrange your plots. Some handy tips on this:</p>
<ul>
<li>Use to wrap text in your titles and or axis labels<br>
</li>
<li>The <strong>patchwork</strong> package allows us to arrange multiple plots in two ways - <code>|</code> arranges the plots adjacent to one another, and <code>/</code> arranges the plots on top of one another</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-9" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-9', 'opt-start-9')"> <span class="olab">Data Visualisation - Marginal Examples</span></span>
</div>
<div id="opt-body-9" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Histogram</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Density</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>A histogram shows the frequency of values which fall within bins of an equal width.</p>
<p><strong>Basic:</strong></p>
<ul>
<li>x-axis: possible values of some variable, grouped into bins</li>
<li>y-axis: frequency of a given value or values within bins</li>
<li>
<em>What are bins?</em>: A bin represents a range of scores</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Updating Bins:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, we can specify <code>bins =</code> to specify the number of columns we want (for this example, lets say we want 10):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, we can specify <code>binwidth =</code> to specify the width of each bin (it is very helpful to be aware of the scale of your variable here!):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Outline columns with color:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, we can specify <code>color =</code> to set a colored outline of the columns:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Fill columns with color:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, we can specify <code>fill =</code> to fill the columns with a color:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>A visualization of the distribution of a numeric variable.</p>
<p><strong>Basic:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Filled:</strong></p>
<p>We can fill our plot with colour by specifying <code>fill =</code> within <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Line Type &amp; Width:</strong></p>
<p>We can change the type and width of the line by specifying <code>linetype =</code> and <code>linewidth =</code> within <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">6</span>, linewidth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-10" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-10', 'opt-start-10')"> <span class="olab">Data Visualisation - Bivariate Examples</span></span>
</div>
<div id="opt-body-10" class="optional-body" style="display: none;">
<p>Unlike in our marginal plots where we specified our x-axis variable within <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, to visualise bivariate associations, we need to specify what variables we want on both our x- and y-axis.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Scatterplot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Boxplot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Facets</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>We can use a scatterplot (since the variables are numeric and continuous) to visualise the association between the two numeric variables - these will be our x- and y-axis values.</p>
<p>We plot these values for each row of our dataset, and we should end up with a <em>cloud</em> of scattered points.</p>
<p>Here we will want to comment on any key observations that we notice, including if we detect outliers or points that do not fit with the pattern in the rest of the data. Outliers are extreme observations that are not possible values of a variable or that do not seem to fit with the rest of the data. This could either be:</p>
<ul>
<li>
<em>marginally</em> along one axis: points that have an unusual (too high or too low) x-coordinate or y-coordinate;</li>
<li>
<em>jointly</em>: observations that do not fit with the rest of the point cloud</li>
</ul>
<p><strong>Basic:</strong></p>
<p>We need to specify <code>+ geom_point()</code> to get a scatterplot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Fill points with color:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, we can specify <code>color =</code> to fill the points with a color:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Change size and opacity:</strong></p>
<p>We can change the size (using <code>size =</code>) and the opacity (using <code>alpha =</code>) of our geom elements on the plot. Let’s include this below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Add a line of best fit:</strong></p>
<p>We can superimpose (i.e., add) a line of best fit by including the argument <code>+ geom_smooth()</code>. Since we want to fit a straight line, we want to use <code>method = "lm"</code>. We can also specify whether we want to display confidence intervals around our line by specifying <code>se = TRUE / FALSE</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>We can use a boxplot to visualise the association between one numeric variable and one categorical variable - these will be our y- and x-axis values respectively.</p>
<p><strong>Basic:</strong></p>
<p>We need to specify <code>+ geom_boxplot()</code> to get a boxplot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Change boxplot fill colours by group:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, we can specify <code>fill =</code> to fill the boxes with a color:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Change boxplot line colours by group:</strong></p>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, we can specify <code>color =</code> to colour the lines with a color:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Adding jitter:</strong></p>
<p>We can add jittered points to a boxplot to better see the underlying distribution of the data (by adding a little random variation to each data point) via <code><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Change legend position:</strong></p>
<p>We can add the argument <code>+ theme(legend.position = )</code> to move (or even remove) the legend by specifying, for example, <code>"right"</code>, <code>"left"</code>, <code>"top"</code>, <code>"bottom"</code>, or <code>"none"</code> to remove.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># legend at bottom of plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>When we have two numeric variables, as well as categorical variables, we can use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> / <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> to help divide/arrange our plots. If we had two categorical variables, by simply stringing them together to further group our plots by specifying <code>facet_wrap( ~ cat_variable1 + cat_variable2)</code></p>
<p><strong>Basic:</strong></p>
<p>We need to specify <code>+ geom_point()</code> to get a scatterplot, and <em>either</em> <code>+ facet_wrap()</code> or <code>+ facet_grid()</code> to separate by your categorical variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Species</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Add a line of best fit:</strong></p>
<p>We can superimpose (i.e., add) a line of best fit by including the argument <code>+ geom_smooth()</code>. Since we want to fit a straight line, we want to use <code>method = "lm"</code>. We can also specify whether we want to display confidence intervals around our line by specifying <code>se = TRUE / FALSE</code>. Note that a line is fitted for every level of your categorical variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Species</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Subplot layout:</strong></p>
<p>You can change the overall layout of the subplots by specifying <code>dir =</code> within the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> argument, where <code>“h”</code> will return a horizontal layout (this is the default) and <code>“v”</code> for vertical.</p>
<p>You can also change the layout of the subplot labels by specifying <code>strip.position =</code> within the <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> argument, where labels can be arranged to display at the <code>“top”</code> (this is the default), <code>“bottom”</code>, <code>“left”</code> or <code>“right”</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Species</span>, dir <span class="op">=</span> <span class="st">"v"</span>, strip.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Petal Length (in cm)"</span>, y <span class="op">=</span> <span class="st">"Sepal Length (in cm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section></section><section id="functions-and-mathematical-models" class="level1"><h1>Functions and Mathematical Models</h1>
<p>Basic functions and mathematical models are foundational tools used to describe and predict associations between variables.</p>
<div class="optional-begin">
<span id="opt-start-11" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-11', 'opt-start-11')"> <span class="olab">Identification &amp; Specification</span></span>
</div>
<div id="opt-body-11" class="optional-body" style="display: none;">
<p>Consider the function <span class="math inline">\(y = 2 + 5 \ x\)</span>. From this, we can do the following:</p>
<ul>
<li>Identify the dependent variable (DV)</li>
<li>Identify the independent variable (IV)</li>
<li>Describe in words what the function does, and compute the output for the following input:</li>
</ul>
<p><span class="math display">\[
x = \begin{bmatrix}
2 \\
6
\end{bmatrix}
\]</span></p>
<p>The function says that the <span class="math inline">\(y\)</span> value is obtained as a transformation of the <span class="math inline">\(x\)</span> value.</p>
<ul>
<li>The dependent variable is <span class="math inline">\(y\)</span>
</li>
<li>The independent variable is <span class="math inline">\(x\)</span>
</li>
<li>The <span class="math inline">\(y\)</span> value is obtained as five times <span class="math inline">\(x\)</span>, plus two.</li>
</ul>
<p><br> Example (1): If <span class="math inline">\(x\)</span> equals 2, the corresponding value of <span class="math inline">\(y\)</span> will be <span class="math inline">\(2 + 5 * 2 = 12\)</span>. <br> Example (2): If <span class="math inline">\(x\)</span> equals 6, the corresponding value of <span class="math inline">\(y\)</span> will be <span class="math inline">\(2 + 5 * 6 = 32\)</span>.</p>
<p><span class="math display">\[
y = \begin{bmatrix}
2 + 5 * 2 \\
2 + 5 * 6
\end{bmatrix}
= \begin{bmatrix}
12 \\
32
\end{bmatrix}
\]</span></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-12" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-12', 'opt-start-12')"> <span class="olab">Deterministic Models - Description &amp; Specification</span></span>
</div>
<div id="opt-body-12" class="optional-body" style="display: none;">
<p>We come across functions <em>a lot</em> in daily life, and probably don’t think much about it. In a slightly more mathematical setting, we can write down in words and in symbols the function describing the association between the side of a square and its perimeter (e.g., to capture <em>how</em> the perimeter <em>varies</em> as a function of its side). In this case, the perimeter is the dependent variable, and the side is the independent variable.</p>
<p>This is what we would refer to as a <em>deterministic model</em>, as it is a model of an <em>exact relationship</em> - there can be no deviation.</p>
<p><strong>Model Specification</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">In words</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">In symbols</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>The perimeter of a square is four times the length of its side.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>The relationship between side and perimeter of squares is given by:</p>
<p><span class="math display">\[
Perimeter = 4 * Side
\]</span></p>
<p>If you denote <span class="math inline">\(y\)</span> as the dependent variable <em>Perimeter</em>, and <span class="math inline">\(x\)</span> as the independent variable <em>Side</em> we can rewrite as:</p>
<p><span class="math display">\[
y = 4 * x
\]</span></p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-13" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-13', 'opt-start-13')"> <span class="olab">Deterministic Models - Visualisation</span></span>
</div>
<div id="opt-body-13" class="optional-body" style="display: none;">
<p>Let’s create a dataset called <code>squares</code>, containing the perimeter of four squares having sides of length <span class="math inline">\(0, 2, 5, 9\)</span> meters, and then plot the <code>squares</code> data as points on a scatterplot.</p>
<p>First, let’s make our squares data. Here we will use two important functions - <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code> and <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>. The <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code> function allows us to construct a data frame. To store a sequence of numbers into R, we can <strong>c</strong>ombine the values using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>. A sequence of elements all of the same type is called a <em>vector</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#create data frame named squares</span></span>
<span><span class="va">squares</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">9</span><span class="op">)</span>, </span>
<span>  perimeter <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">side</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check that our values are contained within squares</span></span>
<span><span class="va">squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
   side perimeter
  &lt;dbl&gt;     &lt;dbl&gt;
1     0         0
2     2         8
3     5        20
4     9        36</code></pre>
</div>
</div>
<p>Now we know how <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> works, we can start to build our plot. First we specify our data (we want to use the <em>squares</em> data frame), and then our aesthetics. Since the perimeter varies as a function of side, we want side on the <span class="math inline">\(x\)</span>-axis, and perimeter on the <span class="math inline">\(y\)</span>-axis. We want to create a scatterplot, so we need to specify our <code>geom_...</code> argument as <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>. Lastly, we will provide clearer axis labels, and include the units of measurement.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">squares</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">side</span>, y <span class="op">=</span> <span class="va">perimeter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Side (m)'</span>, y <span class="op">=</span> <span class="st">'Perimeter (m)'</span>,  title <span class="op">=</span> <span class="st">'Perimeter = 4*Side'</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-squares1" class="quarto-float quarto-figure quarto-figure-center anchored" width="80%" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-squares1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-squares1-1.png" id="fig-squares1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-squares1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption></figure>
</div>
</div>
</div>
<p>We could also visualise the functional relationship by connecting the individual points with a line. To do so, we need to add a new argument - <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>. If you would like to change the colour of the line from the default, you can specify <code>geom_line(colour = "insert colour name")</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">squares</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">side</span>, y <span class="op">=</span> <span class="va">perimeter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Side (m)'</span>, y <span class="op">=</span> <span class="st">'Perimeter (m)'</span>,  title <span class="op">=</span> <span class="st">'Perimeter = 4*Side'</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-14" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-14', 'opt-start-14')"> <span class="olab">Deterministic Models - Predicted Values</span></span>
</div>
<div id="opt-body-14" class="optional-body" style="display: none;">
<p>Sometimes we can directly read a predicted value from the graph of the functional relationship.</p>
<p>Consider the plot created above. For example, first we need to check where x = 2.5. Then, we draw a vertical dashed line until it meets the blue line. The y value corresponding to x = 2.5 can be read off the y-axis. In our case, we would say a side of 2.5m corresponds to a perimeter of 10m.</p>
<p>However, in this case it is not that easy to read it from the drawing… This leads us to the algebraic approach:</p>
<p>We can substitute the x value in the formula and calculate the corresponding y value where we would conclude that the predicted perimeter of squared paintings having a 2.5m side is 10m:</p>
<p><span class="math display">\[
y = 4 \cdot x  \\    
\]</span></p>
<p><span class="math display">\[
y = 4 \cdot 2.5 \\  
\]</span></p>
<p><span class="math display">\[
y = 10  \\
\]</span></p>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="statistical-models" class="level1"><h1>Statistical Models</h1>
<p>Statistical models are used to understand the associations among variables.</p>
<div class="optional-begin">
<span id="opt-start-15" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-15', 'opt-start-15')"> <span class="olab">Specifying Hypotheses</span></span>
</div>
<div id="opt-body-15" class="optional-body" style="display: none;">
<p>We need to specify our hypotheses when testing a model as this not only defines what we are testing, but also sets the direction for statistical inference. By specifying a null hypothesis (typically stating no effect or no association) and an alternative hypothesis (indicating the presence of an association), we create a structured approach for determining the statistical significance of model parameters. Without specifying hypotheses, the interpretation of results would lack focus, making it difficult to assess the validity and relevance of the model’s findings.</p>
<p>In regression analysis, hypothesis testing for beta coefficients is used to assess whether (each) predictor variable significantly contributes to the model.</p>
<p>The way we specify hypotheses is similar across simple and multiple regression models.</p>
<p>For each regression coefficient <span class="math inline">\(\beta_j\)</span> (for predictor <span class="math inline">\(X_j\)</span>):</p>
<ul>
<li>Null hypothesis (<span class="math inline">\(H_0\)</span>) = <span class="math inline">\(\beta_j = 0\)</span>: The predictor variable (<span class="math inline">\(X_j\)</span>) is not associated with the DV<br>
</li>
<li>Alternative hypothesis (<span class="math inline">\(H_1\)</span>) = <span class="math inline">\(\beta_j \neq 0\)</span>: The predictor variable (<span class="math inline">\(X_j\)</span>) is associated with the DV</li>
</ul>
<p>Based on the <span class="math inline">\(p\)</span>-value or comparison of the <span class="math inline">\(t\)</span>-statistic with the critical value, you can conclude whether the predictor variable is significant or not (see the simple &amp; multiple regression Models - extracting information &gt; model coefficients flashcard below):</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t_j|\)</span> &gt; critical value or <span class="math inline">\(p\)</span>-value <span class="math inline">\(&lt; \alpha\)</span>
</li>
<li>Fail to reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t_j|\)</span> <span class="math inline">\(\leq\)</span> critical value or <span class="math inline">\(p\)</span>-value <span class="math inline">\(\geq \alpha\)</span>
</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-16" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-16', 'opt-start-16')"> <span class="olab">Simple Linear Regression Models - Description &amp; Specification</span></span>
</div>
<div id="opt-body-16" class="optional-body" style="display: none;">
<p>The association between two variables (e.g., recall accuracy and age) will show deviations from the ‘average pattern’. Hence, we need to create a model that allows for deviations from the linear relationship - we need a <em>statistical model</em>.</p>
<p>A statistical model includes <em>both</em> a deterministic function and a random error term. We typically refer to the outcome (‘dependent’) variable with the letter <span class="math inline">\(y\)</span> and to our predictor (‘explanatory’/‘independent’) variables with the letter <span class="math inline">\(x\)</span>. A simple (i.e., one x variable only) linear regression model thus takes the following form (where the terms <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are numbers specifying where the line going through the data meets the y-axis (i.e., the intercept - where <span class="math inline">\(x\)</span> = 0; <span class="math inline">\(\beta_0\)</span>) and its slope (direction and gradient of line; <span class="math inline">\(\beta_1\)</span>):</p>
<p><strong>Model Specification</strong></p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 \cdot x_i + \epsilon_i    
\]</span></p>
<p><strong>Model Specification: Annotated</strong></p>
<p><span class="math display">\[
y_i = \underbrace{\beta_0 + \beta_1 \cdot x_i}_{\text{function of }x} + \underbrace{\epsilon_i}_{\text{random error}}  
\\
\]</span></p>
<p><span class="math display">\[
\quad \text{where} \quad \epsilon_i \sim N(0, \sigma) \text{ independently}
\]</span></p>
<p><strong>Model Specification: Explained</strong></p>
<p>Let’s break down what <span class="math inline">\(y_i = \beta_0 + \beta_1 \cdot x_i + \epsilon_i \quad \text{where} \quad \epsilon_i \sim N(0, \sigma) \text{ independently}\)</span> actually means by considering the statement in smaller parts:</p>
<ul>
<li>
<p><em><span class="math inline">\(y_i = \beta_0 + \beta_1 \cdot x_i\)</span></em></p>
<ul>
<li>
<span class="math inline">\(y_i\)</span> is our measured outcome variable (our DV)<br>
</li>
<li>
<span class="math inline">\(x_i\)</span> is our measured predictor variable (our IV)<br>
</li>
<li>
<span class="math inline">\(\beta_0\)</span> is the model intercept<br>
</li>
<li>
<span class="math inline">\(\beta_1\)</span> is the model slope</li>
</ul>
</li>
<li>
<p><em><span class="math inline">\(\epsilon \sim N(0, \sigma) \text{ independently}\)</span></em></p>
<ul>
<li>
<span class="math inline">\(\epsilon\)</span> is the residual error<br>
</li>
<li>
<span class="math inline">\(\sim\)</span> means ‘distributed according to’<br>
</li>
<li>
<span class="math inline">\(N(0, \sigma) \text{ independently}\)</span> means ‘normal distribution with a mean of 0 and a variance of <span class="math inline">\(\sigma\)</span>’<br>
</li>
<li>Together, we can say that the errors around the line have a mean of zero and constant spread as x varies</li>
</ul>
</li>
</ul>
<div class="blue">
<p><strong>In R</strong></p>
<p>There are basically two pieces of information that we need to pass to the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function:</p>
<ol type="1">
<li>The formula: The regression formula should be specified in the form <code>y ~ x</code> where <span class="math inline">\(y\)</span> is the dependent variable (DV) and <span class="math inline">\(x\)</span> the independent variable (IV).</li>
<li>The data: Specify which dataframe contains the variables specified in the formula.</li>
</ol>
<p>In <code>R</code>, the syntax of the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function can be specified as follows (where DV = dependent variable, IV = independent variable, and dataframe_name = the name of your dataset):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Option A</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Option B</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">data_name</span><span class="op">$</span><span class="va">DV</span> <span class="op">~</span> <span class="va">data_name</span><span class="op">$</span><span class="va">IV</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>you can also specify as:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Option A</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Option B</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">IV</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">data_name</span><span class="op">$</span><span class="va">DV</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">data_name</span><span class="op">$</span><span class="va">IV</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why is there a 1 in the two bottom options?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When we specify the linear model in <code>R</code>, we include after the tilde sign (<span class="math inline">\(\sim\)</span>), the variables that appear to the right of the <span class="math inline">\(\hat \beta\)</span>s. The intercept, or <span class="math inline">\(\beta_0\)</span>, is a constant. That is, we could write it as multiplied by 1.</p>
<p>Including the 1 explicitly is not necessary because it is included by default (you can check this by comparing the outputs of A &amp; B above with and without the 1 included - the estimates are the same!). After a while, you will find you just want to drop the 1 when calling <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> because you know that it’s going to be there, but in these early weeks we tried to keep it explicit to make it clear that you want the intercept to be estimated.</p>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<section id="numeric-outcomes-predictors" class="level2"><h2 class="anchored" data-anchor-id="numeric-outcomes-predictors">Numeric Outcomes &amp; Predictors</h2>
<div class="optional-begin">
<span id="opt-start-17" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-17', 'opt-start-17')"> <span class="olab">Simple Linear Regression Models - Example</span></span>
</div>
<div id="opt-body-17" class="optional-body" style="display: none;">
<p>Imagine that you were tasked to investigate whether there was an association between recall accuracy and age. You have been provided with data from twenty participants who studied passages of text (c500 words long), and were tested a week later. The testing phase presented participants with 100 statements about the text. They had to answer whether each statement was true or false, as well as rate their confidence in each answer (on a sliding scale from 0 to 100). The dataset contains, for each participant, the percentage of items correctly answered, their age (in years), and their average confidence rating.</p>
<p>The data are available at <a href="https://uoepsy.github.io/data/recalldata.csv">https://uoepsy.github.io/data/recalldata.csv</a></p>
<p>We could specify our model as:</p>
<p><span class="math display">\[
\text{Recall Accuracy}_i = \beta_0 + \beta_1 \cdot \text{Age}_i + \epsilon_i    
\]</span></p>
<p>and fit our model in <code>R</code> as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify model</span></span>
<span><span class="va">recall_simp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recall_accuracy</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">recalldata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#look at model coefficients</span></span>
<span><span class="va">recall_simp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = recall_accuracy ~ age, data = recalldata)

Coefficients:
(Intercept)          age  
    84.0153      -0.3026  </code></pre>
</div>
</div>
<p>When we call the name of the fitted model, <code>recall_simp</code>, you can see the estimated regression coefficients <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span>. The line of best-fit is thus given by:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
\widehat{Recall~Accuracy} = 84.02 - 0.31 \cdot \text{Age}
\]</span></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-18" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-18', 'opt-start-18')"> <span class="olab">Multiple Linear Regression Models - Description &amp; Specification</span></span>
</div>
<div id="opt-body-18" class="optional-body" style="display: none;">
<p>Multiple linear regression involves looking at one continuous outcome (i.e., DV), with two or more independent variables (i.e., IVs).</p>
<p>A multiple linear regression model takes the following form:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \epsilon_i
\]</span> <span class="math display">\[
\quad \text{where} \quad \epsilon_i \sim N(0, \sigma) \text{ independently}
\]</span> So, for example, we could extend our recall accuracy model to include recall confidence as a predictor:</p>
<p><span class="math display">\[
\text{Recall Accuracy}_i = \beta_0 + \beta_1 \cdot \text{Recall Confidence}_i + \beta_2 \cdot \text{Age}_i + \epsilon_i    
\]</span></p>
<div class="blue">
<p>In <strong>R</strong>:</p>
<p>Multiple and simple linear regression follow the same structure within the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function - the logic scales up to however many predictor variables we want to include in our model. You simply add (using the <code>+</code> sign) more independent variables. For example, if we wanted to build a multiple linear regression that included three independent variables, we could fit one of the following via the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Option A</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Option B</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV1</span> <span class="op">+</span> <span class="va">IV2</span> <span class="op">+</span> <span class="va">IV3</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">data_name</span><span class="op">$</span><span class="va">DV</span> <span class="op">~</span> <span class="va">data_name</span><span class="op">$</span><span class="va">IV1</span> <span class="op">+</span> <span class="va">data_name</span><span class="op">$</span><span class="va">IV2</span> <span class="op">+</span> <span class="va">data_name</span><span class="op">$</span><span class="va">IV3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<p><strong>Interpretation of Multiple Regression Coefficients</strong></p>
<p>You’ll hear a lot of different ways that people explain multiple regression coefficients.</p>
<p>For the model <span class="math inline">\(y = \beta_0 + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \epsilon\)</span>, the estimate <span class="math inline">\(\hat \beta_1\)</span> will often be reported as:</p>
<p>“the increase in <span class="math inline">\(y\)</span> for a one unit increase in <span class="math inline">\(x_1\)</span> when…”</p>
<ul>
<li>“holding the effect of <span class="math inline">\(x_2\)</span> constant.”</li>
<li>“controlling for differences in <span class="math inline">\(x_2\)</span>.”</li>
<li>“partialling out the effects of <span class="math inline">\(x_2\)</span>.”</li>
<li>“holding <span class="math inline">\(x_2\)</span> equal.”</li>
<li>“accounting for effects of <span class="math inline">\(x_2\)</span>.”</li>
</ul>
<p>For models with 3+ predictors, just like building the model in <code>R</code>, the logic of the above simply extends.</p>
<p>For example “the increase in [outcome] for a one unit increase in [predictor] when…”</p>
<ul>
<li>“holding [other predictors] constant.”<br>
</li>
<li>“accounting for [other predictors].”<br>
</li>
<li>“controlling for differences in [other predictors].”<br>
</li>
<li>“partialling out the effects of [other predictors].”<br>
</li>
<li>“holding [other predictors] equal.”<br>
</li>
<li>“accounting for effects of [other predictors].”</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-19" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-19', 'opt-start-19')"> <span class="olab">Simple Linear Regression Models - Visualisation</span></span>
</div>
<div id="opt-body-19" class="optional-body" style="display: none;">
<p>As we saw above, the line representing the relationship between side and perimeter of squares is able to predict the actual perimeter value from the measurement of the side of a square.</p>
<p>This is possible because the association between side and perimeter is an <strong>exact</strong> one. That is, any squares having the same side will have the same perimeter, and there will be no variation in those values.</p>
<p>The line that best fits the association between recall accuracy and age (see <a href="#fig-recallage-fitted-model" class="quarto-xref">Figure&nbsp;2</a>), instead, is only able to predict the <strong>average</strong> accuracy for a given value of age.</p>
<p>This is because there will be a distribution of recall accuracy at each value of age. The line will fit the trend/pattern in the values, but there will be individual-to-individual variability that we must accept around that average pattern.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recalldata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">recall_accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age (in years)"</span>, y <span class="op">=</span> <span class="st">"Recall Accuracy (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recallage-fitted-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-recallage-fitted-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-recallage-fitted-model-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-recallage-fitted-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Association between Recall Accuracy and Age
</figcaption></figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-20" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-20', 'opt-start-20')"> <span class="olab">Multiple Linear Regression Models - Visualisation</span></span>
</div>
<div id="opt-body-20" class="optional-body" style="display: none;">
<p>When we have 2+ predictors, we can’t just plot our data an add <code>geom_smooth(method=lm)</code>, because that would give a visualisation of a linear model with just one predictor (whichever one is on the x-axis).</p>
<p>Instead, we can use the function <code><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model()</a></code> from <strong>sjPlot</strong>. Here’s an example with our recall accuracy model, with two predictors (recall confidence and age):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_model</span><span class="op">(</span><span class="va">recall_mdl</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"eff"</span>,</span>
<span>           terms <span class="op">=</span> <span class="st">"recall_confidence"</span>,</span>
<span>           show.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_model</span><span class="op">(</span><span class="va">recall_mdl</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"eff"</span>,</span>
<span>           terms <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>           show.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalmod-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-recalmod-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-recalmod-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-recalmod-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Association between Recall Accuracy, Recall Confidence and Age
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-recalmod-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-recalmod-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-recalmod-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-recalmod-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Association between Recall Accuracy, Recall Confidence and Age
</figcaption></figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section><section id="numeric-outcomes-categorical-predictors" class="level2"><h2 class="anchored" data-anchor-id="numeric-outcomes-categorical-predictors">Numeric Outcomes &amp; Categorical Predictors</h2>
<div class="optional-begin">
<span id="opt-start-21" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-21', 'opt-start-21')"> <span class="olab">Overview</span></span>
</div>
<div id="opt-body-21" class="optional-body" style="display: none;">
<p>We can include categorical predictors in a linear regression, but the interpretation of the coefficients is very specific. Whereas we talked about coefficients being interpreted as “the change in <span class="math inline">\(y\)</span> associated with a 1-unit increase in <span class="math inline">\(x\)</span>”, for categorical explanatory variables, coefficients can be considered to examine differences in group means.</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-22" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-22', 'opt-start-22')"> <span class="olab">Coding Variables as Factors</span></span>
</div>
<div id="opt-body-22" class="optional-body" style="display: none;">
<p>When we have categorical predictors, it is important that we tell <code>R</code> specifically to code them appropriately as <em>factors</em>.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<p>We can use various functions to convert between different types of data, such as:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> / <code><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor()</a></code> - to turn a variable into a factor<br>
</li>
<li>
<code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> - to turn a variable into numbers</li>
</ul>
</div>
<p>As a first step, it is a good idea to look at the structure of the dataset you are working with. For the purpose of this example, our dataset is called “tips” (you might recall this from DAPR1):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tips</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [157 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Bill  : num [1:157] 23.7 36.1 32 17.4 15.4 ...
 $ Tip   : num [1:157] 10 7 5.01 3.61 3 2.5 3.44 2.42 3 2 ...
 $ Credit: chr [1:157] "n" "n" "y" "y" ...
 $ Guests: num [1:157] 2 3 2 2 2 2 2 2 2 2 ...
 $ Day   : chr [1:157] "f" "f" "f" "f" ...
 $ Server: chr [1:157] "A" "B" "A" "B" ...
 $ PctTip: num [1:157] 42.2 19.4 15.7 20.8 19.5 13.4 16 12.4 12.7 10.7 ...
 - attr(*, "spec")=
  .. cols(
  ..   Bill = col_double(),
  ..   Tip = col_double(),
  ..   Credit = col_character(),
  ..   Guests = col_double(),
  ..   Day = col_character(),
  ..   Server = col_character(),
  ..   PctTip = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>From the output, we can see that <code>Credit</code> (whether guests paid with a credit card; n/y responses) was coded as a <code>&lt;chr&gt;</code> or character variable. If we wanted to set this as a factor so that <code>R</code> recognises it as a categorical variable, we can use on of the following:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><code>as_factor()</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><code>factor()</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tips</span> <span class="op">&lt;-</span> <span class="va">tips</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Credit <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">Credit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>We could also use the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function, and at the same time label factors appropriately to aid reader interpretation (it may not be immediately clear to some that <em>n</em> represents ‘No’ and <em>y</em> represents ‘Yes’). To do so, we list the all levels of <code>Credit</code>, and provide a new label corresponding to each level:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tips</span><span class="op">$</span><span class="va">Credit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">tips</span><span class="op">$</span><span class="va">Credit</span>, </span>
<span>                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Using either of the above approaches, if we now run <code>str(tips)</code> again, you should see that <code>Credit</code> is now coded as a factor with 2 levels:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tips</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [157 × 7] (S3: tbl_df/tbl/data.frame)
 $ Bill  : num [1:157] 23.7 36.1 32 17.4 15.4 ...
 $ Tip   : num [1:157] 10 7 5.01 3.61 3 2.5 3.44 2.42 3 2 ...
 $ Credit: Factor w/ 2 levels "n","y": 1 1 2 2 1 1 1 1 1 1 ...
 $ Guests: num [1:157] 2 3 2 2 2 2 2 2 2 2 ...
 $ Day   : chr [1:157] "f" "f" "f" "f" ...
 $ Server: chr [1:157] "A" "B" "A" "B" ...
 $ PctTip: num [1:157] 42.2 19.4 15.7 20.8 19.5 13.4 16 12.4 12.7 10.7 ...</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-23" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-23', 'opt-start-23')"> <span class="olab">Binary Predictors</span></span>
</div>
<div id="opt-body-23" class="optional-body" style="display: none;">
<p>Binary variables have two categories (more commonly referred to as levels), and these levels (e.g., Yes/No, Dog/Cat, Right/Left, Smoker/Non-Smoker) are simply entered in the model as a series of 0s and 1s. Numeric variables that represent categorical data are typically referred to as <strong>dummy variables</strong>.</p>
<p>Our coefficients are just the same as before. The intercept is where our predictor equals zero, and the slope is the change in our outcome variable associated with a 1-unit change in our predictor.</p>
<p>However, “zero” for this predictor variable now corresponds to a whole level. This is known as the “reference level”. Accordingly, the 1-unit change in our predictor (the move from “zero” to “one”) corresponds to the difference between the two levels.</p>
<p>When used as predictors in multiple regression models, binary variables behave much the same way. The coefficient will give us the estimated change in <span class="math inline">\(y\)</span> when moving from one level to the other, whilst holding other predictors constant (for more info, see the <strong>Multiple Linear Regression Models - Description &amp; Specification</strong> flashcard, specifically the section on interpretation of multiple regression coefficients).</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-24" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-24', 'opt-start-24')"> <span class="olab">Categorical Predictors with k levels</span></span>
</div>
<div id="opt-body-24" class="optional-body" style="display: none;">
<p>When we have a <em>categorical</em> explanatory variable with <strong>more than 2 levels</strong>, our model gets a bit more complex - it needs not just one, but <em>a number of</em> dummy variables. For a categorical variable with <span class="math inline">\(k\)</span> levels, we can express it in <span class="math inline">\(k-1\)</span> dummy variables.</p>
<p>For example, the “species” column below has three levels, and can be expressed by the two variables “species_dog” and “species_parrot”:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>  species species_dog species_parrot
1     cat           0              0
2     cat           0              0
3     dog           1              0
4  parrot           0              1
5     dog           1              0
6     cat           0              0
7     ...         ...            ...</code></pre>
</div>
</div>
<ul>
<li>The “cat” level is expressed whenever both the “species_dog” and “species_parrot” variables are 0.</li>
<li>The “dog” level is expressed whenever the “species_dog” variable is 1 and the “species_parrot” variable is 0.</li>
<li>The “parrot” level is expressed whenever the “species_dog” variable is 0 and the “species_parrot” variable is 1.</li>
</ul>
<p><code>R</code> will do all of this re-expression for us. If we include in our model a categorical explanatory variable with 3 different levels, the model will estimate 2 parameters - one for each dummy variable. We can interpret the parameter estimates (the coefficients we obtain using <code><a href="https://rdrr.io/r/stats/coef.html">coefficients()</a></code>,<code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> or <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>) as the estimated increase in the outcome variable associated with an increase of one in each dummy variable (holding all other variables equal).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Std. Error</th>
<th style="text-align: center;">t value</th>
<th style="text-align: center;">Pr(&gt;|t|)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">60.28</td>
<td style="text-align: center;">1.209</td>
<td style="text-align: center;">49.86</td>
<td style="text-align: center;">5.273e-39</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>speciesdog</strong></td>
<td style="text-align: center;">-11.47</td>
<td style="text-align: center;">1.71</td>
<td style="text-align: center;">-6.708</td>
<td style="text-align: center;">3.806e-08</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>speciesparrot</strong></td>
<td style="text-align: center;">-4.916</td>
<td style="text-align: center;">1.71</td>
<td style="text-align: center;">-2.875</td>
<td style="text-align: center;">0.006319</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Recall that the intercept is the estimated outcome when all predictors are zero. In our example then, this represents the cat. We think of the “cat” category in this example as the <em>reference level</em> - it is the category against which other categories are compared against. Therefore, in the above example, an increase in 1 of “species_dog” is the difference between a “cat” and a “dog”. An increase in one of “species_parrot” is the difference between a “cat” and a “parrot”.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-25" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-25', 'opt-start-25')"> <span class="olab">Dummy vs Effects Coding</span></span>
</div>
<div id="opt-body-25" class="optional-body" style="display: none;">
<p>Possible side-constraints on the parameters are:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 30%">
<col style="width: 38%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Name</th>
<th style="text-align: center;">Constraint</th>
<th style="text-align: center;">Meaning of <span class="math inline">\(\beta_0\)</span>
</th>
<th style="text-align: center;">R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Sum to zero (Effects Coding)</td>
<td style="text-align: center;"><span class="math inline">\(\beta_1 + \beta_2 + \beta_3 = 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 = \mu\)</span></td>
<td style="text-align: center;"><code>contr.sum</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">Reference group (Dummy Coding)</td>
<td style="text-align: center;"><span class="math inline">\(\beta_1 = 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 = \mu_1\)</span></td>
<td style="text-align: center;"><code>contr.treatment</code></td>
</tr>
</tbody>
</table>
<p><strong>Dummy Coding</strong></p>
<p>By default <code>R</code> uses the reference group constraint - i.e., dummy coding (sometimes called treatment contrast coding). If your factor has <span class="math inline">\(g\)</span> levels, your regression model will have <span class="math inline">\(g-1\)</span> dummy variables (<code>R</code> creates them for you, as we’ve seen in the examples above).</p>
<p>When we use this approach, the intercept is the estimated <span class="math inline">\(y\)</span> when all predictors (i.e., <span class="math inline">\(x\)</span>’s) are zero. Because the reference level is kind of like “0” in our contrast matrix, this is part of the intercept estimate. We get out a coefficient for each subsequent level, which are the estimated differences from each level to the reference group.</p>
<p><strong>Effects Coding</strong></p>
<p>Effects coding (sometimes called sum-to-zero coding) is the next most commonly used in psychological research. These are a way of comparing each level to the overall (or grand) mean. This involves a bit of trickery that uses -1s and 1s rather than 0s and 1s, in order to make “0” be mid-way between all the levels - the average of the levels.</p>
<p>When we use this approach, the intercept is the estimated average <span class="math inline">\(y\)</span> when averaged across all levels of the predictor variable. In other words, it is the estimated grand mean of <span class="math inline">\(y\)</span>. The coefficients represent the estimated difference for that level from the overall grand mean.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<p>If we want to use effects coding, we can apply:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"contr.sum"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can switch back to the default reference group constraint by applying either of these:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Option 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Option 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"contr.treatment"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-26" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-26', 'opt-start-26')"> <span class="olab">Categorical Predictors - Interpretation</span></span>
</div>
<div id="opt-body-26" class="optional-body" style="display: none;">
<p>Let’s apply this to a different example - the iris dataset, and specifically, the Species categorical variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#check what levels we have</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "setosa"     "versicolor" "virginica" </code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Dummy Coding</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Effects Coding</a></li>
</ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>From the above, we can see that Species has 3 levels - “setosa”, “versicolor”, and “virginica”. If we put these into a model, assuming <code>R</code>’s default ordering, we know that <code>R</code> will automatically apply dummy (or treatment coding), and “setosa” will be taken as our reference group:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#fit model</span></span>
<span><span class="va">spec_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">spec_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species, data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         5.0060     0.0728  68.762  &lt; 2e-16 ***
Speciesversicolor   0.9300     0.1030   9.033 8.77e-16 ***
Speciesvirginica    1.5820     0.1030  15.366  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Let’s first map our coefficients and estimates:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Corresponds to</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">(Intercept)</td>
<td style="text-align: center;">5.0060</td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 = \hat \mu_1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Speciesversicolor</td>
<td style="text-align: center;">0.9300</td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 + \beta_1 = \hat \mu_2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Speciesvirginica</td>
<td style="text-align: center;">1.5820</td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 + \beta_2 = \hat \mu_3\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The estimate corresponding to (Intercept) contains <span class="math inline">\(\hat \beta_0 = \hat \mu_1 = 5.01\)</span>. The estimated average sepal length for the species setosa was approximately 5.01.</p></li>
<li><p>The second estimate corresponds to <code>Speciesversicolor</code> and was <span class="math inline">\(\hat \beta_1 = 0.93\)</span>. The difference in mean sepal length between <code>setosa</code> and <code>versicolor</code> species was estimated to be <span class="math inline">\(0.93~cm\)</span>. Thus, <span class="math inline">\(\hat \mu_2 = 5.01 + 0.93 = 5.94\)</span>. We could say - the species iris versicolor had a sepal length of approximately 5.94cm, and this was approximately 0.93cm longer than the iris setosa. This difference was statistically significant <span class="math inline">\((p &lt; .001)\)</span>.</p></li>
<li><p>The third estimate corresponds to <code>Speciesvirginica</code> and was <span class="math inline">\(\hat \beta_2 = 1.58\)</span>. The difference in mean sepal length between <code>setosa</code> and <code>virginica</code> species was estimated to be <span class="math inline">\(1.58~cm\)</span>. Thus, <span class="math inline">\(\hat \mu_2 = 5.01 + 1.58 = 6.59\)</span>. We could say - the species iris virginica had a sepal length of approximately 6.59cm, and this was approximately 1.58cm longer than the iris setosa. This difference was statistically significant <span class="math inline">\((p &lt; .001)\)</span>.</p></li>
</ul>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>First we need to tell <code>R</code> to apply effects (or sum-to-zero) coding and check the ordering of the levels:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1] [,2]
setosa        1    0
versicolor    0    1
virginica    -1   -1</code></pre>
</div>
</div>
<p>Then we can run our model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#fit model</span></span>
<span><span class="va">spec_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">spec_model2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species, data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.84333    0.04203 139.020   &lt;2e-16 ***
Species1    -0.83733    0.05944 -14.086   &lt;2e-16 ***
Species2     0.09267    0.05944   1.559    0.121    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>           versicolor virginica
setosa              0         0
versicolor          1         0
virginica           0         1</code></pre>
</div>
</div>
<p>Let’s first map our coefficients and estimates:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Corresponds to</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">(Intercept)</td>
<td style="text-align: center;">5.84333</td>
<td style="text-align: center;"><span class="math inline">\(\beta_0 = \frac{\mu_1 + \mu_2 + \mu_3}{3} = \mu\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Species1</td>
<td style="text-align: center;">-0.83733</td>
<td style="text-align: center;"><span class="math inline">\(\beta_1 = \mu_1 - \mu\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Species2</td>
<td style="text-align: center;">0.09267</td>
<td style="text-align: center;"><span class="math inline">\(\beta_2 = \mu_2 - \mu\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The first estimate corresponding to (Intercept) contains <span class="math inline">\(\hat \beta_0 = \hat \mu = 5.84\)</span>. The estimated average sepal length across iris species was approximately <span class="math inline">\(5.84~cm\)</span>.</p></li>
<li><p>The second estimate corresponds to <code>Species1</code> and was <span class="math inline">\(\hat \beta_1 = -0.84\)</span>. The difference in mean sepal length between <code>setosa</code> <span class="math inline">\((\hat \mu_1)\)</span> and the grand mean <span class="math inline">\((\hat \mu_0)\)</span> was estimated to be <span class="math inline">\(0.84~cm\)</span>. In other words, the iris species of setosa had a sepal length <span class="math inline">\(0.84~cm\)</span> shorter than average, where its length was estimated to be <span class="math inline">\(5.84333 + (-0.83733) = 5~cm\)</span>. This difference in length was statistically significant <span class="math inline">\((p &lt; .001)\)</span>.</p></li>
<li><p>The third estimate corresponds to <code>Species2</code> and was <span class="math inline">\(\hat \beta_2 = 0.09\)</span>. The difference in mean sepal length between <code>versicolor</code> <span class="math inline">\((\hat \mu_2)\)</span> and the grand mean <span class="math inline">\((\hat \mu_0)\)</span> was estimated to be <span class="math inline">\(0.09~cm\)</span>. In other words, the iris species of versicolor had a sepal length <span class="math inline">\(0.09~cm\)</span> longer than average, where its length was estimated to be <span class="math inline">\(5.84333 + 0.09267 = 5.94~cm\)</span>. This difference in length was not statistically significant <span class="math inline">\((p = .121)\)</span>.</p></li>
<li><p>The estimate for <code>Species3</code>, representing the difference of “virginica” to the grand mean is <em>not shown</em> by <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. Because of the side-constraint, we know that <span class="math inline">\(\mu_3 = \beta_0 - (\beta_1 + \beta_2)\)</span>. The difference in sepal length between <code>virginica</code> and the grand mean was estimated to be <span class="math inline">\(-(-0.83733 + 0.09267) = 0.74466\)</span>. In other words, the virginica iris species had a sepal length <span class="math inline">\(0.74~cm\)</span> longer than average, where its length was estimated to be <span class="math inline">\(5.84333 - (-0.83733  + 0.09267) = 6.59~cm\)</span>.</p></li>
</ul>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-27" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-27', 'opt-start-27')"> <span class="olab">Specifying Reference Levels</span></span>
</div>
<div id="opt-body-27" class="optional-body" style="display: none;">
<p>When you have a categorical variable coded as a factor, <code>R</code> will default to using alphabetical ordering - hence in our example above “cat” was the reference level (as opposed to “dog” or “parrot”), and in the other “setosa” was the reference level (as opposed to “versicolor” or “virginica”).</p>
<p>We could override this by making it a factor with an ordering to it’s levels (see the use of <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> and <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code>). Functions like <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> might be handy too.</p>
<p>For example, let’s say we wanted to change the reference level in our “spec_model” above, there are a few different ways that we can do this.</p>
<p>First we should check the current ordering of the levels:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "setosa"     "versicolor" "virginica" </code></pre>
</div>
</div>
<p>We can then change the reference level to be versicolor (using one of the below methods):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><code>fct_relevel()</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><code>relevel()</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false"><code>factor()</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    Species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">Species</span>, <span class="st">"versicolor"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="st">"versicolor"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">.</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"versicolor"</span>, <span class="st">"setosa"</span>, <span class="st">"virginica"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>And then re-run our model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#fit model</span></span>
<span><span class="va">spec_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">spec_model2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species, data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        5.9360     0.0728  81.536  &lt; 2e-16 ***
Speciessetosa     -0.9300     0.1030  -9.033 8.77e-16 ***
Speciesvirginica   0.6520     0.1030   6.333 2.77e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section><section id="interaction-models" class="level2"><h2 class="anchored" data-anchor-id="interaction-models">Interaction Models</h2>
<div class="optional-begin">
<span id="opt-start-28" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-28', 'opt-start-28')"> <span class="olab">Specifying Interaction Models</span></span>
</div>
<div id="opt-body-28" class="optional-body" style="display: none;">
<p>Interaction models allow us to model the idea of “the association between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> differs depending on the level of <span class="math inline">\(x_2\)</span>” by including a product (multiplication) term between the two predictors.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 (x_1 \cdot x_2) + \epsilon
\]</span></p>
<p>If we fit the interaction <code>x1:x2</code>, we almost always want to also fit the separate effects <code>x1</code> and <code>x2</code>:</p>
<div class="quote">
<p>“Except in special circumstances, a model including a product term for interaction between two explanatory variables should also include terms with each of the explanatory variables individually, even though their coefficients may not be significantly different from zero. Following this rule avoids the logical inconsistency of saying that the effect of <span class="math inline">\(X_1\)</span> depends on the level of <span class="math inline">\(X_2\)</span> but that there is no effect of <span class="math inline">\(X_1\)</span>.”<br>
— <span class="citation" data-cites="Ramsey2012">Ramsey and Schafer (<a href="#ref-Ramsey2012" role="doc-biblioref">2012</a>)</span></p>
</div>
<div class="blue">
<p>In <strong>R</strong>:</p>
<p>There are basically two pieces of information that we need to pass to the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function:</p>
<ol type="1">
<li><p>The formula: The regression formula should be specified in the form <code>y ~ x</code> where <span class="math inline">\(y\)</span> is the dependent variable (DV), <span class="math inline">\(x_1\)</span> the first independent variable (IV1), and <span class="math inline">\(x_2\)</span> the second independent variable (IV2). We then also need to include the interaction term between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>.</p></li>
<li><p>The data: Specify which dataframe (<code>data =</code>) contains the variables specified in the formula.</p></li>
</ol>
<ul>
<li>run interaction model via <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV1</span><span class="op">*</span><span class="va">IV2</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>OR</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV1</span> <span class="op">+</span> <span class="va">IV2</span> <span class="op">+</span> <span class="va">IV1</span><span class="op">:</span><span class="va">IV2</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-29" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-29', 'opt-start-29')"> <span class="olab">Interpreting Coefficients</span></span>
</div>
<div id="opt-body-29" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Interpreting coefficients for A and B in the presence of an interaction A:B</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Interpreting the interaction term A:B</a></li>
</ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>When you include an interaction between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> in a regression model, you are estimating the extent to which the effect of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> is different across the values of <span class="math inline">\(x_2\)</span>.</p>
<p>What this means is that the effect of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> <em>depends on/is conditional upon</em> the value of <span class="math inline">\(x_2\)</span> (and vice versa, the effect of <span class="math inline">\(x_2\)</span> on <span class="math inline">\(y\)</span> is different across the values of <span class="math inline">\(x_1\)</span>).</p>
<p>This means that we can no longer talk about the “effect of <span class="math inline">\(x_1\)</span> <em>holding <span class="math inline">\(x_2\)</span> constant</em>”. Instead we can talk about a <em>marginal effect</em> of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> at a specific value of <span class="math inline">\(x_2\)</span>.</p>
<div class="frame">
<p>When we fit the model <span class="math inline">\(y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 (x_1 \cdot x_2) + \epsilon\)</span> using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<ul>
<li>the parameter estimate <span class="math inline">\(\hat \beta_1\)</span> is the <em>marginal effect</em> of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> where <span class="math inline">\(x_2 = 0\)</span><br>
</li>
<li>the parameter estimate <span class="math inline">\(\hat \beta_2\)</span> is the <em>marginal effect</em> of <span class="math inline">\(x_2\)</span> on <span class="math inline">\(y\)</span> where <span class="math inline">\(x_1 = 0\)</span> In other words, when we fit a model with an interaction in R, we get out coefficients for both predictors, and for the interaction. The coefficients for each individual predictor reflect the effect on the outcome when the other predictor is zero.</li>
</ul>
</div>
<div style="margin-left: 15px">
<p><small> <strong>N.B.</strong> Regardless of whether or not there is an interaction term in our model, all parameter estimates in multiple regression are “conditional” in the sense that they are dependent upon the inclusion of other variables in the model. For instance, in <span class="math inline">\(y = \beta_0 + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \epsilon\)</span> the coefficient <span class="math inline">\(\hat \beta_1\)</span> is conditional upon holding <span class="math inline">\(x_2\)</span> constant. </small></p>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>The coefficient for an interaction term can be thought of as providing an <em>adjustment to the slope.</em></p>
<p>Let’s take the following model as an example:</p>
<pre><code>lm(formula = y ~ x1 * x2, data = df)
...

...
Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  ...        ....       ...      ...  
x1           ...        ....       ...      ...  
x2           ...        ....       ...      ...  
x1:x2        ...        ....       ...      ...  
---</code></pre>
<p>These coefficients can be interpreted, in turn as:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Coefficient</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>(Intercept)</code></td>
<td>the estimated <span class="math inline">\(y\)</span> when all predictors (<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>) are zero is [<em>estimate</em>]</td>
</tr>
<tr class="even">
<td><code>x1</code></td>
<td>
<strong>when <span class="math inline">\(x_2\)</span> is zero,</strong> a 1 unit increase in <span class="math inline">\(x_1\)</span> is associated with a [<em>estimate</em>] change in <span class="math inline">\(y\)</span>
</td>
</tr>
<tr class="odd">
<td><code>x2</code></td>
<td>
<strong>when <span class="math inline">\(x_1\)</span> is zero,</strong> a 1 unit increase in <span class="math inline">\(x_2\)</span> is associated with a [<em>estimate</em>] change in <span class="math inline">\(y\)</span>.</td>
</tr>
<tr class="even">
<td><code>x1:x2</code></td>
<td>as <span class="math inline">\(x_2\)</span> increases by 1, the association between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> changes by [<em>estimate</em>]<br><em><strong>or</strong></em><br>as <span class="math inline">\(x_1\)</span> increases by 1, the association between <span class="math inline">\(x_2\)</span> and <span class="math inline">\(y\)</span> changes by [<em>estimate</em>]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if there are other things (e.g., other predictors/covatiates) in the model too?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the interaction <code>x1:x2</code> changes how we interpret the individual coefficients for <code>x1</code> and <code>x2</code>.</p>
<p>It does <strong><em>not</em></strong> change how we interpret coefficients for other predictors that might be in our model. For variables that <strong>aren’t</strong> involved in the interaction term, these are still held constant.</p>
<p>For example, suppose we <em>also</em> had another predictor <span class="math inline">\(c_1\)</span> in our model:</p>
<pre><code>lm(y ~ c1 + x1 + x2 + x1:x2)</code></pre>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Coefficient</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>(Intercept)</code></td>
<td>the estimated <span class="math inline">\(y\)</span> when all predictors (<span class="math inline">\(c_1\)</span>, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>) are zero is [<em>estimate</em>]</td>
</tr>
<tr class="even">
<td><code>c1</code></td>
<td>a 1 unit increase in <span class="math inline">\(c_1\)</span> is associated with a [<em>estimate</em>] increase in <span class="math inline">\(y\)</span>, holding constant all other variables in the model (<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>)</td>
</tr>
<tr class="odd">
<td><code>x1</code></td>
<td>holding <span class="math inline">\(c_1\)</span> constant, <strong>when <span class="math inline">\(x_2\)</span> is zero,</strong> a 1 unit increase in <span class="math inline">\(x_1\)</span> is associated with a [<em>estimate</em>] change in <span class="math inline">\(y\)</span>
</td>
</tr>
<tr class="even">
<td><code>x2</code></td>
<td>holding <span class="math inline">\(c_1\)</span> constant, <strong>when <span class="math inline">\(x_1\)</span> is zero,</strong> a 1 unit increase in <span class="math inline">\(x_2\)</span> is associated with a [<em>estimate</em>] change in <span class="math inline">\(y\)</span>.</td>
</tr>
<tr class="odd">
<td><code>x1:x2</code></td>
<td>holding <span class="math inline">\(c_1\)</span> constant, as <span class="math inline">\(x_2\)</span> increases by 1, the association between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span> changes by [<em>estimate</em>]<br><em><strong>or</strong></em><br>holding <span class="math inline">\(c_1\)</span> constant, as <span class="math inline">\(x_1\)</span> increases by 1, the association between <span class="math inline">\(x_2\)</span> and <span class="math inline">\(y\)</span> changes by [<em>estimate</em>]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-30" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-30', 'opt-start-30')"> <span class="olab">Example Data</span></span>
</div>
<div id="opt-body-30" class="optional-body" style="display: none;">
<p>For the examples in this section , we are going to use the <em>palmer penguins</em> dataset<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. We can have a concise overview of the dataset using <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> (to see the structure) and <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> (and to view the first 6 rows):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><code>str()</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><code>head()</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
 $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
 $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
 $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
 $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...
 $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7               181        3750
2 Adelie  Torgersen           39.5          17.4               186        3800
3 Adelie  Torgersen           40.3          18                 195        3250
4 Adelie  Torgersen           NA            NA                  NA          NA
5 Adelie  Torgersen           36.7          19.3               193        3450
6 Adelie  Torgersen           39.3          20.6               190        3650
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Each of the three examples has a different research question, but the same process is followed.</p>
</div>
<p class="optional-end">
</p>
<section id="numeric-x-categorical-example" class="level3"><h3 class="anchored" data-anchor-id="numeric-x-categorical-example">Numeric x Categorical Example</h3>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Does the association between body mass and flipper length differ between species of penguin?</p>
</blockquote>
<div class="optional-begin">
<span id="opt-start-31" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-31', 'opt-start-31')"> <span class="olab">Visualise Data</span></span>
</div>
<div id="opt-body-31" class="optional-body" style="display: none;">
<p>Since we have a continuous DV, one continuous IV and one categorical (with 3 levels) IV, one of the most appropriate visualisations would be a scatterplot where we have a separate line of best fit mapped for each level of species:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, y <span class="op">=</span> <span class="va">body_mass_g</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper Length (in mm)"</span>, y <span class="op">=</span> <span class="st">"Body Mass (in g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, we could create the same above scatterplot, and then divide into different facets by species:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, y <span class="op">=</span> <span class="va">body_mass_g</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper Length (in mm)"</span>, y <span class="op">=</span> <span class="st">"Body Mass (in g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-32" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-32', 'opt-start-32')"> <span class="olab">Model Specification</span></span>
</div>
<div id="opt-body-32" class="optional-body" style="display: none;">
<p>Before we specify our model, we must select (and provide justification for this choice) the reference group(s) for our categorical variable(s). In this specific example, there is no natural reference category, nor one that maps to our RQ, so we will go with <code>R</code>’s default coding and have Adelie as our reference group for species. <span class="math display">\[
\begin{align}
\text{Body Mass} ~=~ &amp; \beta_0 + \beta_1 \cdot \text{Flipper Length} + \beta_2 \cdot \text{Species}_\text{Chinstrap} + \beta_3 \cdot \text{Species}_\text{Gentoo} \\
&amp; + \beta_4 \cdot (\text{Flipper Length} \cdot \text{Species}_\text{Chinstrap}) \\
&amp; + \beta_5 \cdot (\text{Flipper Length} \cdot \text{Species}_\text{Gentoo}) + \epsilon \\
\end{align}
\quad
\]</span></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-33" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-33', 'opt-start-33')"> <span class="olab">Model Building</span></span>
</div>
<div id="opt-body-33" class="optional-body" style="display: none;">
<p>No penguins in our dataset had a flipper length of zero mm. We might want to mean centre this predictor variable so that we can consider the difference in body mass between penguin species with average flipper lengths. Before we build our model, we should mean centre this IV:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   mc_flipper_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recall that the default in <code>R</code> is to apply dummy coding, and thus <code>R</code> computes the dummy variables for us! Since we are using the default reference group, we can simply run our model (with our newly created mean centered flipper length variable):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mdl_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">mc_flipper_length_mm</span> <span class="op">*</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each row in the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> output of the model will correspond to one of the estimated <span class="math inline">\(\beta\)</span>’s in the equation above.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mdl_nc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ mc_flipper_length_mm * species, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-911.18 -251.93  -31.77  197.82 1144.81 

Coefficients:
                                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           4060.549     59.010  68.811  &lt; 2e-16 ***
mc_flipper_length_mm                    32.832      4.627   7.095 7.69e-12 ***
speciesChinstrap                      -151.424     80.912  -1.871  0.06215 .  
speciesGentoo                          126.662    108.104   1.172  0.24216    
mc_flipper_length_mm:speciesChinstrap    1.742      7.856   0.222  0.82467    
mc_flipper_length_mm:speciesGentoo      21.791      6.941   3.139  0.00184 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 370.6 on 336 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.7896,    Adjusted R-squared:  0.7864 
F-statistic: 252.2 on 5 and 336 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-34" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-34', 'opt-start-34')"> <span class="olab">Results Interpretation</span></span>
</div>
<div id="opt-body-34" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true"><code>(Intercept)</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><code>mc_flipper_length_mm</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false"><code>speciesChinstrap</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false"><code>speciesGentoo</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-5" role="tab" aria-controls="tabset-16-5" aria-selected="false"><code>mc_flipper_length_mm:speciesChinstrap</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-6" role="tab" aria-controls="tabset-16-6" aria-selected="false"><code>mc_flipper_length_mm:speciesGentoo</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p><span class="math inline">\(\beta_0\)</span> = <code>(Intercept)</code> = 4060.55</p>
<ul>
<li>The intercept, or predicted body mass when flipper length was average and species was Adelie.
<ul>
<li>An Adelie penguin with an average flipper length was expected to have a body mass of <span class="math inline">\(4060.55g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p><span class="math inline">\(\beta_1\)</span> = <code>mc_flipper_length_mm</code> = 32.83</p>
<ul>
<li>The simple slope of flipper length (in mm) for species reference group (Adelie).
<ul>
<li>For an Adelie penguin, every 1 additional mm in flipper length was associated with a significant <span class="math inline">\(32.83g\)</span> increase in their body mass <span class="math inline">\((p &lt; .001)\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<p><span class="math inline">\(\beta_2\)</span> = <code>speciesChinstrap</code> = -151.42</p>
<ul>
<li>The simple effect of species (or the difference in body mass between Adelie and Chinstrap penguins) when flipper length was average.
<ul>
<li>A Chinstrap penguin with an average flipper length had a body mass <span class="math inline">\(151.42g\)</span> lighter than an Adelie penguin with the same flipper length. Note that this difference was not statistically different from zero <span class="math inline">\((p = .062)\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<p><span class="math inline">\(\beta_3\)</span> = <code>speciesGentoo</code> = 126.66</p>
<ul>
<li>The simple effect of species (or the difference in body mass between Adelie and Gentoo penguins) when flipper length was average.
<ul>
<li>A Gentoo penguin with an average flipper length had a body mass <span class="math inline">\(126.66g\)</span> heavier than an Adelie penguin with the same flipper length. Note that this difference was not statistically different from zero <span class="math inline">\((p = .242)\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-16-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-5-tab">
<p><span class="math inline">\(\beta_4\)</span> = <code>mc_flipper_length_mm:speciesChinstrap</code> = 1.74</p>
<ul>
<li>The interaction between flipper length (in mm; mean centered) and species (levels: Adelie/Chinstrap). This is the estimated difference in simple slopes of flipper length for Adelie vs.&nbsp;Chinstrap penguins.
<ul>
<li>In comparison to Adelie penguins, for a Chinstrap penguin every 1 additional mm in flipper length was associated with a <span class="math inline">\(1.74g\)</span> point greater change in their body mass. Note that this adjustment was not statistically different from zero <span class="math inline">\((p = .825)\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-16-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-6-tab">
<p><span class="math inline">\(\beta_5\)</span> = <code>mc_flipper_length_mm:speciesGentoo</code> = 21.79</p>
<ul>
<li>The interaction between flipper length (in mm; mean centered) and species (levels: Adelie/Gentoo). This is the estimated difference in simple slopes of flipper length for Adelie vs.&nbsp;Gentoo penguins.
<ul>
<li>In comparison to Adelie penguins, for a Gentoo penguin every 1 additional mm in flipper length was associated with a <span class="math inline">\(21.79g\)</span> greater increase in their body mass. Note that this adjustment was statistically significant <span class="math inline">\((p = .002)\)</span>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-35" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-35', 'opt-start-35')"> <span class="olab">Model Visualisation</span></span>
</div>
<div id="opt-body-35" class="optional-body" style="display: none;">
<p>We can do this using the <code><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">probe_interaction()</a></code> function from the <strong>interactions</strong> package.</p>
<p>In terms of of specification, it might be useful to look up the helper function (i.e., <code><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">?probe_interaction</a></code>). As a quick guide:</p>
<ul>
<li>
<code>model =</code>: The name model to be used<br>
</li>
<li>
<code>pred =</code>: The continuous predictor variable that will appear on the x-axis<br>
</li>
<li>
<code>modx =</code>: The categorical moderator variable<br>
</li>
<li>
<code>interval =</code>: If we say <code>TRUE</code>, then confidence/prediction intervals will be plotted around the line</li>
</ul>
<p>Remember to give your plot informative titles/labels. You, for example, likely want to give your plot:</p>
<ul>
<li>a clear and concise title (specify <code>main.title =</code>)<br>
</li>
<li>axis labels with units or scale included (specify <code>x.label =</code> and <code>y.label =</code>)<br>
</li>
<li>a legend title (specify <code>legend.main =</code>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://interactions.jacob-long.com">interactions</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt_mdl_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">probe_interaction</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mdl_nc</span>,</span>
<span>                                pred <span class="op">=</span> <span class="va">mc_flipper_length_mm</span>,</span>
<span>                                modx <span class="op">=</span> <span class="va">species</span>,</span>
<span>                                interval <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                main.title <span class="op">=</span> <span class="st">"Predicted Body Mass across Flipper Length by Species"</span>,</span>
<span>                                x.label <span class="op">=</span> <span class="st">"Flipper Length (in mm; Mean Centered)"</span>,</span>
<span>                                y.label <span class="op">=</span> <span class="st">"Body Mass (in g)"</span>,</span>
<span>                                legend.main <span class="op">=</span> <span class="st">"Penguin Species"</span><span class="op">)</span></span>
<span><span class="va">plt_mdl_nc</span><span class="op">$</span><span class="va">interactplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
</section><section id="numeric-x-numeric-example" class="level3"><h3 class="anchored" data-anchor-id="numeric-x-numeric-example">Numeric x Numeric Example</h3>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Does the influence of bill length on body mass vary depending on flipper length?</p>
</blockquote>
<div class="optional-begin">
<span id="opt-start-36" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-36', 'opt-start-36')"> <span class="olab">Visualise Data</span></span>
</div>
<div id="opt-body-36" class="optional-body" style="display: none;">
<p>Using <code><a href="https://rdrr.io/pkg/psych/man/pairs.panels.html">pairs.panels()</a></code> is likely the most useful way to visualise the associations among numeric variables. It returns a scatterplot of matrices (SPLOM) returning you (1) the marginal distribution of each variable via a histogram, (2) the correlation between variables, and (3) bivariate scatterplots.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">body_mass_g</span>, <span class="va">flipper_length_mm</span>, <span class="va">bill_length_mm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/psych/man/pairs.panels.html">pairs.panels</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>If you <em>really</em> wanted to, you could create a 3D plot showing the associations among all three variables at once. We wouldn’t really recommend doing this - they can be very difficult to interpret correctly, and given their interactive nature, definitely NOT something that you’d want to include in a stats report. But, for demonstration purposes only, we could create one using the <strong>plotly</strong> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span><span class="va">penguins</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">flipper_length_mm</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">body_mass_g</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">bill_length_mm</span>, type <span class="op">=</span> <span class="st">'scatter3d'</span>, mode <span class="op">=</span> <span class="st">'markers+lines'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-3178203cca97f77c3c47" style="width:80%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3178203cca97f77c3c47">{"x":{"visdat":{"39e841013576":["function () ","plotlyVisDat"]},"cur_data":"39e841013576","attrs":{"39e841013576":{"x":{},"y":{},"z":{},"mode":"markers+lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"flipper_length_mm"},"yaxis":{"title":"body_mass_g"},"zaxis":{"title":"bill_length_mm"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[181,186,195,null,193,190,181,195,193,190,186,180,182,191,198,185,195,197,184,194,174,180,189,185,180,187,183,187,172,180,178,178,188,184,195,196,190,180,181,184,182,195,186,196,185,190,182,179,190,191,186,188,190,200,187,191,186,193,181,194,185,195,185,192,184,192,195,188,190,198,190,190,196,197,190,195,191,184,187,195,189,196,187,193,191,194,190,189,189,190,202,205,185,186,187,208,190,196,178,192,192,203,183,190,193,184,199,190,181,197,198,191,193,197,191,196,188,199,189,189,187,198,176,202,186,199,191,195,191,210,190,197,193,199,187,190,191,200,185,193,193,187,188,190,192,185,190,184,195,193,187,201,211,230,210,218,215,210,211,219,209,215,214,216,214,213,210,217,210,221,209,222,218,215,213,215,215,215,216,215,210,220,222,209,207,230,220,220,213,219,208,208,208,225,210,216,222,217,210,225,213,215,210,220,210,225,217,220,208,220,208,224,208,221,214,231,219,230,214,229,220,223,216,221,221,217,216,230,209,220,215,223,212,221,212,224,212,228,218,218,212,230,218,228,212,224,214,226,216,222,203,225,219,228,215,228,216,215,210,219,208,209,216,229,213,230,217,230,217,222,214,null,215,222,212,213,192,196,193,188,197,198,178,197,195,198,193,194,185,201,190,201,197,181,190,195,181,191,187,193,195,197,200,200,191,205,187,201,187,203,195,199,195,210,192,205,210,187,196,196,196,201,190,212,187,198,199,201,193,203,187,197,191,203,202,194,206,189,195,207,202,193,210,198],"y":[3750,3800,3250,null,3450,3650,3625,4675,3475,4250,3300,3700,3200,3800,4400,3700,3450,4500,3325,4200,3400,3600,3800,3950,3800,3800,3550,3200,3150,3950,3250,3900,3300,3900,3325,4150,3950,3550,3300,4650,3150,3900,3100,4400,3000,4600,3425,2975,3450,4150,3500,4300,3450,4050,2900,3700,3550,3800,2850,3750,3150,4400,3600,4050,2850,3950,3350,4100,3050,4450,3600,3900,3550,4150,3700,4250,3700,3900,3550,4000,3200,4700,3800,4200,3350,3550,3800,3500,3950,3600,3550,4300,3400,4450,3300,4300,3700,4350,2900,4100,3725,4725,3075,4250,2925,3550,3750,3900,3175,4775,3825,4600,3200,4275,3900,4075,2900,3775,3350,3325,3150,3500,3450,3875,3050,4000,3275,4300,3050,4000,3325,3500,3500,4475,3425,3900,3175,3975,3400,4250,3400,3475,3050,3725,3000,3650,4250,3475,3450,3750,3700,4000,4500,5700,4450,5700,5400,4550,4800,5200,4400,5150,4650,5550,4650,5850,4200,5850,4150,6300,4800,5350,5700,5000,4400,5050,5000,5100,4100,5650,4600,5550,5250,4700,5050,6050,5150,5400,4950,5250,4350,5350,3950,5700,4300,4750,5550,4900,4200,5400,5100,5300,4850,5300,4400,5000,4900,5050,4300,5000,4450,5550,4200,5300,4400,5650,4700,5700,4650,5800,4700,5550,4750,5000,5100,5200,4700,5800,4600,6000,4750,5950,4625,5450,4725,5350,4750,5600,4600,5300,4875,5550,4950,5400,4750,5650,4850,5200,4925,4875,4625,5250,4850,5600,4975,5500,4725,5500,4700,5500,4575,5500,5000,5950,4650,5500,4375,5850,4875,6000,4925,null,4850,5750,5200,5400,3500,3900,3650,3525,3725,3950,3250,3750,4150,3700,3800,3775,3700,4050,3575,4050,3300,3700,3450,4400,3600,3400,2900,3800,3300,4150,3400,3800,3700,4550,3200,4300,3350,4100,3600,3900,3850,4800,2700,4500,3950,3650,3550,3500,3675,4450,3400,4300,3250,3675,3325,3950,3600,4050,3350,3450,3250,4050,3800,3525,3950,3650,3650,4000,3400,3775,4100,3775],"z":[39.100000000000001,39.5,40.299999999999997,null,36.700000000000003,39.299999999999997,38.899999999999999,39.200000000000003,34.100000000000001,42,37.799999999999997,37.799999999999997,41.100000000000001,38.600000000000001,34.600000000000001,36.600000000000001,38.700000000000003,42.5,34.399999999999999,46,37.799999999999997,37.700000000000003,35.899999999999999,38.200000000000003,38.799999999999997,35.299999999999997,40.600000000000001,40.5,37.899999999999999,40.5,39.5,37.200000000000003,39.5,40.899999999999999,36.399999999999999,39.200000000000003,38.799999999999997,42.200000000000003,37.600000000000001,39.799999999999997,36.5,40.799999999999997,36,44.100000000000001,37,39.600000000000001,41.100000000000001,37.5,36,42.299999999999997,39.600000000000001,40.100000000000001,35,42,34.5,41.399999999999999,39,40.600000000000001,36.5,37.600000000000001,35.700000000000003,41.299999999999997,37.600000000000001,41.100000000000001,36.399999999999999,41.600000000000001,35.5,41.100000000000001,35.899999999999999,41.799999999999997,33.5,39.700000000000003,39.600000000000001,45.799999999999997,35.5,42.799999999999997,40.899999999999999,37.200000000000003,36.200000000000003,42.100000000000001,34.600000000000001,42.899999999999999,36.700000000000003,35.100000000000001,37.299999999999997,41.299999999999997,36.299999999999997,36.899999999999999,38.299999999999997,38.899999999999999,35.700000000000003,41.100000000000001,34,39.600000000000001,36.200000000000003,40.799999999999997,38.100000000000001,40.299999999999997,33.100000000000001,43.200000000000003,35,41,37.700000000000003,37.799999999999997,37.899999999999999,39.700000000000003,38.600000000000001,38.200000000000003,38.100000000000001,43.200000000000003,38.100000000000001,45.600000000000001,39.700000000000003,42.200000000000003,39.600000000000001,42.700000000000003,38.600000000000001,37.299999999999997,35.700000000000003,41.100000000000001,36.200000000000003,37.700000000000003,40.200000000000003,41.399999999999999,35.200000000000003,40.600000000000001,38.799999999999997,41.5,39,44.100000000000001,38.5,43.100000000000001,36.799999999999997,37.5,38.100000000000001,41.100000000000001,35.600000000000001,40.200000000000003,37,39.700000000000003,40.200000000000003,40.600000000000001,32.100000000000001,40.700000000000003,37.299999999999997,39,39.200000000000003,36.600000000000001,36,37.799999999999997,36,41.5,46.100000000000001,50,48.700000000000003,50,47.600000000000001,46.5,45.399999999999999,46.700000000000003,43.299999999999997,46.799999999999997,40.899999999999999,49,45.5,48.399999999999999,45.799999999999997,49.299999999999997,42,49.200000000000003,46.200000000000003,48.700000000000003,50.200000000000003,45.100000000000001,46.5,46.299999999999997,42.899999999999999,46.100000000000001,44.5,47.799999999999997,48.200000000000003,50,47.299999999999997,42.799999999999997,45.100000000000001,59.600000000000001,49.100000000000001,48.399999999999999,42.600000000000001,44.399999999999999,44,48.700000000000003,42.700000000000003,49.600000000000001,45.299999999999997,49.600000000000001,50.5,43.600000000000001,45.5,50.5,44.899999999999999,45.200000000000003,46.600000000000001,48.5,45.100000000000001,50.100000000000001,46.5,45,43.799999999999997,45.5,43.200000000000003,50.399999999999999,45.299999999999997,46.200000000000003,45.700000000000003,54.299999999999997,45.799999999999997,49.799999999999997,46.200000000000003,49.5,43.5,50.700000000000003,47.700000000000003,46.399999999999999,48.200000000000003,46.5,46.399999999999999,48.600000000000001,47.5,51.100000000000001,45.200000000000003,45.200000000000003,49.100000000000001,52.5,47.399999999999999,50,44.899999999999999,50.799999999999997,43.399999999999999,51.299999999999997,47.5,52.100000000000001,47.5,52.200000000000003,45.5,49.5,44.5,50.799999999999997,49.399999999999999,46.899999999999999,48.399999999999999,51.100000000000001,48.5,55.899999999999999,47.200000000000003,49.100000000000001,47.299999999999997,46.799999999999997,41.700000000000003,53.399999999999999,43.299999999999997,48.100000000000001,50.5,49.799999999999997,43.5,51.5,46.200000000000003,55.100000000000001,44.5,48.799999999999997,47.200000000000003,null,46.799999999999997,50.399999999999999,45.200000000000003,49.899999999999999,46.5,50,51.299999999999997,45.399999999999999,52.700000000000003,45.200000000000003,46.100000000000001,51.299999999999997,46,51.299999999999997,46.600000000000001,51.700000000000003,47,52,45.899999999999999,50.5,50.299999999999997,58,46.399999999999999,49.200000000000003,42.399999999999999,48.5,43.200000000000003,50.600000000000001,46.700000000000003,52,50.5,49.5,46.399999999999999,52.799999999999997,40.899999999999999,54.200000000000003,42.5,51,49.700000000000003,47.5,47.600000000000001,52,46.899999999999999,53.5,49,46.200000000000003,50.899999999999999,45.5,50.899999999999999,50.799999999999997,50.100000000000001,49,51.5,49.799999999999997,48.100000000000001,51.399999999999999,45.700000000000003,50.700000000000003,42.5,52.200000000000003,45.200000000000003,49.299999999999997,50.200000000000003,45.600000000000001,51.899999999999999,46.799999999999997,45.700000000000003,55.799999999999997,43.5,49.600000000000001,50.799999999999997,50.200000000000003],"mode":"markers+lines","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-37" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-37', 'opt-start-37')"> <span class="olab">Model Specification</span></span>
</div>
<div id="opt-body-37" class="optional-body" style="display: none;">
<p><span class="math display">\[
\begin{align}
\text{Body Mass} ~=~ &amp; \beta_0 + \beta_1 \cdot \text{Flipper Length} + \beta_2 \cdot \text{Bill Length} \\  
&amp; + \beta_3 \cdot (\text{Flipper Length} \cdot \text{Bill Length}) + \epsilon
\end{align}
\]</span></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-38" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-38', 'opt-start-38')"> <span class="olab">Model Building</span></span>
</div>
<div id="opt-body-38" class="optional-body" style="display: none;">
<p>No penguins in our dataset had zero mm flipper or bill lengths. We might want to mean centre both of these predictor variables so that we can consider the difference in body mass between penguins with average flipper lengths and average bill lengths. Before we build our model, we should mean centre our two IVs:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   mc_flipper_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>   mc_bill_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then specify our model using these two mean centred IVs:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mdl_nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">mc_flipper_length_mm</span> <span class="op">*</span> <span class="va">mc_bill_length_mm</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mdl_nn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ mc_flipper_length_mm * mc_bill_length_mm, 
    data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max 
-1040.18  -283.07   -23.94   241.93  1241.40 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            4141.4879    26.4532 156.559  &lt; 2e-16
mc_flipper_length_mm                     45.3910     2.1082  21.531  &lt; 2e-16
mc_bill_length_mm                        11.8249     5.3161   2.224 0.026785
mc_flipper_length_mm:mc_bill_length_mm    1.1998     0.3224   3.721 0.000232
                                          
(Intercept)                            ***
mc_flipper_length_mm                   ***
mc_bill_length_mm                      *  
mc_flipper_length_mm:mc_bill_length_mm ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 386.8 on 338 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.7694,    Adjusted R-squared:  0.7674 
F-statistic: 375.9 on 3 and 338 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-39" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-39', 'opt-start-39')"> <span class="olab">Results Interpretation</span></span>
</div>
<div id="opt-body-39" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><code>(Intercept)</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><code>mc_flipper_length_mm</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false"><code>mc_bill_length_mm</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false"><code>mc_flipper_length_mm:mc_bill_length_mm</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p><span class="math inline">\(\beta_0\)</span> = <code>(Intercept)</code> = 4141.49</p>
<ul>
<li>The intercept, or predicted body mass of penguins for average flipper and bill length.
<ul>
<li>A penguin with average flipper and bill length was expected to have a body mass of <span class="math inline">\(4141.49g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p><span class="math inline">\(\beta_1\)</span> = <code>mc_flipper_length_mm</code> = 45.39</p>
<ul>
<li>The simple slope of flipper length (in mm) when bill length was average.
<ul>
<li>For a penguin with an average bill length, every 1mm increase in flipper length was associated with a significant <span class="math inline">\((p &lt; .001)\)</span> increase of <span class="math inline">\(45.39g\)</span> in their body mass.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p><span class="math inline">\(\beta_2\)</span> = <code>mc_bill_length_mm</code> = 11.82</p>
<ul>
<li>The simple slope of bill length (in mm) when flipper length was average.
<ul>
<li>For a penguin with an average flipper length, every 1mm increase in bill length was associated with a significant <span class="math inline">\((p &lt; .05)\)</span> increase in their body mass by <span class="math inline">\(11.82g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<p><span class="math inline">\(\beta_3\)</span> = <code>mc_flipper_length_mm:mc_bill_length_mm</code> = 1.2</p>
<ul>
<li>The interaction between flipper and bill length on body mass - the change in the slope of flipper length as a function of bill length.
<ul>
<li>For every 1mm increase in bill length, when flipper length increased by 1mm, the slope with body mass was adjusted by 1.20 <span class="math inline">\((\beta = 1.2,~p &lt; .001)\)</span>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-40" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-40', 'opt-start-40')"> <span class="olab">Model Visualisation</span></span>
</div>
<div id="opt-body-40" class="optional-body" style="display: none;">
<p>We can do this using the <code><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">probe_interaction()</a></code> function from the <strong>interactions</strong> package.</p>
<p>In terms of of specification, it might be useful to look up the helper function (i.e., <code><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">?probe_interaction</a></code>). As a quick guide:</p>
<ul>
<li>
<code>model =</code>: The name model to be used<br>
</li>
<li>
<code>pred =</code>: The continuous predictor variable that will appear on the x-axis<br>
</li>
<li>
<code>modx =</code>: The continuous moderator variable<br>
</li>
<li>
<code>interval =</code>: If we say <code>TRUE</code>, then confidence/prediction intervals will be plotted around the line<br>
</li>
<li>
<code>jnplot =</code>: Since we are looking at a numeric x numeric interaction, we want to specify that this is <code>TRUE</code>
</li>
</ul>
<p>Remember to give your plot informative titles/labels. You, for example, likely want to give your plot:</p>
<ul>
<li>a clear and concise title (specify <code>main.title =</code>)<br>
</li>
<li>axis labels with units or scale included (specify <code>x.label =</code> and <code>y.label =</code>)<br>
</li>
<li>a legend title (specify <code>legend.main =</code>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://interactions.jacob-long.com">interactions</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt_mdl_nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://interactions.jacob-long.com/reference/probe_interaction.html">probe_interaction</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mdl_nn</span>,</span>
<span>                                pred <span class="op">=</span> <span class="va">mc_flipper_length_mm</span>,</span>
<span>                                modx <span class="op">=</span> <span class="va">mc_bill_length_mm</span>,</span>
<span>                                cond.int <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                interval <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                jnplot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                main.title <span class="op">=</span> <span class="st">"Bill Length Moderating the Effect of Flipper Length on Body Mass"</span>,</span>
<span>                                x.label <span class="op">=</span> <span class="st">"Flipper Length (in mm; Mean Centered)"</span>,</span>
<span>                                y.label <span class="op">=</span> <span class="st">"Body Mass (in g)"</span>,</span>
<span>                                legend.main <span class="op">=</span> <span class="st">"Bill Length (in mm; Mean Centered)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the above, we can choose to extract different information/visualisations of simple slopes (this will likely be dependent upon the question(s) you are trying to answer) - the interaction plot, simple slopes analysis only, johnson-neyman plot only, or both simple slopes and johnson-neyman plot:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Interaction Plot</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Simple Slopes Only</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Johnson-Neyman Plot Only</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false">Both Simple Slopes &amp; Johnson-Neyman Plot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>The default simple slopes analysis selects <span class="math inline">\(z\)</span>-values for us at which to test the slope. The defaults are: the mean of <span class="math inline">\(Z\)</span>, and <span class="math inline">\(+1~SD\)</span> and <span class="math inline">\(-1~SD\)</span> from the mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plt_mdl_nn</span><span class="op">$</span><span class="va">interactplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<p>Here we can look a the significance of each slope:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plt_mdl_nn</span><span class="op">$</span><span class="va">simslopes</span><span class="op">$</span><span class="va">slopes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Value of mc_bill_length_mm     Est.     S.E.     2.5%    97.5%   t val.
1              -5.459584e+00 38.84037 3.185723 32.57403 45.10672 12.19201
2               1.018029e-15 45.39104 2.108209 41.24417 49.53790 21.53061
3               5.459584e+00 51.94170 2.222151 47.57071 56.31269 23.37452
             p
1 1.379943e-28
2 2.378006e-65
3 1.402468e-72</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>The Johnson-Neyman plot allows us to visualise the regions of significance - i.e., it identifies the range of the moderator variable <span class="math inline">\((Z)\)</span> where the effect of the independent variable <span class="math inline">\((X)\)</span> on the dependent variable <span class="math inline">\((Y)\)</span> is statistically significant (e.g., <span class="math inline">\(p &lt; .05\)</span>). Outwith these regions, the effect of the independent variable is not significant.</p>
<p>Pointers to help with interpretation of the plot:</p>
<ul>
<li>x-axis = Values of moderator variable <span class="math inline">\((Z)\)</span><br>
</li>
<li>y-axis = The conditional effect (slope) of the independent variable <span class="math inline">\((X)\)</span> on the dependent variable <span class="math inline">\((Y)\)</span><br>
</li>
<li>Bold black line (range of observed data) = The actual range of the moderator variable <span class="math inline">\((Z)\)</span> values within the dataset. This helps with interpretation of results, and more importantly, avoid extrapolation - i.e., should help to ensure that the interpretations of the plot are data-driven and based on the actually observed data<br>
</li>
<li>Zero line = The horizontal line at <span class="math inline">\(y = 0\)</span> indicates the point where the effect of the IV <span class="math inline">\((X)\)</span> on the DV <span class="math inline">\((Y)\)</span> is neither positive or negative<br>
</li>
<li>Shaded areas = Regions where the effect is significant (e.g., <em>outside</em> the bounds of 95% confidence intervals that include zero) are highlighted in blue. Regions where the effect is non-significant (e.g., crosses the zero line, <em>inside</em> the bounds of the 95% confidence intervals that include zero) are highlighted in red</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plt_mdl_nn</span><span class="op">$</span><span class="va">simslopes</span><span class="op">$</span><span class="va">jnplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<p>When we return both the simple slopes analysis and Johnson-Neyman plot, we can see that some text is also provided to aid our interpretation of the plot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plt_mdl_nn</span><span class="op">$</span><span class="va">simslopes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>JOHNSON-NEYMAN INTERVAL

When mc_bill_length_mm is OUTSIDE the interval [-83.07, -23.71], the slope
of mc_flipper_length_mm is p &lt; .05.

Note: The range of observed values of mc_bill_length_mm is [-11.82, 15.68]</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>SIMPLE SLOPES ANALYSIS

When mc_bill_length_mm = -5.459584e+00 (- 1 SD): 

                                         Est.    S.E.   t val.      p
----------------------------------- --------- ------- -------- ------
Slope of mc_flipper_length_mm           38.84    3.19    12.19   0.00
Conditional intercept                 4076.93   42.62    95.65   0.00

When mc_bill_length_mm =  1.018029e-15 (Mean): 

                                         Est.    S.E.   t val.      p
----------------------------------- --------- ------- -------- ------
Slope of mc_flipper_length_mm           45.39    2.11    21.53   0.00
Conditional intercept                 4141.49   26.45   156.56   0.00

When mc_bill_length_mm =  5.459584e+00 (+ 1 SD): 

                                         Est.    S.E.   t val.      p
----------------------------------- --------- ------- -------- ------
Slope of mc_flipper_length_mm           51.94    2.22    23.37   0.00
Conditional intercept                 4206.05   35.60   118.14   0.00</code></pre>
</div>
</div>
<p>In our example, we could say:</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>The association between body mass (in g) and flipper length (in mm; mean centered) was significant when bill length (in mm; mean centered) was more than 83.07mm below the mean or greater than -23.71mm above the mean.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section><section id="categorical-x-categorical-example" class="level3"><h3 class="anchored" data-anchor-id="categorical-x-categorical-example">Categorical x Categorical Example</h3>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Do differences in body mass between species differ by sex?</p>
</blockquote>
<div class="optional-begin">
<span id="opt-start-41" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-41', 'opt-start-41')"> <span class="olab">Visualise Data</span></span>
</div>
<div id="opt-body-41" class="optional-body" style="display: none;">
<p>Since we have a continuous DV, and we have two categorical IVs, one of the most appropriate visualisations would be a boxplot:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#we need this here as we have some missing data for this particular example!</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">body_mass_g</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Body Mass (in g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-42" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-42', 'opt-start-42')"> <span class="olab">Model Specification</span></span>
</div>
<div id="opt-body-42" class="optional-body" style="display: none;">
<p>Before we specify our model, we must select (and provide justification for this choice) the reference group(s) for our categorical variable(s). In this specific example, there is no natural reference category, nor one that maps to our RQ, so we will go with <code>R</code>’s default coding and have Adelie as our reference group for species, and female for sex.</p>
<p><span class="math display">\[
\begin{aligned}
\text{Body Mass} &amp;= \beta_0 + \beta_1 \cdot \text{Species}_\text{Chinstrap} + \beta_2 \text{Species}_\text{Gentoo} + \beta_3 \cdot \text{Sex}_\text{Male}  \\
      &amp;+ \beta_4 \cdot (\text{Species}_\text{Chinstrap} \cdot \text{Sex}_\text{Male}) + \beta_5 \cdot (\text{Species}_\text{Gentoo} \cdot \text{Sex}_\text{Male}) + \epsilon
\end{aligned}
\]</span></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-43" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-43', 'opt-start-43')"> <span class="olab">Model Building</span></span>
</div>
<div id="opt-body-43" class="optional-body" style="display: none;">
<p>Recall that the default in <code>R</code> is to apply dummy coding, and thus <code>R</code> computes the dummy variables for us! Since we are using the default reference group, we can simply run our model.</p>
<p>Each row in the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> output of the model will correspond to one of the estimated <span class="math inline">\(\beta\)</span>’s in the equation above.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mdl_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mdl_cc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ species * sex, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-827.21 -213.97   11.03  206.51  861.03 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               3368.84      36.21  93.030  &lt; 2e-16 ***
speciesChinstrap           158.37      64.24   2.465  0.01420 *  
speciesGentoo             1310.91      54.42  24.088  &lt; 2e-16 ***
sexmale                    674.66      51.21  13.174  &lt; 2e-16 ***
speciesChinstrap:sexmale  -262.89      90.85  -2.894  0.00406 ** 
speciesGentoo:sexmale      130.44      76.44   1.706  0.08886 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 309.4 on 327 degrees of freedom
  (11 observations deleted due to missingness)
Multiple R-squared:  0.8546,    Adjusted R-squared:  0.8524 
F-statistic: 384.3 on 5 and 327 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-44" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-44', 'opt-start-44')"> <span class="olab">Results Interpretation</span></span>
</div>
<div id="opt-body-44" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true"><code>(Intercept)</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><code>speciesChinstrap</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false"><code>speciesGentoo</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false"><code>sexmale</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-5" role="tab" aria-controls="tabset-19-5" aria-selected="false"><code>speciesChinstrap:sexmale</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-6" role="tab" aria-controls="tabset-19-6" aria-selected="false"><code>speciesGentoo:sexmale</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p><span class="math inline">\(\beta_0\)</span> = <code>(Intercept)</code> = 3368.84</p>
<ul>
<li>The intercept, or predicted body mass of a female Adelie (i.e., when both predictor variables are at their reference levels).
<ul>
<li>A female Adelie penguin was expected to have a body mass of <span class="math inline">\(3368.84g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p><span class="math inline">\(\beta_1\)</span> = <code>speciesChinstrap</code> = 158.37</p>
<ul>
<li>The difference in body mass between female Adelie and Chinstrap penguins.
<ul>
<li>In comparison to female Adelie penguins, Chinstrap penguins of the same sex were significantly <span class="math inline">\((p &lt; .05)\)</span> heavier by <span class="math inline">\(158.37g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<p><span class="math inline">\(\beta_2\)</span> = <code>speciesGentoo</code> = 1310.91</p>
<ul>
<li>The difference in body mass between female Adelie and Gentoo penguins.
<ul>
<li>In comparison to female Adelie penguins, Gentoo penguins of the same sex were significantly <span class="math inline">\((p &lt; .001)\)</span> heavier by <span class="math inline">\(1310.91g\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-19-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<p><span class="math inline">\(\beta_3\)</span> = <code>sexmale</code> = 674.66</p>
<ul>
<li>The difference in body mass between female and male Adelie penguins.
<ul>
<li>In comparison to female Adelie penguins, male Adelie penguins were significantly heavier by <span class="math inline">\(674.66g\)</span> <span class="math inline">\((p &lt; .001)\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-19-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-5-tab">
<p><span class="math inline">\(\beta_4\)</span> = <code>speciesChinstrap:sexmale</code> = -262.89</p>
<ul>
<li>The difference in body mass for Adelie and Chinstrap penguins between females and males differed by <span class="math inline">\(-262.89g\)</span>.
<ul>
<li>The difference in body mass between female and male penguins was <span class="math inline">\(262.89g\)</span> less for Chinstrap penguins in comparison to Adele penguins. This difference was statistically significant <span class="math inline">\(p &lt; .05\)</span>.</li>
<li>The difference in body mass between female and male penguins was significantly less for the Chinstrap species in comparison to Adelie (where there was an additional <span class="math inline">\(262.89g\)</span> lesser difference between the two sexes).</li>
</ul>
</li>
</ul>
</div>
<div id="tabset-19-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-6-tab">
<p><span class="math inline">\(\beta_5\)</span> = <code>speciesGentoo:sexmale</code> = 130.44</p>
<ul>
<li>The difference in body mass for Adelie and Gentoo penguins between females and males differed by <span class="math inline">\(130.44g\)</span>.
<ul>
<li>The difference in body mass between female and male penguins was <span class="math inline">\(130.45g\)</span> more for Gentoo penguins in comparison to Adele penguins. This difference was not statistically significant <span class="math inline">\(p = .089\)</span>.<br>
</li>
<li>The difference in body mass between female and male penguins was more for the Gentoo species in comparison to Adelie (where there was an additional <span class="math inline">\(130.45g\)</span> greater difference between the two sexes), though this difference was not statistically significant.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-45" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-45', 'opt-start-45')"> <span class="olab">Model Visualisation</span></span>
</div>
<div id="opt-body-45" class="optional-body" style="display: none;">
<p>We can do this using the <code><a href="https://interactions.jacob-long.com/reference/cat_plot.html">cat_plot()</a></code> function from the <strong>interactions</strong> package.</p>
<p>In terms of of specification, it might be useful to look up the helper function (i.e., <code><a href="https://interactions.jacob-long.com/reference/cat_plot.html">?cat_plot</a></code>). As a quick guide:</p>
<ul>
<li>
<code>model =</code>: The name model to be used<br>
</li>
<li>
<code>pred =</code>: The categorical predictor variable that will appear on the x-axis<br>
</li>
<li>
<code>modx =</code>: The categorical moderator variable</li>
</ul>
<p>Remember to give your plot informative titles/labels. You, for example, likely want to give your plot:</p>
<ul>
<li>a clear and concise title (specify <code>main.title =</code>)<br>
</li>
<li>axis labels with units or scale included (specify <code>x.label =</code> and <code>y.label =</code>)<br>
</li>
<li>a legend title (specify <code>legend.main =</code>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://interactions.jacob-long.com">interactions</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt_mdl_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://interactions.jacob-long.com/reference/cat_plot.html">cat_plot</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mdl_cc</span>,</span>
<span>                                pred <span class="op">=</span> <span class="va">species</span>,</span>
<span>                                modx <span class="op">=</span> <span class="va">sex</span>,</span>
<span>                                main.title <span class="op">=</span> <span class="st">"Body Mass across Species and Sex"</span>,</span>
<span>                                x.label <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>                                y.label <span class="op">=</span> <span class="st">"Body Mass (in g)"</span>,</span>
<span>                                legend.main <span class="op">=</span> <span class="st">"Sex"</span><span class="op">)</span></span>
<span><span class="va">plt_mdl_cc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-46" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-46', 'opt-start-46')"> <span class="olab">Coding Constraints</span></span>
</div>
<div id="opt-body-46" class="optional-body" style="display: none;">
<p>When we have categorical predictors, our choice of contrasts coding changes the bits that we’re getting our of our model.</p>
<p>Suppose we have a 2x2 design (condition A and B, in groups 1 and 2):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-sumplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sumplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-sumplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sumplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Categorical x Categorical Interaction plot
</figcaption></figure>
</div>
</div>
</div>
<p>When we are using the default contrasts coding (i.e., treatment or dummy) in <code>R</code>, then our coefficients for the individual predictors represent moving between the dots in <a href="#fig-sumplot" class="quarto-xref">Figure&nbsp;5</a>.</p>
<pre><code>Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            1.9098     0.1759  10.855  &lt; 2e-16 ***
conditionB             1.1841     0.2488   4.759 5.65e-06 ***
grouping2             -1.6508     0.2488  -6.635 1.09e-09 ***
conditionB:grouping2  -2.1627     0.3519  -6.146 1.15e-08 ***
---</code></pre>
<ul>
<li>The intercept is the red circle in <a href="#fig-sumplot" class="quarto-xref">Figure&nbsp;5</a>.<br>
</li>
<li>The coefficient for condition is the difference between the red circle and the red triangle in <a href="#fig-sumplot" class="quarto-xref">Figure&nbsp;5</a>.<br>
</li>
<li>The coefficient for grouping is the difference between the red circle and the blue circle in <a href="#fig-sumplot" class="quarto-xref">Figure&nbsp;5</a>.<br>
</li>
<li>The interaction coefficient is the difference from the slope of the red line to the slope of the blue line.</li>
</ul>
<p>However, when we change to using effects (or sum-to-zero) coding, we’re switching where zero is in our model. So if we change to sum contrasts (here we’ve changed <strong>both</strong> predictors to using sum-to-zero coding), then we end up estimating the effect of each predictor averaged across the other.</p>
<pre><code>Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           1.13577    0.08796  12.912  &lt; 2e-16 ***
conditionB            0.05141    0.08796   0.584     0.56    
grouping2            -1.36607    0.08796 -15.530  &lt; 2e-16 ***
conditionB:grouping2 -0.54066    0.08796  -6.146 1.15e-08 ***
---</code></pre>
<ul>
<li>The intercept is the grey X in <a href="#fig-sumplot2" class="quarto-xref">Figure&nbsp;6</a>.<br>
</li>
<li>The coefficient for condition is the difference between the grey X and the grey triangle in <a href="#fig-sumplot2" class="quarto-xref">Figure&nbsp;6</a>.<br>
</li>
<li>The coefficient for grouping is the difference between the grey X and the blue line in <a href="#fig-sumplot2" class="quarto-xref">Figure&nbsp;6</a>.<br>
</li>
<li>The interaction coefficient is the difference from the slope of the grey line to slope of the blue line.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-sumplot2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sumplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-sumplot2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sumplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Visualisation of sum-to-zero for categorical x categorical interaction plot
</figcaption></figure>
</div>
</div>
</div>
<p>It can get quite confusing when we start switching up the contrasts, but it’s all just because we’re changing what “zero” means, and what “moving 1” means:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Dummy/Treatment Coding</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Effects/Sum-to-Zero Coding</a></li>
</ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-47" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-47', 'opt-start-47')"> <span class="olab">Simple Effects</span></span>
</div>
<div id="opt-body-47" class="optional-body" style="display: none;">
<p>Simple effects involve examining the effect of one independent variable at a specific level of a second independent variable. This can allow us to better understand the nature of the interaction as we can examine group differences within one level of one of the independent variables.</p>
<p>Going back to our penguins example, we could ask:</p>
<ul>
<li>Is there an effect of sex for chinstrap penguins? Or in other words, is there a difference in body mass between male and female chinstrap penguins?</li>
</ul>
<p>To test simple effects, we can use the <strong>emmeans</strong> package.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#load the emmeans package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/">emmeans</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#obtain estimates of simple comparisons of cell means</span></span>
<span><span class="va">mdl_cc_emm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mdl_cc</span>, <span class="op">~</span><span class="va">species</span><span class="op">*</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#return cell means</span></span>
<span><span class="va">mdl_cc_emm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> species   sex    emmean   SE  df lower.CL upper.CL
 Adelie    female   3369 36.2 327     3298     3440
 Chinstrap female   3527 53.1 327     3423     3632
 Gentoo    female   4680 40.6 327     4600     4760
 Adelie    male     4043 36.2 327     3972     4115
 Chinstrap male     3939 53.1 327     3835     4043
 Gentoo    male     5485 39.6 327     5407     5563

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify that we want to compare sex for each species</span></span>
<span><span class="va">mdl_cc_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, simple <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#return comparison </span></span>
<span><span class="va">mdl_cc_simple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>species = Adelie:
 contrast      estimate   SE  df t.ratio p.value
 female - male     -675 51.2 327 -13.174  &lt;.0001

species = Chinstrap:
 contrast      estimate   SE  df t.ratio p.value
 female - male     -412 75.0 327  -5.487  &lt;.0001

species = Gentoo:
 contrast      estimate   SE  df t.ratio p.value
 female - male     -805 56.7 327 -14.188  &lt;.0001</code></pre>
</div>
</div>
</div>
<p>We can also visualise the interaction using <code><a href="https://rvlenth.github.io/emmeans/reference/emmip.html">emmip()</a></code>. Here we need to specify the model object, what we want on the x- and y-axis, and whether we want 95% CIs to be displayed.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## first argument is the model object we need to use to visualise the slopes</span></span>
<span><span class="co">## species is on the x axis</span></span>
<span><span class="co">## separate lines for each level of sex</span></span>
<span><span class="co">## return 95% CIs is set to true (default is false)</span></span>
<span></span>
<span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmip.html">emmip</a></span><span class="op">(</span><span class="va">mdl_cc</span>, <span class="va">sex</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>      CIs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Predicted Weight (g)"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-penguin-simp" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguin-simp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-penguin-simp-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguin-simp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Predicted Penguin Weight by Species and Sex
</figcaption></figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>A simple effects analysis examined the whether there was a difference in body mass between male and female chinstrap penguins. Males <span class="math inline">\((M = 3939~g)\)</span> were estimated to be heavier than females <span class="math inline">\((M = 3527~g)\)</span> with an estimated difference of <span class="math inline">\(412~g\)</span>, and this difference was statistically significant <span class="math inline">\(p &lt; .001\)</span>. This difference is visually presented in <a href="#fig-penguin-simp" class="quarto-xref">Figure&nbsp;7</a>.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
</section></section><section id="general" class="level2"><h2 class="anchored" data-anchor-id="general">General</h2>
<div class="optional-begin">
<span id="opt-start-48" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-48', 'opt-start-48')"> <span class="olab">Extracting Information</span></span>
</div>
<div id="opt-body-48" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">Model Call</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Residuals</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">Model Coefficients</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-4" role="tab" aria-controls="tabset-22-4" aria-selected="false"><span class="math inline">\(\sigma\)</span></a></li>
</ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_call.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, model formula highlighted</figcaption></figure>
</div>
</div>
</div>
<p>The call section at the very top of the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> output shows us the formula that was specified in <code>R</code> to fit the regression model.</p>
<p>In the above, we can see that recall accuracy is our DV, recall confidence and age were our two IVs, and our dataset was named recalldata.</p>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_residuals.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, residuals highlighted</figcaption></figure>
</div>
</div>
</div>
<p>Residuals are the difference between the observed values and model predicted values of the DV.</p>
<p>Ideally, for the model to be unbiased, we want our median value to be around 0, as this would show that the errors are random fluctuations around the true line. When this is the case, we know that our model is doing a good job predicting values at the high and low ends of our dataset, and that our residuals were somewhat symmetrical.</p>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_coefficients.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, model coefficients highlighted</figcaption></figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Estimates</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Std. Error</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">t value</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">Pr(&gt;|t|)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>Our model estimates help us to build our best fitting equation of the line that represents the association between our DV and our IV(s).</p>
<p>In the above example, we can build our equation for our model from this information:</p>
<p><span class="math display">\[
\text{Recall Accuracy}_i = \beta_0 + \beta_1 \cdot \text{Recall Confidence}_i + \beta_2 \cdot \text{Age}_i + \epsilon_i
\]</span> <span class="math display">\[
\widehat{\text{Recall Accuracy}} = 36.16 + 0.90 \cdot \text{Recall Confidence} - 0.34 \cdot \text{Age}
\]</span></p>
<div class="blue">
<p><strong>In R</strong></p>
<p>There are numerous equivalent ways to obtain the estimated regression coefficients — that is, <span class="math inline">\(\hat \beta_0\)</span>, <span class="math inline">\(\hat \beta_1\)</span>, …., <span class="math inline">\(\hat \beta_k\)</span> — from the fitted model (for this below example, our fitted model has been named <code>mdl</code>):</p>
<ul>
<li><code>mdl</code></li>
<li><code>mdl$coefficients</code></li>
<li><code>coef(mdl)</code></li>
<li><code>coefficients(mdl)</code></li>
</ul>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>The standard error of the coefficient is an estimate of the standard deviation of the coefficient (i.e., how much uncertainty there is in our estimated coefficient).</p>
<div class="blue">
<p><strong>In R</strong></p>
<p>If you wanted to obtain just the standard error for each estimated regression coefficient, you could do the following (for this below example, our fitted model has been named <code>mdl</code>):</p>
<ul>
<li><code>summary(mdl)$coefficients[,2]</code></li>
</ul>
</div>
<p>Using the standard error, we can create confidence intervals to estimate a plausible range of values for the true population parameter. Recall the formula for obtaining a confidence interval for the population slope is:</p>
<p><span class="math display">\[
\hat \beta_j \pm t^* \cdot SE(\hat \beta_j)
\]</span> where <span class="math inline">\(t^*\)</span> denotes the critical value chosen from t-distribution with <span class="math inline">\(n-k-1\)</span> degrees of freedom (where <span class="math inline">\(k\)</span> = number of predictors and <span class="math inline">\(n\)</span> = sample size) for a desired <span class="math inline">\(\alpha\)</span> level of confidence.</p>
<div class="blue">
<p><strong>In R</strong></p>
<p>We can obtain the confidence intervals for the regression coefficients using the command <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code></p>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<p>The t-statistic is the <span class="math inline">\(\beta\)</span> coefficient divided by the standard error:</p>
<p><span class="math display">\[
t = \frac{\hat \beta_j - 0}{SE(\hat \beta_j)}
\]</span></p>
<p>which follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-k-1\)</span> degrees of freedom (where <span class="math inline">\(k\)</span> = number of predictors and <span class="math inline">\(n\)</span> = sample size).</p>
<p>With this, we can test the the null hypothesis <span class="math inline">\(H_0: \beta_j = 0\)</span>.</p>
<p>Generally speaking, you want your model coefficients to have large <span class="math inline">\(t\)</span>-statistics as this would indicate that the standard error was small in comparison to the coefficient. The larger our <span class="math inline">\(t\)</span>-statistic, the more confident we can be that the coefficient is not 0.</p>
<div class="blue">
<p><strong>In R</strong></p>
<p>If you wanted to obtain just the <span class="math inline">\(t\)</span>-values for each estimated regression coefficient, you could do the following (for this below example, our fitted model has been named <code>mdl</code>):</p>
<ul>
<li><code>coef(summary(mdl))[, "t value"]</code></li>
<li><code>summary(mdl)$coefficients[,3]</code></li>
</ul>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<p>From our <span class="math inline">\(t\)</span>-value, we can compute our <span class="math inline">\(p\)</span>-value. The <span class="math inline">\(p\)</span>-value help us to understand whether our coefficient(s) are statistically significant (i.e., that the coefficient is statistically different from 0). The <span class="math inline">\(p\)</span>-value of each estimate indicates the probability of observing a <span class="math inline">\(t\)</span>-value at least as extreme as, or more extreme than, the one calculated from the sample data when assuming the null hypothesis to be true.</p>
<p>In Psychology, a <span class="math inline">\(p\)</span>-value &lt; .05 is usually used to make statements regarding statistical significance (it is important that you always state your <span class="math inline">\(\alpha\)</span> level to help your reader understand any statements regarding statistical significance).</p>
<p>The number of asterisks marks corresponds with the significance of the coefficient (see the ‘Signif. codes’ legend just under the coefficients section).</p>
<div class="blue">
<p><strong>In R</strong></p>
<p>If you wanted to obtain just the <span class="math inline">\(p\)</span>-values for each estimated regression coefficient, you could do the following (for this below example, our fitted model has been named <code>mdl</code>):</p>
<ul>
<li><code>summary(mdl)$coefficients[,4]</code></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-22-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-4-tab">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_residerror.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, model standard deviation of the errors highlighted</figcaption></figure>
</div>
</div>
</div>
<p>The standard deviation of the errors, denoted by <span class="math inline">\(\sigma\)</span>, is an important quantity that our model estimates. It represents how much individual data points tend to deviate above and below the regression line - in other words, it tells us how well the model fits the data.</p>
<p>A small <span class="math inline">\(\sigma\)</span> indicates that the points hug the line closely and we should expect fairly accurate predictions, while a large <span class="math inline">\(\sigma\)</span> suggests that, even if we estimate the line perfectly, we can expect individual values to deviate from it by substantial amounts.</p>
<p>The <em>estimated</em> standard deviation of the errors is denoted <span class="math inline">\(\hat \sigma\)</span>, and is estimated by essentially averaging squared residuals (giving the variance) and taking the square-root:</p>
<p><span class="math display">\[
\begin{align}
&amp; \hat \sigma = \sqrt{\frac{SS_{Residual}}{n - k - 1}} \\
\qquad \\
&amp; \text{where} \\
&amp; SS_{Residual} = \textrm{Sum of Squared Residuals} = \sum_{i=1}^n{(\epsilon_i)^2}
\end{align}
\]</span></p>
<div class="blue">
<p><strong>In R</strong></p>
<p>There are a couple of equivalent ways to obtain the estimated standard deviation of the errors — that is, <span class="math inline">\(\hat \sigma\)</span> — from the fitted model (for this example, our fitted model has been named <code>mdl</code>):</p>
<ul>
<li><code>sigma(mdl)</code></li>
<li><code>summary(mdl)</code></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section><section id="manual-contrasts" class="level2"><h2 class="anchored" data-anchor-id="manual-contrasts">Manual Contrasts</h2>
<p>Dummy and effects coding allow us to test the significance of the difference between means of groups and some other mean (either reference group or grand mean respectively). However, in some cases, we may want to test more specific hypotheses that require us to test the difference between particular <em>combinations</em> of groups. In such cases, we can use manual contrasts.</p>
<div class="optional-begin">
<span id="opt-start-49" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-49', 'opt-start-49')"> <span class="olab">Rules</span></span>
</div>
<div id="opt-body-49" class="optional-body" style="display: none;">
<p>There are some rules that we need to follow when using manual contrasts:</p>
<ul>
<li>
<strong>Rule 1</strong>: Weights are -1 <span class="math inline">\(\geq\)</span> x <span class="math inline">\(\leq\)</span> 1</li>
<li>
<strong>Rule 2</strong>: The group(s) in one chunk are given negative weights, the group(s) in the other get positive weights</li>
<li>
<strong>Rule 3</strong>: The sum of the weights of the comparison must be 0</li>
<li>
<strong>Rule 4</strong>: If a group is not involved in the comparison, weight is 0</li>
<li>
<strong>Rule 5</strong>: For a given comparison, weights assigned to group(s) are equal to 1 divided by the number of groups in that chunk.</li>
<li>
<strong>Rule 6</strong>: Restrict yourself to running <span class="math inline">\(k\)</span> - 1 comparisons (where <span class="math inline">\(k\)</span> = number of groups)</li>
<li>
<strong>Rule 7</strong>: Each contrast can only compare 2 chunks of variance</li>
<li>
<strong>Rule 8</strong>: Once a group singled out, it can not enter other contrasts</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-50" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-50', 'opt-start-50')"> <span class="olab">In R - Additive Model</span></span>
</div>
<div id="opt-body-50" class="optional-body" style="display: none;">
<p>After specifying our hypotheses, to test our contrasts, we can use the <strong>emmeans</strong> package and follow the below structure:</p>
<ul>
<li>
<strong>Step 1</strong>: Fit and run the model using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>
</li>
<li>
<strong>Step 2</strong>: Use the <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans()</a></code> function to obtain the estimated means of each group. You can visualise these by using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> on the obtained estimated means of the groups</li>
<li>
<strong>Step 3</strong>: Check the order of your levels via <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code>
</li>
<li>
<strong>Step 4</strong>: Define the contrast by specifying the weights following the rules outlined above (as well as paying attention to the ordering of the levels)</li>
<li>
<strong>Step 5</strong>: Test the pre-specified group contrast(s) via <code><a href="https://rvlenth.github.io/emmeans/reference/contrast.html">contrast()</a></code>
</li>
<li>
<strong>Step 6</strong>: Obtain confidence intervals via <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>
</li>
</ul>
<p>After completing these steps, the last task would be to interpret the results of the contrast analysis in the context of the hypothesis.</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-51" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-51', 'opt-start-51')"> <span class="olab">Example - Additive Model</span></span>
</div>
<div id="opt-body-51" class="optional-body" style="display: none;">
<p>Suppose we wanted to address the following question:</p>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Does the sepal length of an iris grown in Western states (i.e., iris setosa) differ from the sepal length of an Iris grown in Eastern states (i.e., iris versicolor and virginica)?</p>
</blockquote>
<p>We could specify our hypothesis as:</p>
<p><span class="math display">\[
\begin{aligned}
    \quad H_0 &amp;: \mu_\text{Western} = \mu_\text{Eastern} \\
    \quad H_0 &amp;: \mu_\text{Setosa} = \frac{1}{2} (\mu_\text{Versicolor} + \mu_\text{Virginica}) \\
\\
    \quad H_1 &amp;: \mu_\text{Western} \neq \mu_\text{Eastern} \\
    \quad H_1 &amp;: \mu_\text{Setosa} \neq \frac{1}{2} (\mu_\text{Versicolor} + \mu_\text{Virginica}) \\
\\
\end{aligned}
\]</span></p>
<p>And then conduct our manual contrast analysis:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Fit and run the model </span></span>
<span><span class="va">spec_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 2: Use`emmeans()`&amp; `plot()`</span></span>
<span><span class="va">seplength_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">spec_model</span>, <span class="op">~</span> <span class="va">Species</span><span class="op">)</span></span>
<span><span class="va">seplength_mean</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Species    emmean     SE  df lower.CL upper.CL
 setosa       5.01 0.0728 147     4.86     5.15
 versicolor   5.94 0.0728 147     5.79     6.08
 virginica    6.59 0.0728 147     6.44     6.73

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">seplength_mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 3: Check levels order via `levels()`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "setosa"     "versicolor" "virginica" </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4: Define contrast &amp; weights - want to compare Iris setosa to iris versicolor and iris virginica</span></span>
<span><span class="va">seplength_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Western State Iris - Eastern State Iris"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 5: run contrast analysis</span></span>
<span><span class="va">seplength_comp_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/contrast.html">contrast</a></span><span class="op">(</span><span class="va">seplength_mean</span>, method <span class="op">=</span> <span class="va">seplength_comp</span><span class="op">)</span></span>
<span><span class="va">seplength_comp_test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                estimate     SE  df t.ratio p.value
 Western State Iris - Eastern State Iris     1.26 0.0892 147  14.086  &lt;.0001</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 6: confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">seplength_comp_test</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                estimate     SE  df lower.CL upper.CL
 Western State Iris - Eastern State Iris     1.26 0.0892 147     1.08     1.43

Confidence level used: 0.95 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Bonus Step: Run inferential test and return CIs in one command</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">seplength_comp_test</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                                estimate     SE  df lower.CL upper.CL
 Western State Iris - Eastern State Iris     1.26 0.0892 147     1.08     1.43
 t.ratio p.value
  14.086  &lt;.0001

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>And write up our findings in the context of the hypothesis / research question:</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>We performed a test against <span class="math inline">\(H_0: \mu_1 - \frac{1}{2}(\mu_2 + \mu_3) = 0\)</span>. At the 5% significance level, there was evidence that iris sepal length was significantly different between Western and Eastern states in the US <span class="math inline">\((t(147) = 14.09, p &lt; .001, \text{two-sided})\)</span>, and this difference was estimated to be 1.26cm. We are 95% confident that an Iris grown in an Eastern state, on average, would be between 1.08cm and 1.43cm longer than those grown in a Western state <span class="math inline">\((CI_{95}[1.08, 1.43])\)</span>.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-52" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-52', 'opt-start-52')"> <span class="olab">In R - Interaction Model</span></span>
</div>
<div id="opt-body-52" class="optional-body" style="display: none;">
<p>After specifying our hypotheses, to test our contrasts, we can use the <strong>emmeans</strong> package and follow the below structure:</p>
<ul>
<li>
<strong>Step 1</strong>: Fit and run the model using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>
</li>
<li>
<strong>Step 2</strong>: Specify the coefficients to be used in the contrast analysis and present in a table</li>
<li>
<strong>Step 3</strong>: Use the <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans()</a></code> function to obtain the estimated means of each group. You can visualise these by using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> on the obtained estimated means of the groups</li>
<li>
<strong>Step 4</strong>: Define the contrast by specifying the weights following the rules outlined above (as well as paying attention to the ordering of the groups as specified in the output of Step 3)</li>
<li>
<strong>Step 5</strong>: Test the pre-specified group contrast(s) via <code><a href="https://rvlenth.github.io/emmeans/reference/contrast.html">contrast()</a></code>
</li>
<li>
<strong>Step 6</strong>: Obtain confidence intervals via <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>
</li>
</ul>
<p>After completing these steps, the last task would be to interpret the results of the contrast analysis in the context of the hypothesis.</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-53" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-53', 'opt-start-53')"> <span class="olab">Example - Interaction Model</span></span>
</div>
<div id="opt-body-53" class="optional-body" style="display: none;">
<p>Suppose we wanted to address the following question:</p>
<blockquote class="blockquote">
<p><strong>Research Question</strong></p>
<p>Does the difference in body mass between male and female penguins differ between those residing exclusively on the Antarctic Continent (i.e., Adelie) and those living in both Antarctica and the sub-Antarctic islands (i.e., Gentoo and Chinstrap)?</p>
</blockquote>
<p>We could specify our hypothesis as:</p>
<p><span class="math display">\[
\begin{aligned}
    H_0 &amp;: \mu_\text{(Male, Antarctic Continent)} - \mu_\text{(Female, Antarctic Continent)} = \\
    &amp;\mu_\text{(Male, Northern Antarctica | sub-Antarctic islands)} - \mu_\text{(Female, Northern Antarctica | sub-Antarctic islands)}
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
    H_1 &amp;: \mu_\text{(Male, Antarctic Continent)} - \mu_\text{(Female, Antarctic Continent)} \neq \\
    &amp;\mu_\text{(Male, Northern Antarctica | sub-Antarctic islands)}) - (\mu_\text{(Female, Northern Antarctica | sub-Antarctic islands)})
\end{aligned}
\]</span></p>
<p>Or equivalently as:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \mu_\text{(Male, Adelie)} - \mu_\text{(Female, Adelie)} = \\
   &amp; \frac{1}{2} (\mu_\text{(Male, Gentoo)} + \mu_\text{(Male, Chinstrap)}) - \frac{1}{2}(\mu_\text{(Female, Gentoo)} + \mu_\text{(Female, Chinstrap)}) \\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
H_1 &amp;: \mu_\text{(Male, Adelie)} - \mu_\text{(Female, Adelie)} \neq \\
    &amp;\frac{1}{2} (\mu_\text{(Male, Gentoo)} + \mu_\text{(Male, Chinstrap)}) - \frac{1}{2}(\mu_\text{(Female, Gentoo)} + \mu_\text{(Female, Chinstrap)}) \\
\end{aligned}
\]</span></p>
<p>And then conduct our manual contrast analysis:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Fit and run the model </span></span>
<span><span class="va">mdl_cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">~</span> <span class="va">species</span> <span class="op">*</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 2: Specify the coefficients to be used in the contrast analysis, and present in a formatted table</span></span>
<span></span>
<span><span class="co">#TWO EQUALLY VALID WAYS TO DO THIS - SELECT ONLY ONE:</span></span>
<span><span class="co">#Option 1:</span></span>
<span><span class="va">species_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Adelie'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="st">'chinstrap'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'Gentoo'</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">sex_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'male'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="st">'female'</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contr_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">species_coef</span>, <span class="va">sex_coef</span><span class="op">)</span></span>
<span><span class="va">contr_coef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          male female
Adelie     1.0   -1.0
chinstrap -0.5    0.5
Gentoo    -0.5    0.5</code></pre>
</div>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Option 2:</span></span>
<span><span class="va">species_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Adelie'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="st">'chinstrap'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'Gentoo'</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">sex_coef</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'male'</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, <span class="st">'female'</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contr_coef_2</span> <span class="op">&lt;-</span> <span class="va">species_coef</span> <span class="op"><a href="https://rdrr.io/r/base/outer.html">%o%</a></span> <span class="va">sex_coef</span></span>
<span><span class="va">contr_coef_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          male female
Adelie     1.0   -1.0
chinstrap -0.5    0.5
Gentoo    -0.5    0.5</code></pre>
</div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Convert into a well-formatted table:</span></span>
<span><span class="va">contr_coef</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">.</span>, caption <span class="op">=</span> <span class="st">"Penguin Contrast Weights"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Penguin Contrast Weights</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">male</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">female</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">chinstrap</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gentoo</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 3: Use`emmeans()`&amp; `plot()`</span></span>
<span><span class="va">species_sex_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mdl_cc</span>, <span class="op">~</span> <span class="va">species</span><span class="op">*</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">species_sex_mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> species   sex    emmean   SE  df lower.CL upper.CL
 Adelie    female   3369 36.2 327     3298     3440
 Chinstrap female   3527 53.1 327     3423     3632
 Gentoo    female   4680 40.6 327     4600     4760
 Adelie    male     4043 36.2 327     3972     4115
 Chinstrap male     3939 53.1 327     3835     4043
 Gentoo    male     5485 39.6 327     5407     5563

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">species_sex_mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4/5: Define contrast &amp; weights, and give a name to this contrast </span></span>
<span><span class="va">species_sex_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/contrast.html">contrast</a></span><span class="op">(</span><span class="va">species_sex_mean</span>,</span>
<span>                             method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">'Penguin Hyp'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>                     <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 6: examine output and return inferential stats - CIs, t-ratio, p-value</span></span>
<span></span>
<span><span class="co">#OPTION 1:</span></span>
<span><span class="co">#examine output</span></span>
<span><span class="va">species_sex_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate   SE  df t.ratio p.value
 Penguin Hyp     66.2 69.5 327   0.952  0.3416</code></pre>
</div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#obtain confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">species_sex_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate   SE  df lower.CL upper.CL
 Penguin Hyp     66.2 69.5 327    -70.6      203

Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#OPTION 2:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">species_sex_comp</span>, infer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate   SE  df lower.CL upper.CL t.ratio p.value
 Penguin Hyp     66.2 69.5 327    -70.6      203   0.952  0.3416

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>And write up our findings in the context of the hypothesis / research question:</p>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>At the 5% significance level, there was no evidence that the difference in body weight between male and female penguins differed by where the species was based geographically <span class="math inline">\((t(327) = 0.95, p = .342, \text{two-sided})\)</span>.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section><section id="multiple-comparisons" class="level2"><h2 class="anchored" data-anchor-id="multiple-comparisons">Multiple Comparisons</h2>
<div class="optional-begin">
<span id="opt-start-54" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-54', 'opt-start-54')"> <span class="olab">Pairwise Comparisons</span></span>
</div>
<div id="opt-body-54" class="optional-body" style="display: none;">
<p>We can use pairwise comparisons when we want to compare <em>all</em> levels of an independent variable with <em>all</em> the levels of the other. In other words, we can compare all <em>pairwise</em> means between groups to determine whether there is a statistical difference between each pair of groups compared.</p>
<p>For example, let’s say that you had 2 categorical variables - <code>Day</code> (5 levels: Mon, Tue, Wed, Thurs, and Fri) and <code>Time</code> (3 levels: Morning, Afternoon, and Evening) where your outcome variable was <code>productivity</code> level (scored on a scale 0-50). If we were to conduct all possible pairwise comparisons, this would lead to the following pairs of groups being compared on productivity:</p>
<ul>
<li>Mon - Morning<br>
</li>
<li>Mon - Afternoon<br>
</li>
<li>Mon - Evening<br>
</li>
<li>Tue - Morning<br>
</li>
<li>Tue - Afternoon<br>
</li>
<li>Tue - Evening<br>
</li>
<li>Wed - Morning<br>
</li>
<li>Wed - Afternoon<br>
</li>
<li>Wed - Evening<br>
</li>
<li>Thurs - Morning<br>
</li>
<li>Thurs - Afternoon<br>
</li>
<li>Thurs - Evening<br>
</li>
<li>Fri - Morning<br>
</li>
<li>Fri - Afternoon<br>
</li>
<li>Fri - Evening</li>
</ul>
<div class="blue">
<p>In <strong>R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#run comparisons</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>pair_comp <span class="ot">&lt;-</span> <span class="fu">pairs</span>(<span class="sc">&lt;</span>INSERT OBJECT NAME<span class="sc">&gt;</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">#examine output</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>pair_comp</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot comparisons</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pair_comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-55" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-55', 'opt-start-55')"> <span class="olab">Why does the Number of Tests Matter?</span></span>
</div>
<div id="opt-body-55" class="optional-body" style="display: none;">
<p>If we are conducting all possible pairwise comparisons, we can calculate how many tests are being conducted via the following rule:</p>
<p><span class="math display">\[
_nC_r = \frac{n!}{r!(n-r)!} \\
\]</span> <span class="math display">\[
\begin{align} \\
&amp; \text{Where:} \\
&amp; n = \text{total number in the set} \\
&amp; r = \text{number chosen} \\
&amp; _nC_r = \text{number of combinations of r from n} \\
\end{align}
\]</span></p>
<p>So, why does the number of tests matter? First, think back to <a href="https://uoepsy.github.io/dapr1/2324/lectures/dapr1_2_05_errorspower.pdf">“Type 1 errors” from DAPR1</a> - when we conduct an hypothesis test, and we set <span class="math inline">\(\alpha = .05\)</span>, we will reject the null hypothesis <span class="math inline">\(H_0\)</span> when we find a <span class="math inline">\(p &lt; .05\)</span>. Now remember what a <span class="math inline">\(p\)</span>-value represents - it is the chance of observing a statistic at least as extreme as the one we do have, assuming the null hypothesis to be true. This means that <em>if</em> <span class="math inline">\(H_0\)</span> <strong>is</strong> true, then we will still observe a <span class="math inline">\(p &lt; .05\)</span> 5% of the time. So our chance of making this error = the threshold (<span class="math inline">\(\alpha\)</span>) at which below a <span class="math inline">\(p\)</span>-value results in us rejecting <span class="math inline">\(H_0\)</span>.</p>
<p>But this error-rate applies to each statistical hypothesis we test. So if we conduct an experiment in which we plan on conducting lots of tests of different comparisons, the chance of an error being made increases substantially. Across the family of tests performed that chance will be much higher than 5%.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Each test conducted at <span class="math inline">\(\alpha = .05\)</span> has a .05 (or 5%) probability of Type I error (wrongly rejecting the null hypothesis). If we do 9 tests, that experiment-wise error rate is <span class="math inline">\(\alpha_{ew} \leq 9 \times .05\)</span>, where 9 is the number of comparisons made as part of the experiment.</p>
<p>Thus, if nine <strong>independent</strong> comparisons were made at the <span class="math inline">\(\alpha = .05\)</span> level, the experiment-wise Type I error rate <span class="math inline">\(\alpha_{ew}\)</span> would be at most <span class="math inline">\(9 \times .05 = 0.45\)</span>. That is, we could wrongly reject the null hypothesis on average 45 times out of 100.</p>
<p>To make this more confusing, many of the tests in a family are not <strong>independent</strong> (see the lecture slides for the calculation of error rate for dependent tests).</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-56" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-56', 'opt-start-56')"> <span class="olab">When to use Which Correction</span></span>
</div>
<div id="opt-body-56" class="optional-body" style="display: none;">
<p><strong>Bonferroni</strong></p>
<ul>
<li>Use Bonferroni’s method when you are interested in a small number of planned contrasts (or pairwise comparisons).</li>
<li>Bonferroni’s method is to divide alpha by the number of tests/confidence intervals.</li>
<li>Assumes that all comparisons are independent of one another.<br>
</li>
<li>It sacrifices slightly more power than Tukey’s method (discussed below), but it can be applied to any set of contrasts or linear combinations (i.e., it is useful in more situations than Tukey).</li>
<li>It is usually better than Tukey if we want to do a small number of planned comparisons.</li>
</ul>
<p><strong>Šídák</strong></p>
<ul>
<li>(A bit) more powerful than the Bonferroni method.</li>
<li>Assumes that all comparisons are independent of one another.</li>
<li>Less common than Bonferroni method, largely because it is more difficult to calculate (not a problem now we have computers).</li>
</ul>
<p><strong>Tukey</strong></p>
<ul>
<li>It specifies an exact family significance level for comparing all pairs of treatment means.<br>
</li>
<li>Use Tukey’s method when you are interested in all (or most) pairwise comparisons of means.</li>
</ul>
<p><strong>Scheffe</strong></p>
<ul>
<li>It is the most conservative (least powerful) of all tests.</li>
<li>It controls the family alpha level for testing all possible contrasts.</li>
<li>It should be used if you have not planned contrasts in advance.</li>
<li>For testing pairs of treatment means it is too conservative (you should use Bonferroni or Šídák).</li>
</ul>
<p><strong>Others</strong></p>
<ul>
<li>In the wider literature, Holm’s step-down and Hochberg’s step-up mentioned. Do feel free to read about these in your spare time - there are lots of resources online.</li>
</ul>
<div class="blue">
<p>In <strong>R</strong></p>
<p>You can easily change which correction you are using via the <code>adjust =</code> argument. For example, using our categorical x categorical interaction model (<code>mdl_cc</code>) using the penguins dataset:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Bonferroni</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Šídák</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">Tukey</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">Scheffe</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-5" role="tab" aria-controls="tabset-23-5" aria-selected="false">No Adjustment</a></li>
</ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bonf_pair_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bonf_pair_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                          estimate   SE  df t.ratio p.value
 Adelie female - Chinstrap female      -158 64.2 327  -2.465  0.2131
 Adelie female - Gentoo female        -1311 54.4 327 -24.088  &lt;.0001
 Adelie female - Adelie male           -675 51.2 327 -13.174  &lt;.0001
 Adelie female - Chinstrap male        -570 64.2 327  -8.875  &lt;.0001
 Adelie female - Gentoo male          -2116 53.7 327 -39.425  &lt;.0001
 Chinstrap female - Gentoo female     -1153 66.8 327 -17.246  &lt;.0001
 Chinstrap female - Adelie male        -516 64.2 327  -8.037  &lt;.0001
 Chinstrap female - Chinstrap male     -412 75.0 327  -5.487  &lt;.0001
 Chinstrap female - Gentoo male       -1958 66.2 327 -29.564  &lt;.0001
 Gentoo female - Adelie male            636 54.4 327  11.691  &lt;.0001
 Gentoo female - Chinstrap male         741 66.8 327  11.085  &lt;.0001
 Gentoo female - Gentoo male           -805 56.7 327 -14.188  &lt;.0001
 Adelie male - Chinstrap male           105 64.2 327   1.627  1.0000
 Adelie male - Gentoo male            -1441 53.7 327 -26.855  &lt;.0001
 Chinstrap male - Gentoo male         -1546 66.2 327 -23.345  &lt;.0001

P value adjustment: bonferroni method for 15 tests </code></pre>
</div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bonf_pair_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sidak_pair_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, adjust <span class="op">=</span> <span class="st">"sidak"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sidak_pair_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                          estimate   SE  df t.ratio p.value
 Adelie female - Chinstrap female      -158 64.2 327  -2.465  0.1931
 Adelie female - Gentoo female        -1311 54.4 327 -24.088  &lt;.0001
 Adelie female - Adelie male           -675 51.2 327 -13.174  &lt;.0001
 Adelie female - Chinstrap male        -570 64.2 327  -8.875  &lt;.0001
 Adelie female - Gentoo male          -2116 53.7 327 -39.425  &lt;.0001
 Chinstrap female - Gentoo female     -1153 66.8 327 -17.246  &lt;.0001
 Chinstrap female - Adelie male        -516 64.2 327  -8.037  &lt;.0001
 Chinstrap female - Chinstrap male     -412 75.0 327  -5.487  &lt;.0001
 Chinstrap female - Gentoo male       -1958 66.2 327 -29.564  &lt;.0001
 Gentoo female - Adelie male            636 54.4 327  11.691  &lt;.0001
 Gentoo female - Chinstrap male         741 66.8 327  11.085  &lt;.0001
 Gentoo female - Gentoo male           -805 56.7 327 -14.188  &lt;.0001
 Adelie male - Chinstrap male           105 64.2 327   1.627  0.8096
 Adelie male - Gentoo male            -1441 53.7 327 -26.855  &lt;.0001
 Chinstrap male - Gentoo male         -1546 66.2 327 -23.345  &lt;.0001

P value adjustment: sidak method for 15 tests </code></pre>
</div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sidak_pair_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tukey_pair_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, adjust <span class="op">=</span> <span class="st">"tukey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tukey_pair_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                          estimate   SE  df t.ratio p.value
 Adelie female - Chinstrap female      -158 64.2 327  -2.465  0.1376
 Adelie female - Gentoo female        -1311 54.4 327 -24.088  &lt;.0001
 Adelie female - Adelie male           -675 51.2 327 -13.174  &lt;.0001
 Adelie female - Chinstrap male        -570 64.2 327  -8.875  &lt;.0001
 Adelie female - Gentoo male          -2116 53.7 327 -39.425  &lt;.0001
 Chinstrap female - Gentoo female     -1153 66.8 327 -17.246  &lt;.0001
 Chinstrap female - Adelie male        -516 64.2 327  -8.037  &lt;.0001
 Chinstrap female - Chinstrap male     -412 75.0 327  -5.487  &lt;.0001
 Chinstrap female - Gentoo male       -1958 66.2 327 -29.564  &lt;.0001
 Gentoo female - Adelie male            636 54.4 327  11.691  &lt;.0001
 Gentoo female - Chinstrap male         741 66.8 327  11.085  &lt;.0001
 Gentoo female - Gentoo male           -805 56.7 327 -14.188  &lt;.0001
 Adelie male - Chinstrap male           105 64.2 327   1.627  0.5812
 Adelie male - Gentoo male            -1441 53.7 327 -26.855  &lt;.0001
 Chinstrap male - Gentoo male         -1546 66.2 327 -23.345  &lt;.0001

P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tukey_pair_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scheffe_pair_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, adjust <span class="op">=</span> <span class="st">"scheffe"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scheffe_pair_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                          estimate   SE  df t.ratio p.value
 Adelie female - Chinstrap female      -158 64.2 327  -2.465  0.3014
 Adelie female - Gentoo female        -1311 54.4 327 -24.088  &lt;.0001
 Adelie female - Adelie male           -675 51.2 327 -13.174  &lt;.0001
 Adelie female - Chinstrap male        -570 64.2 327  -8.875  &lt;.0001
 Adelie female - Gentoo male          -2116 53.7 327 -39.425  &lt;.0001
 Chinstrap female - Gentoo female     -1153 66.8 327 -17.246  &lt;.0001
 Chinstrap female - Adelie male        -516 64.2 327  -8.037  &lt;.0001
 Chinstrap female - Chinstrap male     -412 75.0 327  -5.487  &lt;.0001
 Chinstrap female - Gentoo male       -1958 66.2 327 -29.564  &lt;.0001
 Gentoo female - Adelie male            636 54.4 327  11.691  &lt;.0001
 Gentoo female - Chinstrap male         741 66.8 327  11.085  &lt;.0001
 Gentoo female - Gentoo male           -805 56.7 327 -14.188  &lt;.0001
 Adelie male - Chinstrap male           105 64.2 327   1.627  0.7539
 Adelie male - Gentoo male            -1441 53.7 327 -26.855  &lt;.0001
 Chinstrap male - Gentoo male         -1546 66.2 327 -23.345  &lt;.0001

P value adjustment: scheffe method with rank 5 </code></pre>
</div>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">scheffe_pair_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-5-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">none_pair_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mdl_cc_emm</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">none_pair_comp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                          estimate   SE  df t.ratio p.value
 Adelie female - Chinstrap female      -158 64.2 327  -2.465  0.0142
 Adelie female - Gentoo female        -1311 54.4 327 -24.088  &lt;.0001
 Adelie female - Adelie male           -675 51.2 327 -13.174  &lt;.0001
 Adelie female - Chinstrap male        -570 64.2 327  -8.875  &lt;.0001
 Adelie female - Gentoo male          -2116 53.7 327 -39.425  &lt;.0001
 Chinstrap female - Gentoo female     -1153 66.8 327 -17.246  &lt;.0001
 Chinstrap female - Adelie male        -516 64.2 327  -8.037  &lt;.0001
 Chinstrap female - Chinstrap male     -412 75.0 327  -5.487  &lt;.0001
 Chinstrap female - Gentoo male       -1958 66.2 327 -29.564  &lt;.0001
 Gentoo female - Adelie male            636 54.4 327  11.691  &lt;.0001
 Gentoo female - Chinstrap male         741 66.8 327  11.085  &lt;.0001
 Gentoo female - Gentoo male           -805 56.7 327 -14.188  &lt;.0001
 Adelie male - Chinstrap male           105 64.2 327   1.627  0.1047
 Adelie male - Gentoo male            -1441 53.7 327 -26.855  &lt;.0001
 Chinstrap male - Gentoo male         -1546 66.2 327 -23.345  &lt;.0001</code></pre>
</div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">none_pair_comp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section></section><section id="model-predicted-values-residuals" class="level1"><h1>Model Predicted Values &amp; Residuals</h1>
<p>Model predicted values are the estimates generated by a regression model for the dependent variable based on the independent variable(s), whilst residuals are the differences between these predicted values and the actual observed values (in turn indicating the accuracy of the model’s predictions).</p>
<div class="optional-begin">
<span id="opt-start-57" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-57', 'opt-start-57')"> <span class="olab">Predicted Values</span></span>
</div>
<div id="opt-body-57" class="optional-body" style="display: none;">
<section id="model-predicted-values-hat-y_i-for-sample-data" class="level3"><h3 class="anchored" data-anchor-id="model-predicted-values-hat-y_i-for-sample-data">Model predicted values (<span class="math inline">\(\hat y_i\)</span>) for sample data</h3>
<p>We can get out the model predicted values for <span class="math inline">\(y\)</span>, the “y hats” (<span class="math inline">\(\hat y\)</span>), for the data in the sample using various functions:</p>
<ul>
<li><code>predict(&lt;fitted model&gt;)</code></li>
<li><code>fitted(&lt;fitted model&gt;)</code></li>
<li><code>fitted.values(&lt;fitted model&gt;)</code></li>
<li><code>mdl$fitted.values</code></li>
</ul>
<p>For example, this will give us the estimated recall accuracy (point on our regression line) for each observed value of age for each of our 20 participants.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">recall_simp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For space saving purposes (i.e., we don’t need to see all 20 values for this demonstration!), we can return the first six predicted values via <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">recall_simp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6 
62.23045 73.42542 69.49205 68.28179 70.09719 71.61002 </code></pre>
</div>
</div>
</section><section id="model-predicted-values-for-other-unobserved-data" class="level3"><h3 class="anchored" data-anchor-id="model-predicted-values-for-other-unobserved-data">Model predicted values for other (unobserved) data</h3>
<p>To compute the model-predicted values for unobserved data (i.e., data not contained in the sample), we can use the following function:</p>
<ul>
<li><code>predict(&lt;fitted model&gt;, newdata = &lt;dataframe&gt;)</code></li>
</ul>
<p>For this example, we first need to remember that the model predicts <code>recall_accuracy</code> using the independent variable <code>age</code>. Hence, if we want predictions for new (unobserved) data, we first need to create a tibble with a column called <code>age</code> containing the age of individuals for which we want the prediction, and store this as a dataframe.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Create dataframe 'newdata' containing the age values of 19, 32, and 99</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19</span>,<span class="fl">32</span>,<span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">newdata</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
    age
  &lt;dbl&gt;
1    19
2    32
3    99</code></pre>
</div>
</div>
<p>Then we take <code>newdata</code> and add a new column called <code>accuracy_hat</code>, computed as the prediction from the fitted <code>recall_simp</code> using the <code>newdata</code> above:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="va">newdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    accuracy_hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">recall_simp</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">newdata</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    age accuracy_hat
  &lt;dbl&gt;        &lt;dbl&gt;
1    19         78.3
2    32         74.3
3    99         54.1</code></pre>
</div>
</div>
</section>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-58" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-58', 'opt-start-58')"> <span class="olab">Residuals</span></span>
</div>
<div id="opt-body-58" class="optional-body" style="display: none;">
<p>The residuals (<span class="math inline">\(\hat \epsilon_i\)</span>) represent the deviations between the actual responses and the predicted responses and can be obtained either as</p>
<ul>
<li><code>mdl$residuals</code></li>
<li><code>resid(mdl)</code></li>
<li><code>residuals(mdl)</code></li>
<li>computing them as the difference between the response (<span class="math inline">\(y_i\)</span>) and the predicted response (<span class="math inline">\(\hat y_i\)</span>)</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-59" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-59', 'opt-start-59')"> <span class="olab">Predicted Values - Example</span></span>
</div>
<div id="opt-body-59" class="optional-body" style="display: none;">
<p>Lets estimate (or predict) recall accuracy of two individuals with the following ages (a) 18, and (b) 118. There are a few ways we can do this, but first, let’s recall our fitted model:</p>
<p><span class="math display">\[
\widehat{Recall~Accuracy} = 84.02 - 0.31 \cdot \text{Age}
\]</span></p>
<p>From here we can:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Substitute in Values</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Use the <code>predict()</code> Function</a></li>
</ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<ul>
<li>The predicted average recall accuracy for individuals who are aged 18 is: <br><span class="math inline">\(84.02 - (0.31 * 18) = 78.44\)</span> <br><br>
</li>
<li>The predicted average recall accuracy for individuals who are aged 118 is: <br><span class="math inline">\(84.02 - (0.31 * 118) = 47.44\)</span>
</li>
</ul>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">accuracy_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">recall_simp</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span><span class="va">accuracy_hat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
78.56906 48.31237 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can see that both approaches (manually substituting values into the regression equation or using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function) both give us the same values (slightly different due to rounding).</p>
<p>But, be careful to not go too far off the range of the available data (I don’t know many 118 year olds, do you?). If you do, you will extrapolate. This is very dangerous…</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://imgs.xkcd.com/comics/extrapolating.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Source: Randall Munroe, xkcd.com</figcaption></figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="data-transformations" class="level1"><h1>Data Transformations</h1>
<p>There are many transformations we can do to a continuous variable, but the most common ones are centering and scaling. These transformations can help to aid interpretability of our statistical models.</p>
<div class="optional-begin">
<span id="opt-start-60" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-60', 'opt-start-60')"> <span class="olab">Centering</span></span>
</div>
<div id="opt-body-60" class="optional-body" style="display: none;">
<p>Centering simply means moving the entire distribution to be centered on some new value. We achieve this by subtracting our desired center from each value of a variable.</p>
<p>A common option is to mean center (i.e.&nbsp;to subtract the mean from each value). This makes our new values all relative to the mean. We can center a variable on other things, such as the minimum or maximum value of the scale we are using, or some judiciously chosen value of interest.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Manually mean center variable</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Add mean centered variable to data set via <code>scale()</code> function</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">Use <code>scale()</code> function within <code>lm</code> argument</a></li>
</ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_name</span> <span class="op">&lt;-</span> <span class="va">data_name</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   mc_variable <span class="op">=</span> <span class="va">variable</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_name</span> <span class="op">&lt;-</span> <span class="va">data_name</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   mc_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">DV</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">IV</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Important to Note for Interaction Models</strong></span></p>
<p>If we have the interaction <code>y ~ x1 + x2 + x1:x2</code>, then mean centering <code>x1</code> will make the coefficient for <code>x2</code> now represent “the association between <code>x2</code> and <code>y</code> for someone at the average of <code>x1</code>”. When working with models that contain interaction terms, it is generally a good idea to center your continuous predictor variables. This is because:</p>
<ul>
<li>centering helps to address issues of multicollinearity<br>
</li>
<li>centering makes the model coefficients easier to interpret</li>
</ul>
<p>Remember that the underlying model <strong>does not</strong> change, it is just extracting different information as we have changed what “zero” represents.</p>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-61" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-61', 'opt-start-61')"> <span class="olab">Scaling</span></span>
</div>
<div id="opt-body-61" class="optional-body" style="display: none;">
<p>Scaling changes the units of the variable, and we do this by dividing the observations by some value. E.g., moving from “36 months” to “3 years” involves multiplying (scaling) the value by 1/12.</p>
<p>The most common transformation that involves scaling is called <strong>standardisation</strong>.</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-62" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-62', 'opt-start-62')"> <span class="olab">Standardisation</span></span>
</div>
<div id="opt-body-62" class="optional-body" style="display: none;">
<p>This involves subtracting the mean and then dividing by the standard deviation. So standardisation centers on the sample mean and scales by the sample standard deviation. Recall that a standardized variable has mean of 0 and standard deviation of 1.</p>
<p><strong><span class="math inline">\(z\)</span>-score Formula:</strong></p>
<p><span class="math display">\[
z_x = \frac{x - \bar{x}}{s_x}, \qquad z_y = \frac{y - \bar{y}}{s_y}
\]</span></p>
<div class="blue">
<p>In <strong>R</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">Manually create z-scored variables and then use these in model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">Add scaled variable to data set via <code>scale()</code> function</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Use <code>scale()</code> function within <code>lm</code> argument</a></li>
</ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_name</span> <span class="op">&lt;-</span> <span class="va">data_name</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   z_variable <span class="op">=</span> <span class="op">(</span><span class="va">variable</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_name</span> <span class="op">&lt;-</span> <span class="va">data_name</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>   z_variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">DV</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">IV</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<p>When we standardise variables in a regression model, it means we can talk about all our coefficients in terms of “standard deviation units”. To the extent that it is possible to do so, this puts our coefficients on scales of the similar magnitude, making qualitative comparisons between the sizes of effects a little more easy.</p>
<p>We tend to refer to coefficients using standardised variables as (unsurprisingly), “standardised coefficients”</p>
<p>There are two main ways that people construct standardised coefficients. One of which standardises just the predictor, and the other of which standardises both predictor and outcome:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 19%">
<col style="width: 25%">
<col style="width: 36%">
</colgroup>
<thead><tr class="header">
<th>predictor</th>
<th>outcome</th>
<th>in lm</th>
<th>coefficient</th>
<th>interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>standardised</td>
<td>raw</td>
<td><code>y ~ scale(x)</code></td>
<td><span class="math inline">\(\beta = b \cdot s_x\)</span></td>
<td>“difference in Y for a 1 SD increase in X”</td>
</tr>
<tr class="even">
<td>standardised</td>
<td>standardised</td>
<td><code>scale(y) ~ scale(x)</code></td>
<td><span class="math inline">\(\beta = b \cdot \frac{s_x}{s_y}\)</span></td>
<td>“difference in SD of Y for a 1 SD increase in X”</td>
</tr>
</tbody>
</table>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="model-fit" class="level1"><h1>Model Fit</h1>
<p>Assessing model fit involves examining metrics like the sum of squares to measure variability explained by the model, the <span class="math inline">\(F\)</span>-ratio to evaluate the overall significance of the model by comparing explained variance to unexplained variance, and <span class="math inline">\(R\)</span>-squared / Adjusted <span class="math inline">\(R\)</span>-squared to quantify the proportion of variance in the dependent variable explained by the independent variable(s).</p>
<div class="optional-begin">
<span id="opt-start-63" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-63', 'opt-start-63')"> <span class="olab">Sums of Squares</span></span>
</div>
<div id="opt-body-63" class="optional-body" style="display: none;">
<p>To quantify and assess a model’s utility in explaining variance in an outcome variable, we can split the total variability of that outcome variable into two terms: the variability explained by the model plus the variability left unexplained in the residuals.</p>
<p>The sum of squares measures the deviation or variation of data points away from the mean (i.e., how spread out are the numbers in a given dataset). We are trying to find the equation/function that best fits our data by varying the least from our data points.</p>
<section id="total-sum-of-squares" class="level5"><h5 class="anchored" data-anchor-id="total-sum-of-squares">Total Sum of Squares</h5>
<p><strong>Formula</strong>:</p>
<p><span class="math display">\[
SS_{Total} = \sum_{i=1}^{n}(y_i - \bar{y})^2
\]</span> Can also be derived from:</p>
<p><span class="math display">\[
SS_{Total} = SS_{Model} + SS_{Residual}
\]</span></p>
<p><strong>In words</strong>:</p>
<p>Squared distance of each data point from the mean of <span class="math inline">\(y\)</span>.</p>
<p><strong>Description</strong>:</p>
<p>How much variation there is in the DV.</p>
</section><section id="residual-sum-of-squares" class="level5"><h5 class="anchored" data-anchor-id="residual-sum-of-squares">Residual Sum of Squares</h5>
<p><strong>Formula</strong>:</p>
<p><span class="math display">\[
SS_{Residual} = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2
\]</span></p>
<p><strong>In words</strong>:</p>
<p>Squared distance of each point from the predicted value.</p>
<p><strong>Description</strong>:</p>
<p>How much of the variation in the DV the model did not explain - a measure that captures the unexplained variation in your regression model. Lower residual sum of squares suggests that your model fits the data well, and higher suggests that the model poorly explains the data (in other words, the lower the value, the better the regression model). If the value was zero here, it would suggest the model fits perfectly with no error.</p>
</section><section id="model-sum-of-squares" class="level5"><h5 class="anchored" data-anchor-id="model-sum-of-squares">Model Sum of Squares</h5>
<p><strong>Formula</strong>:</p>
<p><span class="math display">\[
SS_{Model} = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2
\]</span></p>
<p>Can also be derived from:</p>
<p><span class="math display">\[
SS_{Model} = SS_{Total} - SS_{Residual}
\]</span> <strong>In words</strong>:</p>
<p>The deviance of the predicted scores from the mean of <span class="math inline">\(y\)</span>.</p>
<p><strong>Description</strong>:</p>
<p>How much of the variation in the DV your model explained - like a measure that captures how well the regression line fits your data.</p>
</section>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-64" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-64', 'opt-start-64')"> <span class="olab">F-ratio</span></span>
</div>
<div id="opt-body-64" class="optional-body" style="display: none;">
<p><strong>Overview:</strong></p>
<p>We can perform a test to investigate if a model is ‘useful’ — that is, a test to see if our explanatory variable explains more variance in our outcome than we would expect by just some random chance variable.</p>
<p>With one predictor, the <span class="math inline">\(F\)</span>-statistic is used to test the null hypothesis that the regression slope for that predictor is zero:</p>
<p><span class="math display">\[
H_0: \text{the model is ineffective, }b_1 = 0 \\  
\]</span> <span class="math display">\[
H_1 : \text{the model is effective, }b_1  \neq 0 \\  
\]</span></p>
<p>In multiple regression, the logic is the same, but we are now testing against the null hypothesis that <strong>all</strong> regression slopes are zero. Our test is framed in terms of the following hypotheses:</p>
<p><span class="math display">\[
H_0: \text{the model is ineffective, }b_1,...., b_k = 0 \\    
\]</span></p>
<p><span class="math display">\[
H_1 : \text{the model is effective, }b_1,...., b_k  \neq 0 \\  
\]</span></p>
<p>The relevant test-statistic is the <span class="math inline">\(F\)</span>-statistic, which uses “Mean Squares” (these are Sums of Squares divided by the relevant degrees of freedom). We then compare that against (you guessed it) an <span class="math inline">\(F\)</span>-distribution! <span class="math inline">\(F\)</span>-distributions vary according to two parameters, which are both degrees of freedom.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
F_{(df_{model},~df_{residual})} = \frac{MS_{Model}}{MS_{Residual}} = \frac{SS_{Model}/df_{Model}}{SS_{Residual}/df_{Residual}} \\
\quad \\
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; \text{Where:} \\
&amp; df_{model} = k \\
&amp; df_{residual} = n-k-1 \\
&amp; n = \text{sample size} \\
&amp; k  = \text{number of explanatory variables} \\
\end{align}
\]</span></p>
<p><strong>Description:</strong></p>
<p>To test the significance of an overall model, we can conduct an <span class="math inline">\(F\)</span>-test. The <span class="math inline">\(F\)</span>-test compares your model to a model containing zero predictor variables (i.e., the intercept only model), and tests whether your added predictor variables significantly improved the model.</p>
<p>It is called the <span class="math inline">\(F\)</span>-ratio because it is the ratio of the how much of the variation is explained by the model (per parameter) versus how much of the variation is unexplained (per remaining degrees of freedom).</p>
<p>The <span class="math inline">\(F\)</span>-test involves testing the statistical significance of the <span class="math inline">\(F\)</span>-ratio.</p>
<p><strong>Q:</strong> What does the <span class="math inline">\(F\)</span>-ratio test?<br><strong>A:</strong> The null hypothesis that all regression slopes in a model are zero (i.e., explain no variance in your outcome/DV). The alternative hypothesis is that <strong>at least one of the slopes is not zero</strong>.</p>
<p>The <span class="math inline">\(F\)</span>-ratio you see at the bottom of <code>summary(model)</code> is actually a comparison between two models: your model (with some explanatory variables in predicting <span class="math inline">\(y\)</span>) and the <em>null model</em>.</p>
<p>In regression, the null model can be thought of as the model in which all explanatory variables have zero regression coefficients. It is also referred to as the <strong>intercept-only model</strong>, because if all predictor variable coefficients are zero, then we are only estimating <span class="math inline">\(y\)</span> via an intercept (which will be the mean - <span class="math inline">\(\bar y\)</span>).</p>
<p><strong>Interpretation:</strong></p>
<p>Alongside viewing the <span class="math inline">\(F\)</span>-ratio, you can see the results from testing the null hypothesis that all of the coefficients are <span class="math inline">\(0\)</span> (the alternative hypothesis is that at least one coefficient is <span class="math inline">\(\neq 0\)</span>. Under the null hypothesis that all coefficients = 0, the ratio of explained:unexplained variance should be approximately 1)</p>
<p>If your model predictors do explain some variance, the <span class="math inline">\(F\)</span>-ratio will be significant, and you would reject the null, as this would suggest that your predictor variables included in your model improved the model fit (in comparison to the intercept only model).</p>
<p><em>Points to note:</em></p>
<ul>
<li>The larger your <span class="math inline">\(F\)</span>-ratio, the better your model</li>
<li>The <span class="math inline">\(F\)</span>-ratio will be close to 1 when the null is true (i.e., that all slopes are zero)</li>
</ul>
<div class="blue">
<p>In <strong>R</strong></p>
<p>We can see the <span class="math inline">\(F\)</span>-statistic and associated <span class="math inline">\(p\)</span>-value at the bottom of the output of <code>summary(&lt;modelname&gt;)</code>:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_output_f.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, F statistic highlighted</figcaption></figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>The linear model with recall confidence and age explained a significant amount of variance in recall accuracy beyond what we would expect by chance <span class="math inline">\(F(2, 17) = 12.92, p &lt; .001\)</span>.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-65" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-65', 'opt-start-65')"> <span class="olab">R-squared and Adjusted R-squared</span></span>
</div>
<div id="opt-body-65" class="optional-body" style="display: none;">
<p><strong>Overview:</strong></p>
<p><span class="math inline">\(R^2\)</span> represents the proportion of variance in <span class="math inline">\(Y\)</span> that is explained by the model predictor variables.</p>
<p><strong>Formula:</strong></p>
<p>The <span class="math inline">\(R^2\)</span> coefficient is defined as the proportion of the total variability in the outcome variable which is explained by our model: <span class="math display">\[
R^2 = \frac{SS_{Model}}{SS_{Total}} = 1 - \frac{SS_{Residual}}{SS_{Total}}
\]</span></p>
<p>The Adjusted <span class="math inline">\(R^2\)</span> coefficient is defined as: <span class="math display">\[
\hat R^2 = 1 - \frac{(1 - R^2)(n-1)}{n-k-1}
\quad \\
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; \text{Where:} \\
&amp; n = \text{sample size} \\
&amp; k = \text{number of explanatory variables} \\
\end{align}
\]</span></p>
<p><br></p>
<p><strong>When to report Multiple <span class="math inline">\(R^2\)</span> vs.&nbsp;Adjusted <span class="math inline">\(R^2\)</span>:</strong></p>
<p>The Multiple <span class="math inline">\(R^2\)</span> value should be reported for a simple linear regression model (i.e., one predictor).</p>
<p>Unlike <span class="math inline">\(R^2\)</span>, Adjusted-<span class="math inline">\(R^2\)</span> does not necessarily increase with the addition of more explanatory variables, by the inclusion of a penalty according to the number of explanatory variables in the model. Since Adjusted-<span class="math inline">\(R^2\)</span> is adjusted for the number of predictors in the model, this should be used when there are 2 or more predictors in the model. As a side note, the Adjusted-<span class="math inline">\(R^2\)</span> should always be less than or equal to <span class="math inline">\(R^2\)</span>.</p>
<div class="blue">
<p>In <strong>R</strong></p>
<p>We can see both <span class="math inline">\(R^2\)</span> and Adjusted-<span class="math inline">\(R^2\)</span> in the second bottom row of the <code>summary(&lt;modelname&gt;)</code>:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_output_r.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Multiple regression output in R, R^2 statistic highlighted</figcaption></figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>Together, recall confidence and age explained approximately 55.66% of the variance in recall accuracy.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="model-comparisons" class="level1"><h1>Model Comparisons</h1>
<p>One useful thing we might want to do is compare our models with and without some predictor(s).There are numerous ways we can do this, but the method chosen depends on the models and underlying data:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/comparisons_chart.png" class="img-fluid quarto-figure quarto-figure-left figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="optional-begin">
<span id="opt-start-66" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-66', 'opt-start-66')"> <span class="olab">Nested vs Non-Nested Models</span></span>
</div>
<div id="opt-body-66" class="optional-body" style="display: none;">
<p><strong>Nested Models</strong></p>
<p>Consider that you have two regression models where Model 1 contains a subset of the predictors contained in the other Model 2 and is fitted to the same data. More simply, Model 2 contains all of the predictors included in Model 1, <strong>plus</strong> additional predictor(s). This means that Model 1 is <em>nested</em> within Model 2, or that Model 1 is a <em>submodel</em> of Model 2. These two terms, at least in this setting, are interchangeable - it might be easier to think of Model 1 as your null and Model 2 as your alternative.</p>
<p><strong>Non-Nested Models</strong></p>
<p>Consider that you have two regression models where Model 1 contains different variables to those contained in Model 2, where both models are fitted to the same data. More simply, Model 1 and Model 2 contain unique variables that are not shared. This means that Model 1 and Model 2 are <strong>not</strong> nested.</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-67" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-67', 'opt-start-67')"> <span class="olab">Incremental F-test</span></span>
</div>
<div id="opt-body-67" class="optional-body" style="display: none;">
<p>If (<em>and only if</em>) two models are <strong>nested</strong>, can we compare them using an <strong>incremental F-test</strong>.</p>
<p>This is a formal test of whether the additional predictors provide a better fitting model.<br>
Formally this is the test of:</p>
<ul>
<li><p><span class="math inline">\(H_0:\)</span> coefficients for the added/omitted variables are all zero.</p></li>
<li><p><span class="math inline">\(H_1:\)</span> at least one of the added/omitted variables has a coefficient that is not zero.</p></li>
</ul>
<p>The <span class="math inline">\(F\)</span>-ratio for comparing the residual sums of squares between two models can be calculated as:</p>
<p><span class="math display">\[
F_{(df_R-df_F),~df_F} = \frac{(SSR_R-SSR_F)/(df_R-df_F)}{SSR_F / df_F} \\
\quad \\
\]</span> <span class="math display">\[
\begin{align}
&amp; \text{Where:} \\
\\
&amp; SSR_R = \text{residual sums of squares for the restricted model} \\
&amp; SSR_F = \text{residual sums of squares for the full model} \\
&amp; df_R = \text{residual degrees of freedom from the restricted model} \\
&amp; df_F = \text{residual degrees of freedom from the full model} \\
\end{align}
\]</span></p>
<div class="blue">
<p><strong>In R</strong></p>
<p>We can conduct an incremental <span class="math inline">\(F\)</span>-test to compare two models by fitting both models using <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, and passing them to the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="va">...</span> <span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="va">...</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we wanted to, for example, compare a model with just one predictor, <span class="math inline">\(x1\)</span>, to a model with 2 predictors: <span class="math inline">\(x1\)</span>, and <span class="math inline">\(x2\)</span>, we can assess the extent to which the variable <span class="math inline">\(x2\)</span> improves model fit:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>For example:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_anova_comp.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Model Comparisons using Incremental F-test</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>Recall confidence explained a significant amount of variance in recall accuracy beyond age <span class="math inline">\((F(1, 17) = 21.95, p &lt; .001)\)</span>.</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-68" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-68', 'opt-start-68')"> <span class="olab">AIC &amp; BIC</span></span>
</div>
<div id="opt-body-68" class="optional-body" style="display: none;">
<p>AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion) combine information about the sample size, the number of model parameters, and the residual sums of squares (<span class="math inline">\(SS_{residual}\)</span>). Models do not <em>need</em> to be nested to be compared via AIC and BIC, <strong>but</strong> they need to have been fit to the same dataset.</p>
<p>For both of these fit indices, lower values are better, and both include a penalty for the number of predictors in the model (although BIC’s penalty is harsher):</p>
<p><span class="math display">\[
\begin{align}
AIC = n\,\text{ln}\left( \frac{SS_{residual}}{n} \right) + 2k \\
\end{align}
\quad \\
\]</span></p>
<p><span class="math display">\[
\begin{align}
BIC = n\,\text{ln}\left( \frac{SS_{residual}}{n} \right) + k\,\text{ln}(n) \\
\end{align}
\quad \\
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; \text{Where:} \\
&amp; SS_{residual} = \text{sum of squares residuals} \\
&amp; n = \text{sample size} \\
&amp; k = \text{number of explanatory variables} \\
&amp; \text{ln} = \text{natural log function}
\end{align}
\]</span></p>
<div class="blue">
<p><strong>In R</strong></p>
<p>We can calculate AIC and BIC by using the <code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code> and <code><a href="https://rdrr.io/r/stats/AIC.html">BIC()</a></code> functions respectively:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(<span class="sc">&lt;</span>modelname<span class="sc">&gt;</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co">#BIC</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(<span class="sc">&lt;</span>modelname<span class="sc">&gt;</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>For example:</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="images/recall_mdl_aic_bic.PNG" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Model Comparisons using AIC and BIC</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example Interpretation</strong></p>
<p>Based on both AIC and BIC, the model predicting recall accuracy that included both recall confidence and age was better fitting (<span class="math inline">\(AIC = 152.28; BIC = 156.27\)</span>) than the model with age alone (<span class="math inline">\(AIC = 166.86; BIC = 169.85\)</span>).</p>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="model-assumptions" class="level1"><h1>Model Assumptions</h1>
<p>Linear models rely on numerous underlying assumptions about the data. These assumptions ensure that the association between variables is appropriately captured, and that inferences drawn from the model are accurate and valid. Model diagnostics can help further assess whether these assumptions hold. When these assumptions are violated, there are numerous techniques that can be employed, such as through data transformations or using robust alternatives, to ensure reliable model interpretations.</p>
<div class="optional-begin">
<span id="opt-start-69" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-69', 'opt-start-69')"> <span class="olab">Linearity</span></span>
</div>
<div id="opt-body-69" class="optional-body" style="display: none;">
<section id="simple-linear-regression" class="level3"><h3 class="anchored" data-anchor-id="simple-linear-regression">Simple Linear Regression</h3>
<p>In simple linear regression with only one explanatory variable, we could assess linearity through a simple scatterplot of the outcome variable against the explanatory. This would allow us to check if the errors have a mean of zero. If this assumption was met, the residuals would appear to be randomly scattered around zero.</p>
<p>The rationale for this is that, once you remove from the data the linear trend, what’s left over in the residuals should not have any trend, i.e.&nbsp;have a mean of zero.</p>
</section><section id="multiple-regression" class="level3"><h3 class="anchored" data-anchor-id="multiple-regression">Multiple Regression</h3>
<p>In multiple regression, however, it becomes more necessary to rely on diagnostic plots of the model residuals. This is because we need to know whether the relations are linear between the outcome and each predictor <em>after accounting for the other predictors in the model.</em></p>
<p>In order to assess this, we use <strong>partial-residual plots</strong> (also known as ‘component-residual plots’). This is a plot with each explanatory variable <span class="math inline">\(x_j\)</span> on the x-axis, and <strong>partial residuals</strong> on the y-axis***.</p>
<p>Partial residuals for a predictor <span class="math inline">\(x_j\)</span> are calculated as: <span class="math display">\[
\hat \epsilon + \hat \beta_j x_j
\]</span></p>
<div class="blue">
<p>In <strong>R</strong>:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">Simple Linear Regression</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">Multiple Linear Regression</a></li>
</ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify model</span></span>
<span><span class="va">recall_simp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recall_accuracy</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">recalldata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#create plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">recalldata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">recall_accuracy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> <span class="co">#fit straight line to data</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="co">#fit loess line to data</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Recall Accuracy"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<p>The loess line should closely follow the data.</p>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<p>We can create these plots for all predictors in the model by using the <code><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots()</a></code> function from the <strong>car</strong> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify model</span></span>
<span><span class="va">recall_mdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recall_accuracy</span> <span class="op">~</span> <span class="va">recall_confidence</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">recalldata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#create plots</span></span>
<span><span class="fu">crPlots</span><span class="op">(</span><span class="va">recall_mdl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<p>You are looking for the pink line to follow a linear trend line (i.e., follow the blue line). In other words, the loess line should closely follow the linear line.</p>
</div>
</div>
</div>
</div>
</div>
<p><span style="color:darkred;"><strong>Important to Note for Interaction Models</strong></span></p>
<p>***When there is an interaction in the model, assessing linearity becomes difficult. In fact, <code><a href="https://rdrr.io/pkg/car/man/crPlots.html">crPlots()</a></code> will not work. To assess, you can create a residuals-vs-fitted plot.</p>
</section>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-70" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-70', 'opt-start-70')"> <span class="olab">Independence (of errors)</span></span>
</div>
<div id="opt-body-70" class="optional-body" style="display: none;">
<p>The ‘independence of errors’ assumption is the condition that the errors do not have some underlying relationship which is causing them to influence one another. <br></p>
<p>There are many sources of possible dependence, and often these are issues of study design. For example, we may have groups of observations in our data which we would expect to be related (e.g., multiple trials from the same participant). Our modelling strategy would need to take this into account. <br></p>
<p>One form of dependence is <strong>autocorrelation</strong> - this is when observations influence those adjacent to them. It is common in data for which <em>time</em> is a variable of interest (e.g, the humidity today is dependent upon the rainfall yesterday).</p>
<p>Testing for the independence of errors can be pretty difficult, unless you know the potential source of correlation between cases (more on this in DAPR3!).</p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-71" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-71', 'opt-start-71')"> <span class="olab">Normality (of errors)</span></span>
</div>
<div id="opt-body-71" class="optional-body" style="display: none;">
<p>The normality assumption is the condition that the errors <span class="math inline">\(\epsilon\)</span> are normally distributed in the population.</p>
<p>We can visually assess this condition through histograms, density plots, and quantile-quantile plots (QQplots) of our residuals <span class="math inline">\(\hat \epsilon\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">Histogram</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">QQPlot</a></li>
</ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">recall_mdl</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">recall_mdl</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<p>Remember that departures from a linear trend in QQ plots indicate a lack of normality.</p>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-72" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-72', 'opt-start-72')"> <span class="olab">Equal Variances (Homoscedasticity)</span></span>
</div>
<div id="opt-body-72" class="optional-body" style="display: none;">
<p>The equal variances assumption is that the error variance <span class="math inline">\(\sigma^2\)</span> is constant across values of the predictor(s) <span class="math inline">\(x_1, \dots,  x_k\)</span>, and across values of the fitted values <span class="math inline">\(\hat y\)</span>. This sometimes gets termed “Constant” vs “Non-constant” variance. This is presented visually in <a href="#fig-ncv-violate" class="quarto-xref">Figure&nbsp;8</a> and <a href="#fig-ncv-noviolate" class="quarto-xref">Figure&nbsp;9</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ncv-violate" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ncv-violate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-ncv-violate-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ncv-violate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Non-constant variance for numeric and categorical X
</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ncv-noviolate" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ncv-noviolate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-ncv-noviolate-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ncv-noviolate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Constant variance for numeric and categorical X
</figcaption></figure>
</div>
</div>
</div>
<div class="blue">
<p>In <strong>R</strong></p>
<p>We can create plots of the <em>Pearson residuals</em> against the predicted values <span class="math inline">\(\hat y\)</span> and against the predictors <span class="math inline">\(x_1\)</span>, … <span class="math inline">\(x_k\)</span> by using the <code><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots()</a></code> function from the <strong>car</strong> package. This function also provides the results of a lack-of-fit test for each of these relationships (note when it is the fitted values <span class="math inline">\(\hat y\)</span> it gets called “Tukey’s test”).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/residualPlots.html">residualPlots</a></span><span class="op">(</span><span class="va">recall_mdl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Test stat Pr(&gt;|Test stat|)
recall_confidence    1.4473           0.1671
age                 -0.0474           0.9627
Tukey test           0.8769           0.3805</code></pre>
</div>
</div>
<p>Alternatively, we can use:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">recall_mdl</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<p>If the assumption is met, you should see a random scatter of <span class="math inline">\((x,y)\)</span> points with constant mean and variance functions i.e., the vertical spread of the residuals should roughly be the same everywhere.</p>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-73" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-73', 'opt-start-73')"> <span class="olab">Useful Assumption Plots</span></span>
</div>
<div id="opt-body-73" class="optional-body" style="display: none;">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true"><code>plot(modelname)</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false"><code>check_model(modelname)</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<p>We can run <code>plot(mymodel)</code> which will cycle through these plots (asking us to press enter each time to move to the next plot), or we can arrange these plots in a matrix via <code>par(mfrow)</code>, for example in a 2 x 2 matrix as shown below (make sure to always reset your graphical parameters! If needed, we could also extract specific plots using, for instance: <code>plot(mymodel, which = 3)</code> for the third plot.</p>
<div class="blue">
<p><strong>In R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">recall_mdl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<ul>
<li>Top Left: For the <strong>Residuals vs Fitted</strong> plot, we want the red line to be horizontal at close to zero across the plot. We don’t want the residuals (the points) to be fanning in/out.<br>
</li>
<li>Top Right: For the <strong>Normal Q-Q</strong> plot, we want the residuals (the points) to follow closely to the diagonal line, indicating that they are relatively normally distributed.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</li>
<li>Bottom Left: For the <strong>Scale-Location</strong> plot, we want the red line to be horizontal across the plot. These plots allow us to examine the extent to which the variance of the residuals changes across the fitted values. If it is angled, we are likely to see fanning in/out of the points in the residuals vs fitted plot.</li>
<li>Bottom Right: The <strong>Residuals vs Leverage</strong> plot indicates points that might be of individual interest as they may be unduly influencing the model. There are funnel-shaped lines on this plot (sometimes out of scope of the plotting window). Ideally, we want our residuals inside the funnel - the further the residual is to the right (the more leverage it has), the closer to the 0 we want it to be.</li>
</ul>
<p><em>Note, if we have only categorical predictors in our model, many of these will show vertical lines of points. This doesn’t indicate that anything is wrong, and the same principles described above continue to apply</em></p>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<p>The <code><a href="https://easystats.github.io/performance/reference/check_model.html">check_model()</a></code> function from the <strong>performance</strong> package is a useful way to check the assumptions of models, as it also returns some useful notes to aid your interpretation. However, it is important to check each assumption individually with plots that are more suitable for a statistics report.</p>
<div class="blue">
<p><strong>In R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">recall_mdl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-74" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-74', 'opt-start-74')"> <span class="olab">Multicollinearity</span></span>
</div>
<div id="opt-body-74" class="optional-body" style="display: none;">
<p>For the linear model with <strong>multiple</strong> explanatory variables, we need to also think about <strong>multicollinearity</strong> - this is when two (or more) of the predictors in our regression model are moderately or highly correlated.</p>
<p>We can assess multicollinearity using the <strong>variance inflation factor (VIF)</strong>, which for a given predictor <span class="math inline">\(x_j\)</span> is calculated as:</p>
<p><span class="math display">\[
VIF_j = \frac{1}{1-R_j^2} \\
\]</span></p>
<p><span style="color:darkred;"><strong>Important to Note for Interaction Models</strong></span></p>
<p>Interaction terms often result in multicollinearity, because these terms are made up of the product of some ‘main effects’. Mean-centering the variables will help to reduce this source of structural multicollinearity (“structural” here refers to the fact that multicollinearity is due to our model specification, rather than the data itself).</p>
<div class="frame">
<p><span style="color:red;"><strong>Interpretation Guidance</strong></span></p>
<p>Suggested cut-offs for VIF are varied. Some suggest 10, others 5. Define what you will consider an acceptable value <em>prior</em> to calculating it. You could loosely interpret VIF values <span class="math inline">\(&gt;5\)</span> as moderate multicollinearity and values <span class="math inline">\(&gt;10\)</span> as severe multicollinearity.</p>
</div>
<div class="blue">
<p>In <strong>R</strong></p>
<p>The <code><a href="https://rdrr.io/pkg/car/man/vif.html">vif()</a></code> function from the <strong>car</strong> package will provide VIF values for each predictor in your model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">INSERT_MODEL_NAME</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-75" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-75', 'opt-start-75')"> <span class="olab">Individual Case Diagnostics</span></span>
</div>
<div id="opt-body-75" class="optional-body" style="display: none;">
<p>We have seen that some specific individual cases in our data can influence our model more than others. We can identify these as:</p>
<ul>
<li>
<strong>Regression outliers:</strong> A large residual <span class="math inline">\(\hat \epsilon_i\)</span> - i.e., a big discrepancy between their predicted y-value and their observed y-value.
<ul>
<li>
<strong>Standardised residuals:</strong> For residual <span class="math inline">\(\hat \epsilon_i\)</span>, divide by the estimate of the standard deviation of the residuals. In R, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard()</a></code> function will give you these</li>
<li>
<strong>Studentised residuals:</strong> For residual <span class="math inline">\(\hat \epsilon_i\)</span>, divide by the estimate of the standard deviation of the residuals excluding case <span class="math inline">\(i\)</span>. In R, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent()</a></code> function will give you these.</li>
</ul>
</li>
<li>
<strong>High leverage cases:</strong> These are cases which have considerable <em>potential</em> to influence the regression model (e.g., cases with an unusual combination of predictor values).
<ul>
<li>
<strong>Hat values:</strong> are used to assess leverage. In R, The <code><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues()</a></code> function will retrieve these.</li>
</ul>
</li>
<li>
<strong>High influence cases:</strong> When a case has high leverage <em>and</em> is an outlier, it will have a large influence on the regression model.
<ul>
<li>
<strong>Cook’s Distance:</strong> combines <em>leverage</em> (hatvalues) with <em>outlying-ness</em> to capture influence: <span class="math inline">\(D_i = \text{Outlyingness} \times \text{Leverage}\)</span>. Cook’s distance refers to the average distance the <span class="math inline">\(\hat{y}\)</span> values will move if a given case is removed. In <code>R</code>, the <code><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance()</a></code> function will provide these values. Alongside Cook’s Distance, we can examine the extent to which model estimates and predictions are affected when an entire case is dropped from the dataset and the model is refitted.<br>
</li>
</ul>
</li>
<li>
<strong>DFFit:</strong> the change in the predicted value at the <span class="math inline">\(i^{th}\)</span> observation with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression.<br>
</li>
<li>
<strong>DFbeta:</strong> the change in a specific coefficient with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression. DFbeta represents the difference in the beta coefficients when a case is excluded from the model versus when it’s included. A large DFbeta value would suggest that a case has a substantial impact on the estimated coefficients, and thus a high influence on the model results; a small DFbeta value would suggest that the case has less influence on the estimated coefficients. A commonly used cut-off or threshold to compare <span class="math inline">\(|DFBETA|\)</span> values (absolute values) against is <span class="math inline">\(\frac{2}{\sqrt{n}}\)</span> (see Belsley et al., (1980) p.&nbsp;28 for more info)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</li>
<li>
<strong>DFbetas:</strong> the change in a specific coefficient divided by the standard error, with and without the <span class="math inline">\(i^{th}\)</span> observation is included in the regression.<br>
</li>
<li>
<strong>COVRATIO:</strong> measures the effect of an observation on the covariance matrix of the parameter estimates. In simpler terms, it captures an observation’s influence on standard errors. Values which are <span class="math inline">\(&gt;1+\frac{3(k+1)}{n}\)</span> or <span class="math inline">\(&lt;1-\frac{3(k+1)}{n}\)</span> are considered as having strong influence.</li>
</ul>
<div class="blue">
<p>In <strong>R</strong>, we can get lots of these measures with the <code><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures()</a></code> function:</p>
<ul>
<li>
<code>influence.measures(my_model)</code> will give you out a dataframe of the various measures.</li>
<li>
<code>summary(influence.measures(my_model))</code> will provide a nice summary of what R deems to be the influential points.</li>
</ul>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-76" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-76', 'opt-start-76')"> <span class="olab">Next Steps: What to do with Violations of Assumptions / Problematic Case Diagnostic Results</span></span>
</div>
<div id="opt-body-76" class="optional-body" style="display: none;">
<p>There are lots of different options available, and there is no one right answer. Assuming that we have no issues with model specification (i.e., are not missing variables, have modeled appropriately), then we may want to consider one of the below approaches (note: this is <strong>not</strong> an exhaustive list!)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">Investigate Observations</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">Sensitivity Analysis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false">Bootstrapping</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-4" role="tab" aria-controls="tabset-32-4" aria-selected="false">OLS vs WLS Regression</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-5" role="tab" aria-controls="tabset-32-5" aria-selected="false">Data Transformations</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-6" role="tab" aria-controls="tabset-32-6" aria-selected="false">Using Non-Linear Models</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-7" role="tab" aria-controls="tabset-32-7" aria-selected="false">Removing Observations</a></li>
</ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<p>The first step is to re-examine your data. It is important to be familiar with your dataset, as you need to know what values are typical, normal, and possible. Could it be the case that you have missed some impossible values (e.g., a negative value of a persons height), values outwith the possible range (e.g., a score of 55 on a survey where scores can only range 10-50), values that don’t make any sense (e.g., an age of 200), or maybe there are even typos / data entry errors (e.g., forgetting to put a decimal point, so having a height of 152m instead of 1.52m)!</p>
<p>If there is a simple error in the data, it could be that you can fix the typo. If that is not possible (maybe you didn’t collect the data, so are unsure of what the value(s) should/could be), you will need to delete the value (i.e., set as an <code>NA</code>), because you know that it is incorrect.</p>
<p>We should aim to never change a legitimate value where possible (and remember that if you have a large dataset, a small number of extreme values will be unlikely to have a strong influence on your results).</p>
<p>If there is an extreme, but legitimate value that you have determined is adversely influencing your model (i.e., by examining the assumptions and diagnostics as outlined above), you may want to consider ways to reduce this influence (e.g., <strong>winsorizing</strong> - which essentially truncates or caps the identified extreme values to a specified percentile, in turn reducing their influence on the model without completely eliminating the observation(s). For example, you could replace values below the 5th percentile with the 5th percentile value, and values above the 95th percentile with the 95th percentile value).</p>
<p>If after re-examining your data you cannot identify any atypical, non-normal, or impossible values, you may need to select a different approach as outlined below.</p>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<p>This allows us to assess the <strong>sensitivity</strong> of our results (i.e., parameter estimates, p-values, confidence intervals) to changes in our modelling approach (i.e., the removal of observations).</p>
<p>We can re-fit our model after excluding our identified outliers and potentially influential observations, and compare these results to the original model.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Process of Removing Observations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The current example involves removing all identified outliers and potentially influential observations at the same time. Ideally, and to ensure a more thorough sensitivity analysis, you would remove each of these observations one at a time, assess the effects on the model by comparing to your original, reassessing the remaining pre-identified observations, and repeating the process if necessary.</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true">Original Model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false">Model with Observations Removed</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false">Compare <code>summary()</code> output</a></li>
</ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## wellbeing model</span></span>
<span><span class="va">wb_mdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">~</span> <span class="va">outdoor_time</span> <span class="op">+</span> <span class="va">social_int</span>, data <span class="op">=</span> <span class="va">mwdata</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wb_mdl1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wellbeing ~ outdoor_time + social_int, data = mwdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.7611  -3.1308  -0.4213   3.3126  18.8406 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  28.62018    1.48786  19.236  &lt; 2e-16 ***
outdoor_time  0.19909    0.05060   3.935 0.000115 ***
social_int    0.33488    0.08929   3.751 0.000232 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.065 on 197 degrees of freedom
Multiple R-squared:  0.1265,    Adjusted R-squared:  0.1176 
F-statistic: 14.26 on 2 and 197 DF,  p-value: 1.644e-06</code></pre>
</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## wellbeing model</span></span>
<span><span class="va">wb_mdl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">~</span> <span class="va">outdoor_time</span> <span class="op">+</span> <span class="va">social_int</span>, data <span class="op">=</span> <span class="va">mwdata</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">53</span>, <span class="fl">56</span>, <span class="fl">58</span>, <span class="fl">59</span>, <span class="fl">60</span>, <span class="fl">62</span>, <span class="fl">72</span>, <span class="fl">73</span>, <span class="fl">75</span>, <span class="fl">76</span>, <span class="fl">78</span>, <span class="fl">79</span>, <span class="fl">85</span>, <span class="fl">101</span>, <span class="fl">109</span>, <span class="fl">125</span>, <span class="fl">126</span>, <span class="fl">127</span>, <span class="fl">131</span>, <span class="fl">149</span>, <span class="fl">151</span>, <span class="fl">159</span>, <span class="fl">163</span>, <span class="fl">165</span>, <span class="fl">169</span>, <span class="fl">173</span>, <span class="fl">176</span>, <span class="fl">179</span>, <span class="fl">197</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wb_mdl2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wellbeing ~ outdoor_time + social_int, data = mwdata[-c(16, 
    25, 50, 53, 56, 58, 59, 60, 62, 72, 73, 75, 76, 78, 79, 85, 
    101, 109, 125, 126, 127, 131, 149, 151, 159, 163, 165, 169, 
    173, 176, 179, 197), ])

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7700 -2.6445 -0.6073  2.8586  9.6605 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  27.91311    1.42612  19.573  &lt; 2e-16 ***
outdoor_time  0.19356    0.04901   3.950 0.000116 ***
social_int    0.39830    0.08964   4.443 1.62e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.044 on 165 degrees of freedom
Multiple R-squared:  0.1774,    Adjusted R-squared:  0.1675 
F-statistic:  17.8 on 2 and 165 DF,  p-value: 1.004e-07</code></pre>
</div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tab_model</span><span class="op">(</span><span class="va">wb_mdl1</span>, <span class="va">wb_mdl2</span>,</span>
<span>          dv.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wellbeing (WEMWBS Scores)"</span>, <span class="st">"Wellbeing (WEMWBS Scores)"</span><span class="op">)</span>,</span>
<span>          pred.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outdoor_time"</span> <span class="op">=</span> <span class="st">"Outdoor Time (hours per week)"</span>,</span>
<span>                          <span class="st">"social_int"</span> <span class="op">=</span> <span class="st">"Social Interactions (number per week)"</span><span class="op">)</span>,</span>
<span>          title <span class="op">=</span> <span class="st">"Regression Table for Wellbeing Models wb1 and wb2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Regression Table for Wellbeing Models wb1 and wb2</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Wellbeing (WEMWBS Scores)</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Wellbeing (WEMWBS Scores)</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">28.62</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">25.69&nbsp;–&nbsp;31.55</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">27.91</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">25.10&nbsp;–&nbsp;30.73</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Outdoor Time (hours per<br>
week)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.20</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.10&nbsp;–&nbsp;0.30</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.10&nbsp;–&nbsp;0.29</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Social Interactions<br>
(number per week)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.33</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16&nbsp;–&nbsp;0.51</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.40</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.22&nbsp;–&nbsp;0.58</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">200</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">168</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.126 / 0.118</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.177 / 0.167</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>We conducted a sensitivity analysis to assess how robust our conclusions were regarding outdoor time and the weekly number of social interactions in the presence of previously identified outliers and potentially influential observations. We re-fit the model, excluding these 28 observations (14% of our original sample), and compared these model results (<code>wb_mdl2</code>) to those of our original model (<code>wb_mdl1</code>).</p>
<p>There was little difference in the estimates from <code>wb_mdl1</code> and <code>wb_mdl2</code>, and so we can conclude that after conducting a sensitivity analysis, there were no meaningful differences in our results, and hence our conclusions from our original model hold. Specifically:</p>
<ul>
<li>The direction of all model estimates are the same in <code>wb_mdl1</code> and <code>wb_mdl2</code> (i.e., all positive)</li>
<li>There is no difference in statistical significance, and the p-values were of a similar magnitude (i.e., all &lt; .001)</li>
<li>The estimate and confidence intervals for <code>outdoor_time</code> are very similar</li>
<li>There are some quantitative differences in the estimate and confidence intervals for <code>social_int</code>. The estimate differs slightly in magnitude by 0.07), but given that this remains positive and significant, we do not need to be too concerned about this.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<p>The bootstrap method is an alternative non-parametric method of constructing a standard error. Instead of having to rely on calculating the standard error with a formula and potentially applying fancy mathematical corrections, bootstrapping involves mimicking the idea of “repeatedly sampling from the population”. It does so by repeatedly <strong>re</strong>sampling with <strong>replacement</strong> from our original sample.</p>
<p>What this means is that we don’t have to rely on any assumptions about our model residuals, because we actually generate an actual distribution that we can take as an approximation of our sampling distribution, meaning that we can actually look at where 95% of the distribution falls, without having to rely on any summing of squared deviations.</p>
<p>Note, the bootstrap may provide us with an alternative way of conducting inference, but our model may still be mis-specified. It is also very important to remember that bootstrapping is entirely reliant on utilising our original sample to pretend that it is a population (and mimic sampling from that population). If our original sample is not representative of the population that we’re interested in, bootstrapping doesn’t help us at all.</p>
</div>
<div id="tabset-32-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-4-tab">
<p>The method of ordinary least squares regression (OLS: i.e., the type of regression model you have been fitting on the course) assumes that there is constant variance in the errors (<em>homoscedasticity</em>). The method of weighted least squares (WLS) can be used when the ordinary least squares assumption of constant variance in the errors is violated (i.e., you have evidence of <em>heteroscedasticity</em>, like we do in Q3 of this lab).</p>
<p>If we have some specific belief that your non-constant variance is due to differences in the variances of the outcome between various groups, then it might be better to use Weighted Least Squares.</p>
<p>As an example, imagine we are looking at weight of different dog breeds (<a href="#fig-dogweight" class="quarto-xref">Figure&nbsp;10</a>). The weights of chihuahuas are all quite close together (between 2 to 5kg), but the weight of, for example, spaniels is anywhere from 8 to 25kg - a much bigger variance.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dogweight" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dogweight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-dogweight-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dogweight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The weights of 49 dogs, of 7 breeds
</figcaption></figure>
</div>
</div>
</div>
<p>Recall that the default way that <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> deals with categorical predictors such as <code>dog breed</code>, is to compare each one to a reference level. In this case, that reference level is “beagle” (first in the alphabet). Looking at <a href="#fig-dogweight" class="quarto-xref">Figure&nbsp;10</a> above, which comparison do you feel more confident in?</p>
<ul>
<li>
<strong>A:</strong> Beagles (14kg) vs Pugs (9.1kg). A difference of 4.9kg.<br>
</li>
<li>
<strong>B:</strong> Beagles (14kg) vs Spaniels (19kg). A difference of 5kg.</li>
</ul>
<p>Hopefully, your intuition is that <strong>A</strong> looks like a clearer difference than <strong>B</strong> because there’s less overlap between Beagles and Pugs than between Beagles and Spaniels. Our standard linear model, however, assumes the standard errors are identical for each comparison:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ breed, data = dogdf)
...
Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             13.996      1.649   8.489 1.17e-10 ***
breedpug                -4.858      2.332  -2.084   0.0433 *  
breedspaniel             5.052      2.332   2.167   0.0360 *  
breedchihuahua         -10.078      2.332  -4.322 9.28e-05 ***
breedboxer              20.625      2.332   8.846 3.82e-11 ***
breedgolden retriever   17.923      2.332   7.687 1.54e-09 ***
breedlurcher             5.905      2.332   2.533   0.0151 *  
---</code></pre>
</div>
</div>
<p>Furthermore, we can see that we have heteroscedasticity in our residuals - the variance is not constant across the model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dogmodel</span>, which<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Weighted least squares is a method that allows us to apply weights to each observation, where the size of the weight indicates the precision of the information contained in that observation.</p>
<p>We can, in our dog-breeds example, allocate different weights to each breed. Accordingly, the Chihuahuas are given higher weights (and so Chihuahua comparisons result in a smaller SE), and Spaniels and Retrievers are given lower weights.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://uoepsy.github.io/data/dogweight.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dogmod_wls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">breed</span>, data <span class="op">=</span> <span class="va">dogdf</span>, </span>
<span>                 weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">breed</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dogmod_wls</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
                           Value Std.Error   t-value p-value
(Intercept)            13.995640  1.044722 13.396516  0.0000
breedpug               -4.858097  1.271562 -3.820576  0.0004
breedspaniel            5.051696  2.763611  1.827933  0.0747
breedchihuahua        -10.077615  1.095964 -9.195207  0.0000
breedboxer             20.625429  1.820370 11.330351  0.0000
breedgolden retriever  17.922779  2.976253  6.021927  0.0000
breedlurcher            5.905261  1.362367  4.334559  0.0001</code></pre>
</div>
</div>
<p>We <em>can</em> also apply weights that change according to continuous predictors (e.g.&nbsp;observations with a smaller value of <span class="math inline">\(x\)</span> are given more weight than observations with larger values).</p>
</div>
<div id="tabset-32-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-5-tab">
<p>A data transformation involves the replacement of a variable (e.g., <span class="math inline">\(y\)</span>) by a function of that variable in order to change the shape of a distribution or association (e.g., to help reduce skew). We can transform the outcome variable prior to fitting the model, using something such as <code>log(y)</code> or <code>sqrt(y)</code>. This will sometimes allow us to estimate a model for which our assumptions are satisfied.</p>
<p>Some of the most common (not an exhaustive list) transformations are:</p>
<ul>
<li>
<strong>Log (<code>log(y)</code>)</strong>: Often used for reducing right skewness. Note, this transformation cannot be applied to zero or negative values (make sure to check your data!)</li>
<li>
<strong>Square root (<code>sqrt(y)</code>)</strong>: Also often used for reducing right skewness. This transformation can be applied to zero values (but not negative), and is commonly applied to count data</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-trouble1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-trouble1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-trouble1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trouble1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: A model of a transformed outcome variable can sometimes avoid violations of assumptions that arise when modeling the outcome variable directly. Data from https://uoepsy.github.io/data/trouble1.csv
</figcaption></figure>
</div>
</div>
</div>
<p>The major downside of this is that we are no longer modelling <span class="math inline">\(y\)</span>, but some transformation <span class="math inline">\(f(y)\)</span> (<span class="math inline">\(y\)</span> with some function <span class="math inline">\(f\)</span> applied to it). Interpretation of the coefficients changes accordingly, such that we are no longer talking in terms of changes in y, but changes in <span class="math inline">\(f(y)\)</span>. When the transformation function used is non-linear (see the Right-Hand of <a href="#fig-logtr" class="quarto-xref">Figure&nbsp;12</a>) a change in <span class="math inline">\(f(y)\)</span> is <strong>not the same</strong> for every <span class="math inline">\(y\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-logtr" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-logtr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-logtr-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logtr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: The log transformation is non-linear
</figcaption></figure>
</div>
</div>
</div>
<p>For certain transformations, we <em>can</em> re-express coefficients to be interpretable with respect to <span class="math inline">\(y\)</span> itself. For instance, the model using a log transform <span class="math inline">\(ln(y) = b_0 + b_1(x)\)</span> gives us a coefficient that represents statement <strong>A</strong> below. We can re-express this by taking the opposite function to logarithm, the exponent, <code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code>. Similar to how this works in logistic regression, the exponentiated coefficients obtained from <code>exp(coef(model))</code> are <em>multiplicative</em>, meaning we can say something such as statement <strong>B</strong></p>
<div class="int">
<ul>
<li>
<strong>A:</strong> “a 1 unit change in <span class="math inline">\(x\)</span> is associated with a <span class="math inline">\(b\)</span> unit change in <span class="math inline">\(ln(y)\)</span>”.<br>
</li>
<li>
<strong>B:</strong> “a 1 unit change in <span class="math inline">\(x\)</span> is associated with <span class="math inline">\(e^b\)</span> <strong>percent</strong> change in <span class="math inline">\(y\)</span>.”</li>
</ul>
</div>
<p>Finding the optimal transformation to use can be difficult, but there are methods out there to help you. One such method is the BoxCox transformation, which can be conducted using <code>BoxCox(variable, lambda="auto")</code>, from the <strong>forecast</strong> package.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
</div>
<div id="tabset-32-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-6-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true">Generalized Linear Models</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false">Higher Order Terms</a></li>
</ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<p>Generalized Linear Models (GLMs) can appropriately deal with data that do not follow a normal distribution (which is a requirement for traditional linear models). They can accommodate various types of distributions, including the Poisson, binomial, and gamma distributions. This makes them suitable for modelling count data (e.g., number of sunny days Edinburgh has per year - yes, count data can include 0!), binary data (where there are only two possible values e.g., doesn’t wear glasses vs wear glasses, smoker vs non-smoker, i.e., values that are yes/no or 0/1), and other types of non-normal data.</p>
<p>We will explore some GLMs later in the course (Semester 2 Block 4), where we will work with logistic regression models.</p>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<p>Higher order regression terms refer to the inclusion of polynomial terms of degree higher than one in a regression model. In a linear regression model, the association between the dependent variable (<span class="math inline">\(Y\)</span>) and the independent variable (<span class="math inline">\(X\)</span>) is assumed to be linear, which means the association can be represented by a straight line. However, in many real-world scenarios, associations between variables are not strictly linear, and including higher order regression terms can help capture more complex relationships. Higher order terms that you could incorporate include quadratic, cubic, or higher degree polynomial terms.</p>
<p>For example, in a quadratic regression model, the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> can be represented as:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 \cdot X + \beta_2 \cdot X^2 + \epsilon
\]</span> <span class="math display">\[
\begin{align}
&amp; \text{Where:} \\
&amp; Y = \text{Dependent Variable} \\
&amp; X = \text{Independent Variable} \\
\end{align}
\]</span></p>
<p>As in our models we’ve seen so far, <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span> are the coefficients to be estimated in the above model. What is different from what we’ve seen in DAPR2 is the term <span class="math inline">\(\beta_2 \cdot X^2\)</span>, and this represents the <em>quadratic term</em>. This allows for a curved as opposed to straight line to represent the association between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>, and hence can allow us to capture more complex relationships. For example, we can model the association between height and age:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nonlin" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-nonlin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="1_b3_reading_files/figure-html/fig-nonlin-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonlin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Two linear models, one with a quadratic term (right)
</figcaption></figure>
</div>
</div>
</div>
<p>Please note that these types of models are beyond the scope of the DAPR2 course, but if you want to know more, please do read up on these in your own time.</p>
</div>
</div>
</div>
</div>
<div id="tabset-32-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-7-tab">
<p>Removing outliers and potentially influential observations should be a last resort - not all outliers are inherently ‘bad’ - we do expect natural variation in our population(s) of interest. Outliers can be informative about the topic under investigation, and this is why you need to be very careful about excluding outliers due only to their ‘extremeness’. In doing so, you can distort your results by removing variability - i.e., by forcing the data to be more normal and less variable than it actually is, and reduce statistical power by reducing the size of your sample.</p>
<p>If you do decide to remove observations, you will need to document what specific data points you excluded, and provide an explanation as to why these were excluded.</p>
<p>To set specific values to <code>NA</code> in our dataset (and save this updated dataset in a new object named <code>mwdata2</code>), we could use the following code. For the purpose of this demonstration, lets say that we wanted to set any <code>age</code> values of &lt;20 as <code>NA</code>. In the original dataset <code>mwdata</code>, we had 3 individuals aged 18, and 6 aged 19, so we should end up with 9 <code>NA</code> values in <code>mwdata2</code> column <code>age</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify age column in original dataset, where age is &lt; 20, for values to be set to NA and save to new object named mwdata2 to avoid overwriting original data</span></span>
<span><span class="va">mwdata2</span> <span class="op">&lt;-</span>  <span class="va">mwdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">20</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check how many NA values we have - there should be 9 (so 9 TRUEs):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mwdata2</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
  191     9 </code></pre>
</div>
</div>
<p>If we wanted to remove a full row from the datset, we could use the following code. For the purpose of this demonstration, lets say that we wanted to remove all rows that were highlighted in the above assumption and diagnostic checks as potentially having an adverse influence on our model estimates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create new dataset 'mwdata3' without (by specifying -) identified outliers and potentially influential observations</span></span>
<span><span class="va">mwdata3</span> <span class="op">&lt;-</span> <span class="va">mwdata</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">53</span>, <span class="fl">56</span>, <span class="fl">58</span>, <span class="fl">59</span>, <span class="fl">60</span>, <span class="fl">62</span>, <span class="fl">72</span>, <span class="fl">73</span>, <span class="fl">75</span>, <span class="fl">76</span>, <span class="fl">78</span>, <span class="fl">79</span>, <span class="fl">85</span>, <span class="fl">101</span>, <span class="fl">109</span>, <span class="fl">125</span>, <span class="fl">126</span>, <span class="fl">127</span>, <span class="fl">131</span>, <span class="fl">149</span>, <span class="fl">151</span>, <span class="fl">159</span>, <span class="fl">163</span>, <span class="fl">165</span>, <span class="fl">169</span>, <span class="fl">173</span>, <span class="fl">176</span>, <span class="fl">179</span>, <span class="fl">197</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># check dimensions - should now have 32 rows less than original dataset 200 - 32 = 168</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mwdata3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 168   7</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="bootstrap" class="level1"><h1>Bootstrap</h1>
<p>The <em>bootstrap</em> is a general approach to assessing whether the sample results are statistically significant or not, and allows us to draw inferences to the population from a regression model. This method is assumption-free and does not rely on conditions such as normality of the residuals.</p>
<p>It is based on sampling repeatedly with replacement (to avoid always getting the original sample exactly) from the data at hand, and then computing the regression coefficients from each re-sample. We will equivalently use the word “bootstrap sample” or “resample” (for <strong>sample</strong> with <strong>re</strong>placement).</p>
<div class="optional-begin">
<span id="opt-start-77" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-77', 'opt-start-77')"> <span class="olab">Overview</span></span>
</div>
<div id="opt-body-77" class="optional-body" style="display: none;">
<p>The basic principle is:</p>
<center>
<p><strong>The population is to the original sample</strong></p>
<p><strong>as</strong></p>
<p><strong>the original sample is to the bootstrap samples.</strong></p>
</center>
<p>Because we only have one sample of size <span class="math inline">\(n\)</span>, and we do not have access to the data for the entire population, we consider our original sample as our best approximation to the population.</p>
<p>To be more precise, we assume that the population is made up of many, many copies of our original sample. Then, we take multiple samples each of size <span class="math inline">\(n\)</span> from this assumed population. This is equivalent to sampling <em>with replacement</em> from the original sample.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/reg-boot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-78" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-78', 'opt-start-78')"> <span class="olab">Terminology</span></span>
</div>
<div id="opt-body-78" class="optional-body" style="display: none;">
<ul>
<li>A <em>parameter</em> is a numerical summary for the population, e.g.&nbsp;the population slope <span class="math inline">\(\beta_1\)</span>.</li>
<li>A <em>statistic</em> is a numerical summary calculated from the sample data, e.g.&nbsp;the estimated slope in the sample <span class="math inline">\(\widehat \beta_1\)</span>. We use the sample statistic as a best guess, or estimate, for the unknown population parameter.</li>
<li>A <em>bootstrap sample</em> is chosen with replacement from an existing sample, using the same sample size.</li>
<li>A <em>bootstrap statistic</em> is a statistic computed for each bootstrap sample.</li>
<li>A <em>bootstrap distribution</em> collects bootstrap statistics for many bootstrap samples.</li>
</ul>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-79" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-79', 'opt-start-79')"> <span class="olab">In R</span></span>
</div>
<div id="opt-body-79" class="optional-body" style="display: none;">
<p>Follow these steps:</p>
<ul>
<li><p>1: Load the <strong>car</strong> package.</p></li>
<li>
<p>2: Use the <code><a href="https://rdrr.io/pkg/car/man/Boot.html">Boot()</a></code> function (do not forget the uppercase B!) which takes as arguments:</p>
<ul>
<li>the fitted model</li>
<li>
<code>f</code>, saying which bootstrap statistics to compute on each bootstrap sample. By default <code>f = coef</code>, returning the regression coefficients.</li>
<li>
<code>R</code>, saying how many bootstrap samples to compute. By default <code>R = 999</code> but this could be any number. To experiment we recommend 1000, when you want to produce results for journals, it is typical to go with 10,000 or more.</li>
<li>
<code>ncores</code>, saying if to perform the calculations in parallel (and more efficiently). However, this will depend on your PC, and you need to find how many cores you have by running <code><a href="https://rdrr.io/r/parallel/detectCores.html">parallel::detectCores()</a></code> on your PC. By default the function uses <code>ncores = 1</code>.</li>
</ul>
</li>
<li><p>3: Run the code. However, please remember that the <code><a href="https://rdrr.io/pkg/car/man/Boot.html">Boot()</a></code> function does <strong>not</strong> want a model which was fitted using data with <code>NAs</code>. To remove, for example, you could use <code>na.omit</code>.</p></li>
<li><p>4: Look at the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> of the bootstrap results. When doing so the output will show, for each regression coefficient, the value in the original sample in the column <code>original</code>, and in the <code>bootSE</code> column, the estimate of the variability of the coefficient from bootstrap sample to bootstrap sample. The <code>bootSE</code> provides us the bootstrap standard error, or bootstrap SE in short. We can use this to answer the key question of how accurate our estimate is.</p></li>
<li><p>5: Compute confidence intervals via the <code><a href="https://rdrr.io/pkg/car/man/S.html">Confint()</a></code> function. Use your preferred confidence level (usually, and by default, 95%) by specifying <code>level =</code>. If you select 95% confidence intervals, by also specifying the <code>type = "perc"</code> argument, <code>R</code> will return the values that comprise 95% of all values in between them, i.e.&nbsp;the value with 2.5% of observations below it and the value with 2.5% of observations above it and 97.5% of observations below it.</p></li>
<li><p>6: Provide interpretation in the context of your research question and report results in APA format. <em>(Note: the actual estimates are those from our original model, it is just the bounds of the interval that bootstrapping is providing us with)</em>.</p></li>
</ul>
<div class="blue">
<p><strong>In R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#specify model</span></span>
<span><span class="va">recall_mdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">recall_accuracy</span> <span class="op">~</span> <span class="va">recall_confidence</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">recalldata</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#step 1: load car package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#step 2/3: bootstrap model (asking to resample 1000 times, i.e., getting a distribution of 1000 values for the coefficients)</span></span>
<span><span class="va">bootmymodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Boot.html">Boot</a></span><span class="op">(</span><span class="va">recall_mdl</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#step 4: check summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bootmymodel</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of bootstrap replications R = 1000 
                  original   bootBias   bootSE  bootMed
(Intercept)       36.15959 -3.2711632 16.47382 34.86127
recall_confidence  0.89573  0.0522770  0.25721  0.92141
age               -0.33916  0.0027399  0.11400 -0.32973</code></pre>
</div>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#step 5: confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/S.html">Confint</a></span><span class="op">(</span><span class="va">bootmymodel</span>, level <span class="op">=</span> <span class="fl">0.95</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap percent confidence intervals

                    Estimate      2.5 %     97.5 %
(Intercept)       36.1595862 -1.0225793 61.5221101
recall_confidence  0.8957292  0.5188793  1.5129003
age               -0.3391577 -0.5824887 -0.1458007</code></pre>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<p><br></p>
<div class="optional-begin">
<span id="opt-start-80" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-80', 'opt-start-80')"> <span class="olab">Visualisation</span></span>
</div>
<div id="opt-body-80" class="optional-body" style="display: none;">
<p>You can visualise the uncertainty in the estimates by plotting histograms using the built-in function from the <strong>car</strong> package, which simply takes the bootstrap results <code>bootmymodel</code>. The bootstrap distribution should appear to be normal, and if non-normal, results are likely untrustworthy (note the distribution can be somewhat ambiguous with a small number of resamples).</p>
<div class="blue">
<p><strong>In R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">bootmymodel</span>, ci <span class="op">=</span> <span class="st">"perc"</span>, legend <span class="op">=</span> <span class="st">"separate"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="1_b3_reading_files/figure-html/eval-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="divider div-transparent div-dot">

</div>
</section><section id="general-formatting-presenting-of-results" class="level1"><h1>General Formatting &amp; Presenting of Results</h1>
<section id="latex-symbols-equations" class="level2"><h2 class="anchored" data-anchor-id="latex-symbols-equations">LaTeX Symbols &amp; Equations</h2>
<p>By embedding LaTeX into RMarkdown, you can accurately and precisely format mathematical expressions, ensuring that they are not only technically correct but also visually appealing and easy to interpret.</p>
<div class="optional-begin">
<span id="opt-start-81" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-81', 'opt-start-81')"> <span class="olab">LaTeX Guide</span></span>
</div>
<div id="opt-body-81" class="optional-body" style="display: none;">
<p>For an overview of how to integrate LaTeX symbols and equations, review <a href="https://uoepsy.github.io/scs/rmd-bootcamp/09-latex.html">Lesson 9 of the RMD bootcamp</a>.</p>
</div>
<p class="optional-end">
</p>
</section><section id="apa-formatting" class="level2"><h2 class="anchored" data-anchor-id="apa-formatting">APA Formatting</h2>
<p>APA format is a writing/presentation style that is often used in psychology to ensure consistency in communication. APA formatting applies to all aspects of writing - from formatting of papers (including tables and figures), citation of sources, and reference lists. This means that it also applies to how you present results in your Psychology courses, including DAPR2.</p>
<div class="optional-begin">
<span id="opt-start-82" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-82', 'opt-start-82')"> <span class="olab">APA Formatting Guides</span></span>
</div>
<div id="opt-body-82" class="optional-body" style="display: none;">
<p>All results should be presented following <a href="https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf">APA guidelines</a>.</p>
<p>You also need to follow APA style rules for <a href="https://apastyle.apa.org/style-grammar-guidelines/tables-figures">tables and figures</a>.</p>
<p>Make sure to familiarise yourself with the above guides, and practice presenting your results following these rules.</p>
</div>
<p class="optional-end">
</p>
</section><section id="tables" class="level2"><h2 class="anchored" data-anchor-id="tables">Tables</h2>
<p>We want to ensure that we are presenting results in a well formatted table. To do so, there are lots of different packages available (see <a href="https://uoepsy.github.io/scs/rmd-bootcamp/04-prettytab.html">Lesson 4 of the RMD bootcamp</a>).</p>
<p>One of the most convenient ways to present results from regression models is to use the <code><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model()</a></code> function from <strong>sjPlot</strong></p>
<div class="optional-begin">
<span id="opt-start-83" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-83', 'opt-start-83')"> <span class="olab">Creating tables via tab_model</span></span>
</div>
<div id="opt-body-83" class="optional-body" style="display: none;">
<p>Within <code><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model()</a></code>, there are lots of different ways that you can customise your table. The most common arguments that you should use are <code>dv.labels</code>, <code>pred.labels</code>, and <code>title</code>.</p>
<p>You can rename your DV and IV labels by specifying <code>dv.labels</code> and <code>pred.labels</code>. To do so, specify your variable name on the left, and what you would like this to be named in the table on the right. For <code>title</code>, you can simply specify in ““’s what you want your title to be e.g., <code>title = "This is my title"</code>.</p>
<p>Here’s an example if I had fitted a model with the following information:</p>
<ul>
<li>Model name = <code>mdl_test</code>
</li>
<li>Model DV = <code>cognitive_score</code>
</li>
<li>Model IVs = <code>SES</code> and <code>age</code>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mdl_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cognitive_score</span> <span class="op">~</span> <span class="va">SES</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">data_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I want to change the names of <code>SES</code> and <code>age</code> to be <code>socio-economic status</code> and <code>age - in years</code> respectively. What we need to pay attention to here is the ordering of the IVs - the ordering in our <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> must match that in <code><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model()</a></code>. I also want to name my table <em>Regression Table for Cognitive Scores Model</em>. Here is how we would do this in <strong>R</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjPlot/">sjPlot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/tab_model.html">tab_model</a></span><span class="op">(</span><span class="va">mdl_test</span>,</span>
<span>          pred.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Intercept'</span>, <span class="st">'socio-economic status'</span>, <span class="st">'age - in years'</span><span class="op">)</span>,</span>
<span>          title <span class="op">=</span> <span class="st">"Regression Table for Cognitive Scores Model"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See <a href="https://uoepsy.github.io/scs/rmd-bootcamp/zz-packs.html">here</a> for another short example.</p>
</div>
<p class="optional-end">
</p>
</section><section id="cross-referencing" class="level2"><h2 class="anchored" data-anchor-id="cross-referencing">Cross Referencing</h2>
<p>Cross-referencing is a very helpful way to direct your reader through your document, and the good news is that this can be done automatically in RMarkdown.</p>
<div class="optional-begin">
<span id="opt-start-84" class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-84', 'opt-start-84')"> <span class="olab">Cross Referencing</span></span>
</div>
<div id="opt-body-84" class="optional-body" style="display: none;">
<p>There are three key components to allow you to successfully cross-reference within your RMarkdown document:</p>
<ul>
<li>A bookdown output format</li>
<li>A caption to your figure or table</li>
<li>A named/labeled code chunk</li>
</ul>
<p>Once you have the above, you will be able to cross-reference using the syntax @ref(type:label), where label is the chunk name/label, and type is the environment being referenced (e.g.&nbsp;tab for table, fig for figure, etc.).</p>
<p>For an in-depth overview and example of how to cross-reference, see <a href="https://uoepsy.github.io/scs/rmd-bootcamp/07-refs.html">Lesson 7 of the RMD bootcamp</a>.</p>
</div>
<p class="optional-end">
</p>



</section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Ramsey2012" class="csl-entry" role="listitem">
Ramsey, Fred, and Daniel Schafer. 2012. <em>The Statistical Sleuth: A Course in Methods of Data Analysis</em>. Cengage Learning.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Yes, the error term is gone. This is because the line of best-fit gives you the prediction of the average recall accuracy for a given age, and not the individual recall accuracy of an individual person, which will almost surely be different from the prediction of the line.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Horst, A. M., Hill, A. P., &amp; Gorman, K. B. (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. https://allisonhorst.github.io/palmerpenguins/ doi: 10.5281/zenodo.3960218<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>what defines a ‘family’ of tests is debatable.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>QQplots plot the values against the associated percentiles of the normal distribution. So if we had ten values, it would order them lowest to highest, then plot them on the y against the 10th, 20th, 30th.. and so on percentiles of the standard normal distribution (mean 0, SD 1)<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Belsley, D. A., Kuh, E., &amp; Welsch, R. E. (2005). Regression diagnostics: Identifying influential data and sources of collinearity. John Wiley &amp; Sons. DOI: 10.1002/0471725153<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This method finds an appropriate value for <span class="math inline">\(\lambda\)</span> such that the transformation <span class="math inline">\((sign(x) |x|^{\lambda}-1)/\lambda\)</span> results in a close to normal distribution.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>